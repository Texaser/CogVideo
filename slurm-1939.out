[2024-09-15 20:12:23,515] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-15 20:12:28,692] [INFO] [RANK 0] > initializing model parallel with size 1
[2024-09-15 20:12:28,693] [INFO] [comm.py:652:init_distributed] cdb=None
Processing: 277463 samples
Processing: 277463 samples
[2024-09-15 20:12:29,952] [INFO] [RANK 0] building SATVideoDiffusionEngine model ...
[2024-09-15 20:12:38,082] [WARNING] [RANK 0] Failed to load bitsandbytes:No module named 'bitsandbytes'
[2024-09-15 20:12:38,082] [INFO] [RANK 0] replacing layer 0 attention with lora
[2024-09-15 20:12:38,104] [INFO] [RANK 0] replacing layer 1 attention with lora
[2024-09-15 20:12:38,122] [INFO] [RANK 0] replacing layer 2 attention with lora
[2024-09-15 20:12:38,140] [INFO] [RANK 0] replacing layer 3 attention with lora
[2024-09-15 20:12:38,158] [INFO] [RANK 0] replacing layer 4 attention with lora
[2024-09-15 20:12:38,175] [INFO] [RANK 0] replacing layer 5 attention with lora
[2024-09-15 20:12:38,192] [INFO] [RANK 0] replacing layer 6 attention with lora
[2024-09-15 20:12:38,209] [INFO] [RANK 0] replacing layer 7 attention with lora
[2024-09-15 20:12:38,227] [INFO] [RANK 0] replacing layer 8 attention with lora
[2024-09-15 20:12:38,245] [INFO] [RANK 0] replacing layer 9 attention with lora
[2024-09-15 20:12:38,263] [INFO] [RANK 0] replacing layer 10 attention with lora
[2024-09-15 20:12:38,281] [INFO] [RANK 0] replacing layer 11 attention with lora
[2024-09-15 20:12:38,299] [INFO] [RANK 0] replacing layer 12 attention with lora
[2024-09-15 20:12:38,317] [INFO] [RANK 0] replacing layer 13 attention with lora
[2024-09-15 20:12:38,336] [INFO] [RANK 0] replacing layer 14 attention with lora
[2024-09-15 20:12:38,354] [INFO] [RANK 0] replacing layer 15 attention with lora
[2024-09-15 20:12:38,372] [INFO] [RANK 0] replacing layer 16 attention with lora
[2024-09-15 20:12:38,391] [INFO] [RANK 0] replacing layer 17 attention with lora
[2024-09-15 20:12:38,407] [INFO] [RANK 0] replacing layer 18 attention with lora
[2024-09-15 20:12:38,423] [INFO] [RANK 0] replacing layer 19 attention with lora
[2024-09-15 20:12:38,438] [INFO] [RANK 0] replacing layer 20 attention with lora
[2024-09-15 20:12:38,454] [INFO] [RANK 0] replacing layer 21 attention with lora
[2024-09-15 20:12:38,470] [INFO] [RANK 0] replacing layer 22 attention with lora
[2024-09-15 20:12:38,485] [INFO] [RANK 0] replacing layer 23 attention with lora
[2024-09-15 20:12:38,501] [INFO] [RANK 0] replacing layer 24 attention with lora
[2024-09-15 20:12:38,517] [INFO] [RANK 0] replacing layer 25 attention with lora
[2024-09-15 20:12:38,532] [INFO] [RANK 0] replacing layer 26 attention with lora
[2024-09-15 20:12:38,548] [INFO] [RANK 0] replacing layer 27 attention with lora
[2024-09-15 20:12:38,564] [INFO] [RANK 0] replacing layer 28 attention with lora
[2024-09-15 20:12:38,581] [INFO] [RANK 0] replacing layer 29 attention with lora
Initialized embedder #0: PrecomputedT5Embedder with 0 params. Trainable: False
Working with z of shape (1, 16, 32, 32) = 16384 dimensions.
Missing keys:  []
Unexpected keys:  []
Restored from /mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/vae/3d-vae.pt
[2024-09-15 20:12:40,392] [INFO] [RANK 0]  > number of parameters on model parallel rank 0: 2002480099
[2024-09-15 20:12:41,154] [INFO] [RANK 0] global rank 0 is loading checkpoint /mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/transformer/1000/mp_rank_00_model_states.pt
[2024-09-15 20:12:42,794] [INFO] [RANK 0] Will continue but found unexpected_keys! Check whether you are loading correct checkpoints: ['conditioner.embedders.0.transformer.encoder.embed_tokens.weight'].
[2024-09-15 20:12:42,794] [INFO] [RANK 0] > successfully loaded /mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/transformer/1000/mp_rank_00_model_states.pt
[2024-09-15 20:12:44,030] [INFO] [RANK 0] ***** Total trainable parameters: 58982400 *****
[2024-09-15 20:12:44,030] [INFO] [RANK 0] [<class 'sat.ops.layernorm.LayerNorm'>, <class 'torch.nn.modules.normalization.LayerNorm'>, <class 'sat.ops.layernorm.RMSNorm'>] is set to no_weight_decay
[2024-09-15 20:12:44,035] [INFO] [RANK 0] Syncing initialized parameters...
[2024-09-15 20:12:44,155] [INFO] [RANK 0] Finished syncing initialized parameters.
[2024-09-15 20:12:44,155] [INFO] [RANK 0] Using optimizer sat.ops.FusedEmaAdam from sat.
[2024-09-15 20:12:44,162] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.15.0, git-hash=unknown, git-branch=unknown
[2024-09-15 20:12:44,162] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 1
[2024-09-15 20:12:44,164] [WARNING] [config_utils.py:70:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
[2024-09-15 20:12:44,236] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /mnt/arc/levlevi/xdg_dirs/cache/torch_extensions/py312_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /mnt/arc/levlevi/xdg_dirs/cache/torch_extensions/py312_cu121/fused_ema_adam/build.ninja...
Building extension module fused_ema_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_ema_adam...
Time to load fused_ema_adam op: 0.4436023235321045 seconds
[2024-09-15 20:12:44,691] [INFO] [logging.py:96:log_dist] [Rank 0] Using client callable to create basic optimizer
[2024-09-15 20:12:44,692] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-09-15 20:12:44,729] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedEmaAdam
[2024-09-15 20:12:44,729] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedEmaAdam type=<class 'sat.ops.fused_ema_adam.FusedEmaAdam'>
[2024-09-15 20:12:44,729] [WARNING] [engine.py:1232:_do_optimizer_sanity_check] **** You are using ZeRO with an untested optimizer, proceed with caution *****
[2024-09-15 20:12:44,730] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2024-09-15 20:12:44,730] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 1000000000
[2024-09-15 20:12:44,730] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 1000000000
[2024-09-15 20:12:44,731] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-09-15 20:12:44,731] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-09-15 20:12:44,963] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-09-15 20:12:44,963] [INFO] [utils.py:782:see_memory_usage] MA 4.04 GB         Max_MA 4.15 GB         CA 4.39 GB         Max_CA 4 GB 
[2024-09-15 20:12:44,964] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 63.89 GB, percent = 8.5%
[2024-09-15 20:12:45,140] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-09-15 20:12:45,141] [INFO] [utils.py:782:see_memory_usage] MA 4.04 GB         Max_MA 4.26 GB         CA 4.62 GB         Max_CA 5 GB 
[2024-09-15 20:12:45,142] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 63.89 GB, percent = 8.5%
[2024-09-15 20:12:45,142] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-09-15 20:12:45,316] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-09-15 20:12:45,317] [INFO] [utils.py:782:see_memory_usage] MA 4.04 GB         Max_MA 4.04 GB         CA 4.62 GB         Max_CA 5 GB 
[2024-09-15 20:12:45,318] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 63.89 GB, percent = 8.5%
[2024-09-15 20:12:45,320] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2024-09-15 20:12:45,322] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2024-09-15 20:12:45,322] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-09-15 20:12:45,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[1.0], mom=[[0.9, 0.95]]
[2024-09-15 20:12:45,324] [INFO] [config.py:999:print] DeepSpeedEngine configuration:
[2024-09-15 20:12:45,324] [INFO] [config.py:1003:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-09-15 20:12:45,327] [INFO] [config.py:1003:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2024-09-15 20:12:45,327] [INFO] [config.py:1003:print]   amp_enabled .................. False
[2024-09-15 20:12:45,327] [INFO] [config.py:1003:print]   amp_params ................... False
[2024-09-15 20:12:45,327] [INFO] [config.py:1003:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   bfloat16_enabled ............. False
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   bfloat16_immediate_grad_update  False
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   checkpoint_parallel_write_pipeline  False
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   checkpoint_tag_validation_enabled  True
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   checkpoint_tag_validation_fail  False
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f497e180350>
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   communication_data_type ...... None
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   curriculum_enabled_legacy .... False
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   curriculum_params_legacy ..... False
[2024-09-15 20:12:45,329] [INFO] [config.py:1003:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   data_efficiency_enabled ...... False
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   dataloader_drop_last ......... False
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   disable_allgather ............ False
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   dump_state ................... False
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   dynamic_loss_scale_args ...... None
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   eigenvalue_enabled ........... False
[2024-09-15 20:12:45,330] [INFO] [config.py:1003:print]   eigenvalue_gas_boundary_resolution  1
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   eigenvalue_layer_num ......... 0
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   eigenvalue_max_iter .......... 100
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   eigenvalue_stability ......... 1e-06
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   eigenvalue_tol ............... 0.01
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   eigenvalue_verbose ........... False
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   elasticity_enabled ........... False
[2024-09-15 20:12:45,331] [INFO] [config.py:1003:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   fp16_auto_cast ............... False
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   fp16_enabled ................. True
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   fp16_master_weights_and_gradients  False
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   global_rank .................. 0
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   grad_accum_dtype ............. None
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   gradient_accumulation_steps .. 1
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   gradient_clipping ............ 0.1
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   gradient_predivide_factor .... 1.0
[2024-09-15 20:12:45,332] [INFO] [config.py:1003:print]   graph_harvesting ............. False
[2024-09-15 20:12:45,333] [INFO] [config.py:1003:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-09-15 20:12:45,333] [INFO] [config.py:1003:print]   initial_dynamic_scale ........ 65536
[2024-09-15 20:12:45,333] [INFO] [config.py:1003:print]   load_universal_checkpoint .... False
[2024-09-15 20:12:45,333] [INFO] [config.py:1003:print]   loss_scale ................... 0
[2024-09-15 20:12:45,334] [INFO] [config.py:1003:print]   memory_breakdown ............. False
[2024-09-15 20:12:45,334] [INFO] [config.py:1003:print]   mics_hierarchial_params_gather  False
[2024-09-15 20:12:45,334] [INFO] [config.py:1003:print]   mics_shard_size .............. -1
[2024-09-15 20:12:45,334] [INFO] [config.py:1003:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2024-09-15 20:12:45,335] [INFO] [config.py:1003:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-09-15 20:12:45,335] [INFO] [config.py:1003:print]   optimizer_legacy_fusion ...... False
[2024-09-15 20:12:45,335] [INFO] [config.py:1003:print]   optimizer_name ............... None
[2024-09-15 20:12:45,335] [INFO] [config.py:1003:print]   optimizer_params ............. None
[2024-09-15 20:12:45,335] [INFO] [config.py:1003:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   pld_enabled .................. False
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   pld_params ................... False
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   prescale_gradients ........... False
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   scheduler_name ............... None
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   scheduler_params ............. None
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   seq_parallel_communication_data_type  torch.float32
[2024-09-15 20:12:45,337] [INFO] [config.py:1003:print]   sparse_attention ............. None
[2024-09-15 20:12:45,343] [INFO] [config.py:1003:print]   sparse_gradients_enabled ..... False
[2024-09-15 20:12:45,343] [INFO] [config.py:1003:print]   steps_per_print .............. 50
[2024-09-15 20:12:45,343] [INFO] [config.py:1003:print]   timers_config ................ enabled=True synchronized=True
[2024-09-15 20:12:45,343] [INFO] [config.py:1003:print]   train_batch_size ............. 1
[2024-09-15 20:12:45,343] [INFO] [config.py:1003:print]   train_micro_batch_size_per_gpu  1
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   use_data_before_expert_parallel_  False
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   use_node_local_storage ....... False
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   wall_clock_breakdown ......... False
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   weight_quantization_config ... None
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   world_size ................... 1
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   zero_allow_untested_optimizer  True
[2024-09-15 20:12:45,344] [INFO] [config.py:1003:print]   zero_config .................. stage=2 contiguous_gradients=False reduce_scatter=True reduce_bucket_size=1000000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=1000000000 overlap_comm=True load_from_fp32_weights=False elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-09-15 20:12:45,345] [INFO] [config.py:1003:print]   zero_enabled ................. True
[2024-09-15 20:12:45,345] [INFO] [config.py:1003:print]   zero_force_ds_cpu_optimizer .. True
[2024-09-15 20:12:45,345] [INFO] [config.py:1003:print]   zero_optimization_stage ...... 2
[2024-09-15 20:12:45,345] [INFO] [config.py:989:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 1, 
    "steps_per_print": 50, 
    "gradient_clipping": 0.1, 
    "zero_optimization": {
        "stage": 2, 
        "cpu_offload": false, 
        "contiguous_gradients": false, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 1.000000e+09, 
        "allgather_bucket_size": 1.000000e+09, 
        "load_from_fp32_weights": false
    }, 
    "zero_allow_untested_optimizer": true, 
    "bf16": {
        "enabled": false
    }, 
    "fp16": {
        "enabled": true
    }, 
    "loss_scale": 0, 
    "loss_scale_window": 400, 
    "hysteresis": 2, 
    "min_loss_scale": 1, 
    "activation_checkpointing": {
        "partition_activations": false, 
        "contiguous_memory_optimization": false
    }, 
    "wall_clock_breakdown": false
}
[2024-09-15 20:12:45,345] [INFO] [RANK 0] learning rate decaying style linear, ratio 10.0
[2024-09-15 20:12:45,349] [INFO] [RANK 0] Finetuning Model...
[2024-09-15 20:12:45,349] [INFO] [RANK 0] arguments:
[2024-09-15 20:12:45,349] [INFO] [RANK 0]   base ......................... ['configs/cogvideox_2b_lora.yaml', 'configs/sft.yaml']
[2024-09-15 20:12:45,349] [INFO] [RANK 0]   model_parallel_size .......... 1
[2024-09-15 20:12:45,349] [INFO] [RANK 0]   force_pretrain ............... False
[2024-09-15 20:12:45,349] [INFO] [RANK 0]   device ....................... 0
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   debug ........................ False
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   log_image .................... True
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   output_dir ................... samples
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   input_dir .................... None
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   input_type ................... cli
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   input_file ................... input.txt
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   final_size ................... 2048
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   sdedit ....................... False
[2024-09-15 20:12:45,351] [INFO] [RANK 0]   grid_num_rows ................ 1
[2024-09-15 20:12:45,352] [INFO] [RANK 0]   force_inference .............. False
[2024-09-15 20:12:45,352] [INFO] [RANK 0]   lcm_steps .................... None
[2024-09-15 20:12:45,352] [INFO] [RANK 0]   sampling_num_frames .......... 32
[2024-09-15 20:12:45,352] [INFO] [RANK 0]   sampling_fps ................. 8
[2024-09-15 20:12:45,352] [INFO] [RANK 0]   only_save_latents ............ False
[2024-09-15 20:12:45,352] [INFO] [RANK 0]   only_log_video_latents ....... False
[2024-09-15 20:12:45,363] [INFO] [RANK 0]   latent_channels .............. 32
[2024-09-15 20:12:45,363] [INFO] [RANK 0]   image2video .................. False
[2024-09-15 20:12:45,363] [INFO] [RANK 0]   experiment_name .............. 2b_lora_1000-09-15-20-12
[2024-09-15 20:12:45,364] [INFO] [RANK 0]   train_iters .................. 100000
[2024-09-15 20:12:45,364] [INFO] [RANK 0]   batch_size ................... 1
[2024-09-15 20:12:45,365] [INFO] [RANK 0]   lr ........................... 0.001
[2024-09-15 20:12:45,365] [INFO] [RANK 0]   mode ......................... finetune
[2024-09-15 20:12:45,365] [INFO] [RANK 0]   seed ......................... 1234
[2024-09-15 20:12:45,365] [INFO] [RANK 0]   zero_stage ................... 0
[2024-09-15 20:12:45,365] [INFO] [RANK 0]   checkpoint_activations ....... True
[2024-09-15 20:12:45,366] [INFO] [RANK 0]   checkpoint_num_layers ........ 1
[2024-09-15 20:12:45,366] [INFO] [RANK 0]   checkpoint_skip_layers ....... 0
[2024-09-15 20:12:45,366] [INFO] [RANK 0]   fp16 ......................... True
[2024-09-15 20:12:45,366] [INFO] [RANK 0]   bf16 ......................... False
[2024-09-15 20:12:45,366] [INFO] [RANK 0]   gradient_accumulation_steps .. 1
[2024-09-15 20:12:45,366] [INFO] [RANK 0]   profiling .................... -1
[2024-09-15 20:12:45,368] [INFO] [RANK 0]   epochs ....................... None
[2024-09-15 20:12:45,368] [INFO] [RANK 0]   log_interval ................. 20
[2024-09-15 20:12:45,368] [INFO] [RANK 0]   summary_dir .................. 
[2024-09-15 20:12:45,368] [INFO] [RANK 0]   save_args .................... False
[2024-09-15 20:12:45,368] [INFO] [RANK 0]   lr_decay_iters ............... None
[2024-09-15 20:12:45,368] [INFO] [RANK 0]   lr_decay_style ............... linear
[2024-09-15 20:12:45,369] [INFO] [RANK 0]   lr_decay_ratio ............... 0.1
[2024-09-15 20:12:45,369] [INFO] [RANK 0]   warmup ....................... 0.01
[2024-09-15 20:12:45,369] [INFO] [RANK 0]   weight_decay ................. 0.0001
[2024-09-15 20:12:45,369] [INFO] [RANK 0]   save ......................... ckpts_2b_lora/2b_lora_1000-09-15-20-12
[2024-09-15 20:12:45,369] [INFO] [RANK 0]   load ......................... /mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/transformer
[2024-09-15 20:12:45,369] [INFO] [RANK 0]   force_train .................. True
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   save_interval ................ 500
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   no_save_rng .................. False
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   no_load_rng .................. True
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   resume_dataloader ............ False
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   distributed_backend .......... nccl
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   local_rank ................... 0
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   exit_interval ................ None
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   wandb ........................ True
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   wandb_project_name ........... default_project
[2024-09-15 20:12:45,383] [INFO] [RANK 0]   eval_batch_size .............. 1
[2024-09-15 20:12:45,385] [INFO] [RANK 0]   eval_iters ................... 1
[2024-09-15 20:12:45,385] [INFO] [RANK 0]   eval_interval ................ 200
[2024-09-15 20:12:45,385] [INFO] [RANK 0]   strict_eval .................. False
[2024-09-15 20:12:45,385] [INFO] [RANK 0]   train_data ................... ['/mnt/bum/hanyi/repo/CogVideo/hqdata_subset_1000']
[2024-09-15 20:12:45,385] [INFO] [RANK 0]   train_data_weights ........... None
[2024-09-15 20:12:45,386] [INFO] [RANK 0]   iterable_dataset ............. False
[2024-09-15 20:12:45,386] [INFO] [RANK 0]   iterable_dataset_eval ........ 
[2024-09-15 20:12:45,386] [INFO] [RANK 0]   batch_from_same_dataset ...... False
[2024-09-15 20:12:45,387] [INFO] [RANK 0]   valid_data ................... ['/mnt/bum/hanyi/repo/CogVideo/hqdata_subset_1000']
[2024-09-15 20:12:45,387] [INFO] [RANK 0]   test_data .................... None
[2024-09-15 20:12:45,387] [INFO] [RANK 0]   split ........................ 1,0,0
[2024-09-15 20:12:45,388] [INFO] [RANK 0]   num_workers .................. 8
[2024-09-15 20:12:45,388] [INFO] [RANK 0]   block_size ................... 10000
[2024-09-15 20:12:45,388] [INFO] [RANK 0]   prefetch_factor .............. 4
[2024-09-15 20:12:45,388] [INFO] [RANK 0]   deepspeed .................... True
[2024-09-15 20:12:45,388] [INFO] [RANK 0]   deepspeed_config ............. {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 1, 'steps_per_print': 50, 'gradient_clipping': 0.1, 'zero_optimization': {'stage': 2, 'cpu_offload': False, 'contiguous_gradients': False, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 1000000000, 'allgather_bucket_size': 1000000000, 'load_from_fp32_weights': False}, 'zero_allow_untested_optimizer': True, 'bf16': {'enabled': False}, 'fp16': {'enabled': True}, 'loss_scale': 0, 'loss_scale_window': 400, 'hysteresis': 2, 'min_loss_scale': 1, 'activation_checkpointing': {'partition_activations': False, 'contiguous_memory_optimization': False}, 'wall_clock_breakdown': False}
[2024-09-15 20:12:45,389] [INFO] [RANK 0]   deepscale .................... False
[2024-09-15 20:12:45,389] [INFO] [RANK 0]   deepscale_config ............. None
[2024-09-15 20:12:45,389] [INFO] [RANK 0]   model_config ................. {'scale_factor': 1.15258426, 'disable_first_stage_autocast': True, 'not_trainable_prefixes': ['all'], 'log_keys': ['txt'], 'denoiser_config': {'target': 'sgm.modules.diffusionmodules.denoiser.DiscreteDenoiser', 'params': {'num_idx': 1000, 'quantize_c_noise': False, 'weighting_config': {'target': 'sgm.modules.diffusionmodules.denoiser_weighting.EpsWeighting'}, 'scaling_config': {'target': 'sgm.modules.diffusionmodules.denoiser_scaling.VideoScaling'}, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.ZeroSNRDDPMDiscretization', 'params': {'shift_scale': 3.0}}}}, 'network_config': {'target': 'dit_video_concat.DiffusionTransformer', 'params': {'time_embed_dim': 512, 'elementwise_affine': True, 'num_frames': 49, 'time_compressed_rate': 4, 'latent_width': 90, 'latent_height': 60, 'num_layers': 30, 'patch_size': 2, 'in_channels': 16, 'out_channels': 16, 'hidden_size': 1920, 'adm_in_channels': 256, 'num_attention_heads': 30, 'transformer_args': {'checkpoint_activations': True, 'vocab_size': 1, 'max_sequence_length': 64, 'layernorm_order': 'pre', 'skip_init': False, 'model_parallel_size': 1, 'is_decoder': False, 'num_layers': 30, 'hidden_size': 1920, 'num_attention_heads': 30, 'parallel_output': True}, 'modules': {'pos_embed_config': {'target': 'dit_video_concat.Basic3DPositionEmbeddingMixin', 'params': {'text_length': 226, 'height_interpolation': 1.875, 'width_interpolation': 1.875}}, 'lora_config': {'target': 'sat.model.finetune.lora2.LoraMixin', 'params': {'r': 128}}, 'patch_embed_config': {'target': 'dit_video_concat.ImagePatchEmbeddingMixin', 'params': {'text_hidden_size': 4096}}, 'adaln_layer_config': {'target': 'dit_video_concat.AdaLNMixin', 'params': {'qk_ln': True}}, 'final_layer_config': {'target': 'dit_video_concat.FinalLayerMixin'}}, 'dtype': 'fp16'}}, 'conditioner_config': {'target': 'sgm.modules.GeneralConditioner', 'params': {'emb_models': [{'is_trainable': False, 'input_key': 'txt', 'ucg_rate': 0.1, 'target': 'sgm.modules.encoders.modules.PrecomputedT5Embedder', 'params': {'max_length': 226}}]}}, 'first_stage_config': {'target': 'vae_modules.autoencoder.VideoAutoencoderInferenceWrapper', 'params': {'cp_size': 1, 'ckpt_path': '/mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/vae/3d-vae.pt', 'ignore_keys': ['loss'], 'loss_config': {'target': 'torch.nn.Identity'}, 'regularizer_config': {'target': 'vae_modules.regularizers.DiagonalGaussianRegularizer'}, 'encoder_config': {'target': 'vae_modules.cp_enc_dec.ContextParallelEncoder3D', 'params': {'double_z': True, 'z_channels': 16, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 2, 4], 'attn_resolutions': [], 'num_res_blocks': 3, 'dropout': 0.0, 'gather_norm': True}}, 'decoder_config': {'target': 'vae_modules.cp_enc_dec.ContextParallelDecoder3D', 'params': {'double_z': True, 'z_channels': 16, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 2, 4], 'attn_resolutions': [], 'num_res_blocks': 3, 'dropout': 0.0, 'gather_norm': False}}}}, 'loss_fn_config': {'target': 'sgm.modules.diffusionmodules.loss.VideoDiffusionLoss', 'params': {'offset_noise_level': 0, 'sigma_sampler_config': {'target': 'sgm.modules.diffusionmodules.sigma_sampling.DiscreteSampling', 'params': {'uniform_sampling': True, 'num_idx': 1000, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.ZeroSNRDDPMDiscretization', 'params': {'shift_scale': 3.0}}}}}}, 'sampler_config': {'target': 'sgm.modules.diffusionmodules.sampling.VPSDEDPMPP2MSampler', 'params': {'num_steps': 50, 'verbose': True, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.ZeroSNRDDPMDiscretization', 'params': {'shift_scale': 3.0}}, 'guider_config': {'target': 'sgm.modules.diffusionmodules.guiders.DynamicCFG', 'params': {'scale': 6, 'exp': 5, 'num_steps': 50}}}}}
[2024-09-15 20:12:45,390] [INFO] [RANK 0]   data_config .................. {'target': 'data_video.SFTDataset', 'params': {'video_size': [480, 720], 'fps': 30, 'max_num_frames': 49, 'skip_frms_num': 1.0}}
[2024-09-15 20:12:45,390] [INFO] [RANK 0]   cuda ......................... True
[2024-09-15 20:12:45,390] [INFO] [RANK 0]   rank ......................... 0
[2024-09-15 20:12:45,390] [INFO] [RANK 0]   world_size ................... 1
[2024-09-15 20:12:45,391] [INFO] [RANK 0]   deepspeed_activation_checkpointing  True
[2024-09-15 20:12:45,391] [INFO] [RANK 0]   master_ip .................... bumblebee.ib
[2024-09-15 20:12:45,391] [INFO] [RANK 0]   master_port .................. 41461
[2024-09-15 20:12:45,391] [INFO] [RANK 0]   log_config ................... [{'model': {'scale_factor': 1.15258426, 'disable_first_stage_autocast': True, 'not_trainable_prefixes': ['all'], 'log_keys': ['txt'], 'denoiser_config': {'target': 'sgm.modules.diffusionmodules.denoiser.DiscreteDenoiser', 'params': {'num_idx': 1000, 'quantize_c_noise': False, 'weighting_config': {'target': 'sgm.modules.diffusionmodules.denoiser_weighting.EpsWeighting'}, 'scaling_config': {'target': 'sgm.modules.diffusionmodules.denoiser_scaling.VideoScaling'}, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.ZeroSNRDDPMDiscretization', 'params': {'shift_scale': 3.0}}}}, 'network_config': {'target': 'dit_video_concat.DiffusionTransformer', 'params': {'time_embed_dim': 512, 'elementwise_affine': True, 'num_frames': 49, 'time_compressed_rate': 4, 'latent_width': 90, 'latent_height': 60, 'num_layers': 30, 'patch_size': 2, 'in_channels': 16, 'out_channels': 16, 'hidden_size': 1920, 'adm_in_channels': 256, 'num_attention_heads': 30, 'transformer_args': {'checkpoint_activations': True, 'vocab_size': 1, 'max_sequence_length': 64, 'layernorm_order': 'pre', 'skip_init': False, 'model_parallel_size': 1, 'is_decoder': False}, 'modules': {'pos_embed_config': {'target': 'dit_video_concat.Basic3DPositionEmbeddingMixin', 'params': {'text_length': 226, 'height_interpolation': 1.875, 'width_interpolation': 1.875}}, 'lora_config': {'target': 'sat.model.finetune.lora2.LoraMixin', 'params': {'r': 128}}, 'patch_embed_config': {'target': 'dit_video_concat.ImagePatchEmbeddingMixin', 'params': {'text_hidden_size': 4096}}, 'adaln_layer_config': {'target': 'dit_video_concat.AdaLNMixin', 'params': {'qk_ln': True}}, 'final_layer_config': {'target': 'dit_video_concat.FinalLayerMixin'}}}}, 'conditioner_config': {'target': 'sgm.modules.GeneralConditioner', 'params': {'emb_models': [{'is_trainable': False, 'input_key': 'txt', 'ucg_rate': 0.1, 'target': 'sgm.modules.encoders.modules.PrecomputedT5Embedder', 'params': {'max_length': 226}}]}}, 'first_stage_config': {'target': 'vae_modules.autoencoder.VideoAutoencoderInferenceWrapper', 'params': {'cp_size': 1, 'ckpt_path': '/mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/vae/3d-vae.pt', 'ignore_keys': ['loss'], 'loss_config': {'target': 'torch.nn.Identity'}, 'regularizer_config': {'target': 'vae_modules.regularizers.DiagonalGaussianRegularizer'}, 'encoder_config': {'target': 'vae_modules.cp_enc_dec.ContextParallelEncoder3D', 'params': {'double_z': True, 'z_channels': 16, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 2, 4], 'attn_resolutions': [], 'num_res_blocks': 3, 'dropout': 0.0, 'gather_norm': True}}, 'decoder_config': {'target': 'vae_modules.cp_enc_dec.ContextParallelDecoder3D', 'params': {'double_z': True, 'z_channels': 16, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 2, 4], 'attn_resolutions': [], 'num_res_blocks': 3, 'dropout': 0.0, 'gather_norm': False}}}}, 'loss_fn_config': {'target': 'sgm.modules.diffusionmodules.loss.VideoDiffusionLoss', 'params': {'offset_noise_level': 0, 'sigma_sampler_config': {'target': 'sgm.modules.diffusionmodules.sigma_sampling.DiscreteSampling', 'params': {'uniform_sampling': True, 'num_idx': 1000, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.ZeroSNRDDPMDiscretization', 'params': {'shift_scale': 3.0}}}}}}, 'sampler_config': {'target': 'sgm.modules.diffusionmodules.sampling.VPSDEDPMPP2MSampler', 'params': {'num_steps': 50, 'verbose': True, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.ZeroSNRDDPMDiscretization', 'params': {'shift_scale': 3.0}}, 'guider_config': {'target': 'sgm.modules.diffusionmodules.guiders.DynamicCFG', 'params': {'scale': 6, 'exp': 5, 'num_steps': 50}}}}}}, {'args': {'checkpoint_activations': True, 'model_parallel_size': 1, 'experiment_name': '2b_lora_1000', 'mode': 'finetune', 'load': '/mnt/bum/hanyi/repo/CogVideo/sat/CogVideoX-2b-sat/transformer', 'no_load_rng': True, 'train_iters': 100000, 'eval_iters': 1, 'eval_interval': 200, 'eval_batch_size': 1, 'save': 'ckpts_2b_lora', 'save_interval': 500, 'log_interval': 20, 'train_data': ['/mnt/bum/hanyi/repo/CogVideo/hqdata_subset_1000'], 'valid_data': ['/mnt/bum/hanyi/repo/CogVideo/hqdata_subset_1000'], 'split': '1,0,0', 'num_workers': 8, 'force_train': True, 'only_log_video_latents': False, 'wandb': True, 'wandb-project-name': 'CogVideoX'}, 'data': {'target': 'data_video.SFTDataset', 'params': {'video_size': [480, 720], 'fps': 30, 'max_num_frames': 49, 'skip_frms_num': 1.0}}, 'deepspeed': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 1, 'steps_per_print': 50, 'gradient_clipping': 0.1, 'zero_optimization': {'stage': 2, 'cpu_offload': False, 'contiguous_gradients': False, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 1000000000, 'allgather_bucket_size': 1000000000, 'load_from_fp32_weights': False}, 'zero_allow_untested_optimizer': True, 'bf16': {'enabled': False}, 'fp16': {'enabled': True}, 'loss_scale': 0, 'loss_scale_window': 400, 'hysteresis': 2, 'min_loss_scale': 1, 'optimizer': {'type': 'sat.ops.FusedEmaAdam', 'params': {'lr': 0.001, 'betas': [0.9, 0.95], 'eps': '1e-8', 'weight_decay': '1e-4'}}, 'activation_checkpointing': {'partition_activations': False, 'contiguous_memory_optimization': False}, 'wall_clock_breakdown': False}}]
[2024-09-15 20:12:45,392] [INFO] [RANK 0]   do_train ..................... True
[2024-09-15 20:12:45,392] [INFO] [RANK 0]   val_last_shape ............... []
[2024-09-15 20:12:45,392] [INFO] [RANK 0]   val_drop_number .............. 0
[2024-09-15 20:12:45,392] [INFO] [RANK 0]   do_valid ..................... True
[2024-09-15 20:12:45,392] [INFO] [RANK 0]   do_test ...................... False
[2024-09-15 20:12:45,393] [INFO] [RANK 0]   iteration .................... 0
wandb: Currently logged in as: levlevi (team-levi). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.8
wandb: Run data is saved locally in wandb/run-20240915_201246-n379dy18
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 2b_lora_1000-09-15-20-12
wandb: ⭐️ View project at https://wandb.ai/team-levi/default_project
wandb: 🚀 View run at https://wandb.ai/team-levi/default_project/runs/n379dy18
[2024-09-15 20:13:06,566] [INFO] [checkpointing.py:541:forward] Activation Checkpointing Information
[2024-09-15 20:13:06,567] [INFO] [checkpointing.py:542:forward] ----Partition Activations False, CPU CHECKPOINTING False
[2024-09-15 20:13:06,568] [INFO] [checkpointing.py:543:forward] ----contiguous Memory Checkpointing False with None total layers
[2024-09-15 20:13:06,568] [INFO] [checkpointing.py:545:forward] ----Synchronization False
[2024-09-15 20:13:06,569] [INFO] [checkpointing.py:546:forward] ----Profiling time in checkpointing False
[2024-09-15 20:13:08,799] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 4294967296, reducing to 2147483648
[2024-09-15 20:13:12,361] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2147483648, reducing to 1073741824
[2024-09-15 20:13:15,953] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 1073741824, reducing to 536870912
[2024-09-15 20:13:19,540] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 536870912, reducing to 268435456
[2024-09-15 20:13:26,878] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 268435456, reducing to 134217728
[2024-09-15 20:13:34,159] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 134217728, reducing to 67108864
[2024-09-15 20:13:37,820] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 67108864, reducing to 33554432
[2024-09-15 20:13:45,158] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 33554432, reducing to 16777216
[2024-09-15 20:14:18,441] [INFO] [RANK 0]  iteration       20/  100000 | elapsed time per iteration (ms): 4428.9 | learning rate 1.300E-05 | total loss 2.520738E-01 | loss 2.520738E-01 | loss scale 16777216.0 |speed 13.55 samples/(min*GPU)
[2024-09-15 20:14:18,442] [INFO] [RANK 0] after 20 iterations memory (MB) | allocated: 4986.2099609375 | max allocated: 29376.96240234375 | cached: 9648.0 | max cached: 49320.0
[2024-09-15 20:14:18,443] [INFO] [RANK 0] time (ms) | forward: 2740.56 | backward: 1663.13 | allreduce: 0.00 | optimizer: 24.01 | data loader: 121.47
[2024-09-15 20:15:33,037] [INFO] [RANK 0]  iteration       40/  100000 | elapsed time per iteration (ms): 3729.8 | learning rate 3.300E-05 | total loss 2.744271E-01 | loss 2.744271E-01 | loss scale 16777216.0 |speed 16.09 samples/(min*GPU)
[2024-09-15 20:15:33,038] [INFO] [RANK 0] time (ms) | forward: 1998.29 | backward: 1709.24 | allreduce: 0.00 | optimizer: 21.22 | data loader: 0.15
[2024-09-15 20:16:10,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=8, lr=[4.2000000000000004e-05], mom=[[0.9, 0.95]]
[2024-09-15 20:16:21,967] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
[2024-09-15 20:16:48,447] [INFO] [RANK 0]  iteration       60/  100000 | elapsed time per iteration (ms): 3770.5 | learning rate 5.000E-05 | total loss 2.764929E-01 | loss 2.764929E-01 | loss scale 8388608.0 |speed 15.91 samples/(min*GPU)
[2024-09-15 20:16:48,448] [INFO] [RANK 0] time (ms) | forward: 2015.35 | backward: 1730.22 | allreduce: 0.00 | optimizer: 23.70 | data loader: 0.19
[2024-09-15 20:18:04,111] [INFO] [RANK 0]  iteration       80/  100000 | elapsed time per iteration (ms): 3783.2 | learning rate 5.000E-05 | total loss 3.006275E-01 | loss 3.006275E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 20:18:04,112] [INFO] [RANK 0] time (ms) | forward: 2022.17 | backward: 1740.14 | allreduce: 0.00 | optimizer: 19.88 | data loader: 0.11
[2024-09-15 20:19:20,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=9, lr=[5e-05], mom=[[0.9, 0.95]]
[2024-09-15 20:19:20,031] [INFO] [RANK 0]  iteration      100/  100000 | elapsed time per iteration (ms): 3796.0 | learning rate 5.000E-05 | total loss 2.480997E-01 | loss 2.480996E-01 | loss scale 8388608.0 |speed 15.81 samples/(min*GPU)
[2024-09-15 20:19:20,033] [INFO] [RANK 0] time (ms) | forward: 2024.86 | backward: 1747.92 | allreduce: 0.00 | optimizer: 22.13 | data loader: 0.11
[2024-09-15 20:20:36,138] [INFO] [RANK 0]  iteration      120/  100000 | elapsed time per iteration (ms): 3805.3 | learning rate 1.120E-04 | total loss 3.008622E-01 | loss 3.008622E-01 | loss scale 8388608.0 |speed 15.77 samples/(min*GPU)
[2024-09-15 20:20:36,138] [INFO] [RANK 0] time (ms) | forward: 2027.68 | backward: 1752.07 | allreduce: 0.00 | optimizer: 24.30 | data loader: 0.14
[2024-09-15 20:21:52,240] [INFO] [RANK 0]  iteration      140/  100000 | elapsed time per iteration (ms): 3805.1 | learning rate 1.320E-04 | total loss 2.974471E-01 | loss 2.974470E-01 | loss scale 8388608.0 |speed 15.77 samples/(min*GPU)
[2024-09-15 20:21:52,241] [INFO] [RANK 0] time (ms) | forward: 2028.50 | backward: 1752.64 | allreduce: 0.00 | optimizer: 22.67 | data loader: 0.14
[2024-09-15 20:22:30,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=9, lr=[0.000141], mom=[[0.9, 0.95]]
[2024-09-15 20:23:08,209] [INFO] [RANK 0]  iteration      160/  100000 | elapsed time per iteration (ms): 3798.5 | learning rate 1.520E-04 | total loss 2.210601E-01 | loss 2.210601E-01 | loss scale 8388608.0 |speed 15.80 samples/(min*GPU)
[2024-09-15 20:23:08,210] [INFO] [RANK 0] time (ms) | forward: 2024.64 | backward: 1750.62 | allreduce: 0.00 | optimizer: 22.12 | data loader: 0.09
[2024-09-15 20:24:24,582] [INFO] [RANK 0]  iteration      180/  100000 | elapsed time per iteration (ms): 3818.6 | learning rate 1.720E-04 | total loss 2.849977E-01 | loss 2.849977E-01 | loss scale 8388608.0 |speed 15.71 samples/(min*GPU)
[2024-09-15 20:24:24,582] [INFO] [RANK 0] time (ms) | forward: 2042.51 | backward: 1752.02 | allreduce: 0.00 | optimizer: 22.83 | data loader: 0.13
[2024-09-15 20:25:40,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=9, lr=[0.000191], mom=[[0.9, 0.95]]
[2024-09-15 20:25:40,498] [INFO] [RANK 0]  iteration      200/  100000 | elapsed time per iteration (ms): 3795.8 | learning rate 1.920E-04 | total loss 3.156081E-01 | loss 3.156081E-01 | loss scale 8388608.0 |speed 15.81 samples/(min*GPU)
[2024-09-15 20:25:40,504] [INFO] [RANK 0] time (ms) | forward: 2024.27 | backward: 1749.79 | allreduce: 0.00 | optimizer: 20.63 | data loader: 0.09
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG

Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<01:00,  1.21s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:05,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 20:26:58,658] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 20:26:58,658] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
[2024-09-15 20:26:58,662] [INFO] [RANK 0]  validation loss at iteration 200 | loss: 6.948850E-01 | PPL: 2.003479E+00 loss 6.948850E-01 |
[2024-09-15 20:26:58,662] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
wandb: WARNING Step only supports monotonically increasing values, use define_metric to set a custom x axis. For details see: https://wandb.me/define-metric
wandb: WARNING (User provided step: 200 is less than current step: 201. Dropping entry: {'Train/valid_ppl': 2.0034785722592767, 'Train/valid_loss': 0.6948849558830261, '_timestamp': 1726446418.6625924}).
[2024-09-15 20:28:14,720] [INFO] [RANK 0]  iteration      220/  100000 | elapsed time per iteration (ms): 7711.1 | learning rate 2.120E-04 | total loss 3.374295E-01 | loss 3.374295E-01 | loss scale 8388608.0 |speed 7.78 samples/(min*GPU)
[2024-09-15 20:28:14,721] [INFO] [RANK 0] time (ms) | forward: 2025.65 | backward: 1750.99 | allreduce: 0.00 | optimizer: 25.14 | data loader: 0.12
[2024-09-15 20:29:30,661] [INFO] [RANK 0]  iteration      240/  100000 | elapsed time per iteration (ms): 3797.1 | learning rate 2.320E-04 | total loss 3.360984E-01 | loss 3.360984E-01 | loss scale 8388608.0 |speed 15.80 samples/(min*GPU)
[2024-09-15 20:29:30,662] [INFO] [RANK 0] time (ms) | forward: 2021.42 | backward: 1752.76 | allreduce: 0.00 | optimizer: 21.87 | data loader: 0.11
[2024-09-15 20:30:08,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=9, lr=[0.000241], mom=[[0.9, 0.95]]
[2024-09-15 20:30:46,683] [INFO] [RANK 0]  iteration      260/  100000 | elapsed time per iteration (ms): 3801.1 | learning rate 2.520E-04 | total loss 2.970319E-01 | loss 2.970319E-01 | loss scale 8388608.0 |speed 15.79 samples/(min*GPU)
[2024-09-15 20:30:46,683] [INFO] [RANK 0] time (ms) | forward: 2025.49 | backward: 1750.95 | allreduce: 0.00 | optimizer: 23.45 | data loader: 0.11
[2024-09-15 20:32:02,727] [INFO] [RANK 0]  iteration      280/  100000 | elapsed time per iteration (ms): 3802.2 | learning rate 2.720E-04 | total loss 3.274658E-01 | loss 3.274658E-01 | loss scale 8388608.0 |speed 15.78 samples/(min*GPU)
[2024-09-15 20:32:02,729] [INFO] [RANK 0] time (ms) | forward: 2028.00 | backward: 1752.14 | allreduce: 0.00 | optimizer: 21.09 | data loader: 0.11
[2024-09-15 20:33:19,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=9, lr=[0.00029099999999999997], mom=[[0.9, 0.95]]
[2024-09-15 20:33:19,394] [INFO] [RANK 0]  iteration      300/  100000 | elapsed time per iteration (ms): 3833.3 | learning rate 2.920E-04 | total loss 3.535753E-01 | loss 3.535752E-01 | loss scale 8388608.0 |speed 15.65 samples/(min*GPU)
[2024-09-15 20:33:19,396] [INFO] [RANK 0] time (ms) | forward: 2051.62 | backward: 1755.05 | allreduce: 0.00 | optimizer: 23.08 | data loader: 0.16
[2024-09-15 20:34:36,468] [INFO] [RANK 0]  iteration      320/  100000 | elapsed time per iteration (ms): 3853.7 | learning rate 3.120E-04 | total loss 2.740178E-01 | loss 2.740178E-01 | loss scale 8388608.0 |speed 15.57 samples/(min*GPU)
[2024-09-15 20:34:36,469] [INFO] [RANK 0] time (ms) | forward: 2036.65 | backward: 1793.36 | allreduce: 0.00 | optimizer: 22.49 | data loader: 0.18
[2024-09-15 20:35:53,466] [INFO] [RANK 0]  iteration      340/  100000 | elapsed time per iteration (ms): 3849.9 | learning rate 3.320E-04 | total loss 2.524734E-01 | loss 2.524734E-01 | loss scale 8388608.0 |speed 15.58 samples/(min*GPU)
[2024-09-15 20:35:53,467] [INFO] [RANK 0] time (ms) | forward: 2042.79 | backward: 1786.28 | allreduce: 0.00 | optimizer: 19.78 | data loader: 0.13
[2024-09-15 20:36:31,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=9, lr=[0.00034100000000000005], mom=[[0.9, 0.95]]
[2024-09-15 20:37:09,327] [INFO] [RANK 0]  iteration      360/  100000 | elapsed time per iteration (ms): 3793.0 | learning rate 3.520E-04 | total loss 2.387517E-01 | loss 2.387518E-01 | loss scale 8388608.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 20:37:09,327] [INFO] [RANK 0] time (ms) | forward: 2023.40 | backward: 1747.76 | allreduce: 0.00 | optimizer: 20.77 | data loader: 0.16
[2024-09-15 20:38:24,967] [INFO] [RANK 0]  iteration      380/  100000 | elapsed time per iteration (ms): 3782.0 | learning rate 3.720E-04 | total loss 3.372955E-01 | loss 3.372956E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 20:38:24,968] [INFO] [RANK 0] time (ms) | forward: 2021.54 | backward: 1741.61 | allreduce: 0.00 | optimizer: 17.91 | data loader: 0.11
[2024-09-15 20:39:41,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=9, lr=[0.000391], mom=[[0.9, 0.95]]
[2024-09-15 20:39:41,493] [INFO] [RANK 0]  iteration      400/  100000 | elapsed time per iteration (ms): 3826.3 | learning rate 3.920E-04 | total loss 2.941661E-01 | loss 2.941661E-01 | loss scale 8388608.0 |speed 15.68 samples/(min*GPU)
[2024-09-15 20:39:41,495] [INFO] [RANK 0] time (ms) | forward: 2035.42 | backward: 1771.22 | allreduce: 0.00 | optimizer: 18.71 | data loader: 0.10
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG

Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.16s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 20:40:54,348] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 20:40:54,349] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
[2024-09-15 20:40:54,350] [INFO] [RANK 0]  validation loss at iteration 400 | loss: 1.757658E-01 | PPL: 1.192159E+00 loss 1.757658E-01 |
[2024-09-15 20:40:54,350] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 400 is less than current step: 401. Dropping entry: {'Train/valid_ppl': 1.1921588371363765, 'Train/valid_loss': 0.17576581239700317, '_timestamp': 1726447254.3509784}).
[2024-09-15 20:42:10,168] [INFO] [RANK 0]  iteration      420/  100000 | elapsed time per iteration (ms): 7433.8 | learning rate 4.120E-04 | total loss 2.550484E-01 | loss 2.550484E-01 | loss scale 8388608.0 |speed 8.07 samples/(min*GPU)
[2024-09-15 20:42:10,169] [INFO] [RANK 0] time (ms) | forward: 2025.39 | backward: 1744.06 | allreduce: 0.00 | optimizer: 20.43 | data loader: 0.13
[2024-09-15 20:43:26,825] [INFO] [RANK 0]  iteration      440/  100000 | elapsed time per iteration (ms): 3832.8 | learning rate 4.320E-04 | total loss 2.328526E-01 | loss 2.328526E-01 | loss scale 8388608.0 |speed 15.65 samples/(min*GPU)
[2024-09-15 20:43:26,826] [INFO] [RANK 0] time (ms) | forward: 2044.66 | backward: 1770.72 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.10
[2024-09-15 20:44:04,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=9, lr=[0.000441], mom=[[0.9, 0.95]]
[2024-09-15 20:44:42,445] [INFO] [RANK 0]  iteration      460/  100000 | elapsed time per iteration (ms): 3781.0 | learning rate 4.520E-04 | total loss 2.916818E-01 | loss 2.916818E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 20:44:42,446] [INFO] [RANK 0] time (ms) | forward: 2021.88 | backward: 1741.94 | allreduce: 0.00 | optimizer: 16.35 | data loader: 0.08
[2024-09-15 20:45:58,045] [INFO] [RANK 0]  iteration      480/  100000 | elapsed time per iteration (ms): 3780.0 | learning rate 4.720E-04 | total loss 3.218496E-01 | loss 3.218496E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 20:45:58,045] [INFO] [RANK 0] time (ms) | forward: 2019.93 | backward: 1742.89 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.08
[2024-09-15 20:47:13,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=9, lr=[0.000491], mom=[[0.9, 0.95]]
[2024-09-15 20:47:13,881] [INFO] [RANK 0]  iteration      500/  100000 | elapsed time per iteration (ms): 3791.8 | learning rate 4.920E-04 | total loss 2.615684E-01 | loss 2.615684E-01 | loss scale 8388608.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 20:47:13,882] [INFO] [RANK 0] time (ms) | forward: 2026.77 | backward: 1747.51 | allreduce: 0.00 | optimizer: 16.70 | data loader: 0.10
[2024-09-15 20:47:13,883] [INFO] [RANK 0] Saving Model...
[2024-09-15 20:47:15,813] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/500/mp_rank_00_model_states.pt
[2024-09-15 20:47:15,813] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/500/mp_rank_00_model_states.pt...
[2024-09-15 20:47:28,150] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/500/mp_rank_00_model_states.pt.
[2024-09-15 20:47:28,156] [INFO] [RANK 0] Saving Ema Model...
[2024-09-15 20:47:28,389] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/500-ema/mp_rank_00_model_states.pt
[2024-09-15 20:47:28,389] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/500-ema/mp_rank_00_model_states.pt...
[2024-09-15 20:47:40,467] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/500-ema/mp_rank_00_model_states.pt.
[2024-09-15 20:49:01,916] [INFO] [RANK 0]  iteration      520/  100000 | elapsed time per iteration (ms): 5401.7 | learning rate 5.120E-04 | total loss 3.191450E-01 | loss 3.191450E-01 | loss scale 8388608.0 |speed 11.11 samples/(min*GPU)
[2024-09-15 20:49:01,916] [INFO] [RANK 0] time (ms) | forward: 2107.58 | backward: 1946.50 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.09
[2024-09-15 20:50:17,363] [INFO] [RANK 0]  iteration      540/  100000 | elapsed time per iteration (ms): 3772.4 | learning rate 5.320E-04 | total loss 2.466410E-01 | loss 2.466410E-01 | loss scale 8388608.0 |speed 15.91 samples/(min*GPU)
[2024-09-15 20:50:17,364] [INFO] [RANK 0] time (ms) | forward: 2021.81 | backward: 1733.48 | allreduce: 0.00 | optimizer: 16.24 | data loader: 0.08
[2024-09-15 20:50:55,174] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=9, lr=[0.000541], mom=[[0.9, 0.95]]
[2024-09-15 20:51:33,102] [INFO] [RANK 0]  iteration      560/  100000 | elapsed time per iteration (ms): 3787.0 | learning rate 5.520E-04 | total loss 2.546249E-01 | loss 2.546249E-01 | loss scale 8388608.0 |speed 15.84 samples/(min*GPU)
[2024-09-15 20:51:33,103] [INFO] [RANK 0] time (ms) | forward: 2023.19 | backward: 1746.68 | allreduce: 0.00 | optimizer: 16.27 | data loader: 0.08
[2024-09-15 20:52:49,025] [INFO] [RANK 0]  iteration      580/  100000 | elapsed time per iteration (ms): 3796.1 | learning rate 5.720E-04 | total loss 2.564193E-01 | loss 2.564192E-01 | loss scale 8388608.0 |speed 15.81 samples/(min*GPU)
[2024-09-15 20:52:49,025] [INFO] [RANK 0] time (ms) | forward: 2029.03 | backward: 1749.93 | allreduce: 0.00 | optimizer: 16.28 | data loader: 0.07
[2024-09-15 20:54:04,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=9, lr=[0.0005909999999999999], mom=[[0.9, 0.95]]
[2024-09-15 20:54:04,997] [INFO] [RANK 0]  iteration      600/  100000 | elapsed time per iteration (ms): 3798.6 | learning rate 5.920E-04 | total loss 2.991753E-01 | loss 2.991753E-01 | loss scale 8388608.0 |speed 15.80 samples/(min*GPU)
[2024-09-15 20:54:05,001] [INFO] [RANK 0] time (ms) | forward: 2031.05 | backward: 1750.48 | allreduce: 0.00 | optimizer: 16.26 | data loader: 0.07
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG

Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 20:55:18,234] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 20:55:18,234] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
[2024-09-15 20:55:18,235] [INFO] [RANK 0]  validation loss at iteration 600 | loss: 2.220272E-01 | PPL: 1.248605E+00 loss 2.220272E-01 |
[2024-09-15 20:55:18,236] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 600 is less than current step: 601. Dropping entry: {'Train/valid_ppl': 1.2486053363214036, 'Train/valid_loss': 0.22202719748020172, '_timestamp': 1726448118.236477}).
[2024-09-15 20:56:34,224] [INFO] [RANK 0]  iteration      620/  100000 | elapsed time per iteration (ms): 7461.4 | learning rate 6.120E-04 | total loss 2.664020E-01 | loss 2.664020E-01 | loss scale 8388608.0 |speed 8.04 samples/(min*GPU)
[2024-09-15 20:56:34,225] [INFO] [RANK 0] time (ms) | forward: 2031.01 | backward: 1751.36 | allreduce: 0.00 | optimizer: 16.29 | data loader: 0.09
[2024-09-15 20:57:50,505] [INFO] [RANK 0]  iteration      640/  100000 | elapsed time per iteration (ms): 3814.0 | learning rate 6.320E-04 | total loss 3.178578E-01 | loss 3.178578E-01 | loss scale 8388608.0 |speed 15.73 samples/(min*GPU)
[2024-09-15 20:57:50,505] [INFO] [RANK 0] time (ms) | forward: 2044.20 | backward: 1752.25 | allreduce: 0.00 | optimizer: 16.27 | data loader: 0.08
[2024-09-15 20:58:28,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=9, lr=[0.000641], mom=[[0.9, 0.95]]
[2024-09-15 20:59:06,466] [INFO] [RANK 0]  iteration      660/  100000 | elapsed time per iteration (ms): 3798.1 | learning rate 6.520E-04 | total loss 2.886620E-01 | loss 2.886620E-01 | loss scale 8388608.0 |speed 15.80 samples/(min*GPU)
[2024-09-15 20:59:06,467] [INFO] [RANK 0] time (ms) | forward: 2030.31 | backward: 1750.62 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.08
[2024-09-15 21:00:22,485] [INFO] [RANK 0]  iteration      680/  100000 | elapsed time per iteration (ms): 3801.0 | learning rate 6.720E-04 | total loss 2.361972E-01 | loss 2.361972E-01 | loss scale 8388608.0 |speed 15.79 samples/(min*GPU)
[2024-09-15 21:00:22,486] [INFO] [RANK 0] time (ms) | forward: 2032.94 | backward: 1750.89 | allreduce: 0.00 | optimizer: 16.28 | data loader: 0.08
[2024-09-15 21:01:39,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=9, lr=[0.0006910000000000001], mom=[[0.9, 0.95]]
[2024-09-15 21:01:39,024] [INFO] [RANK 0]  iteration      700/  100000 | elapsed time per iteration (ms): 3826.9 | learning rate 6.920E-04 | total loss 2.862439E-01 | loss 2.862439E-01 | loss scale 8388608.0 |speed 15.68 samples/(min*GPU)
[2024-09-15 21:01:39,025] [INFO] [RANK 0] time (ms) | forward: 2030.72 | backward: 1779.10 | allreduce: 0.00 | optimizer: 16.27 | data loader: 0.09
[2024-09-15 21:02:55,027] [INFO] [RANK 0]  iteration      720/  100000 | elapsed time per iteration (ms): 3800.2 | learning rate 7.120E-04 | total loss 2.822357E-01 | loss 2.822357E-01 | loss scale 8388608.0 |speed 15.79 samples/(min*GPU)
[2024-09-15 21:02:55,028] [INFO] [RANK 0] time (ms) | forward: 2031.27 | backward: 1751.80 | allreduce: 0.00 | optimizer: 16.23 | data loader: 0.07
[2024-09-15 21:04:12,382] [INFO] [RANK 0]  iteration      740/  100000 | elapsed time per iteration (ms): 3867.8 | learning rate 7.320E-04 | total loss 2.632787E-01 | loss 2.632787E-01 | loss scale 8388608.0 |speed 15.51 samples/(min*GPU)
[2024-09-15 21:04:12,383] [INFO] [RANK 0] time (ms) | forward: 2029.99 | backward: 1820.48 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.08
[2024-09-15 21:04:50,392] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=9, lr=[0.000741], mom=[[0.9, 0.95]]
[2024-09-15 21:05:28,387] [INFO] [RANK 0]  iteration      760/  100000 | elapsed time per iteration (ms): 3800.2 | learning rate 7.520E-04 | total loss 2.854068E-01 | loss 2.854068E-01 | loss scale 8388608.0 |speed 15.79 samples/(min*GPU)
[2024-09-15 21:05:28,388] [INFO] [RANK 0] time (ms) | forward: 2031.05 | backward: 1751.81 | allreduce: 0.00 | optimizer: 16.36 | data loader: 0.08
[2024-09-15 21:06:44,388] [INFO] [RANK 0]  iteration      780/  100000 | elapsed time per iteration (ms): 3800.0 | learning rate 7.720E-04 | total loss 2.967069E-01 | loss 2.967069E-01 | loss scale 8388608.0 |speed 15.79 samples/(min*GPU)
[2024-09-15 21:06:44,388] [INFO] [RANK 0] time (ms) | forward: 2030.45 | backward: 1752.37 | allreduce: 0.00 | optimizer: 16.31 | data loader: 0.09
[2024-09-15 21:08:01,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=9, lr=[0.000791], mom=[[0.9, 0.95]]
[2024-09-15 21:08:01,012] [INFO] [RANK 0]  iteration      800/  100000 | elapsed time per iteration (ms): 3831.2 | learning rate 7.920E-04 | total loss 2.794936E-01 | loss 2.794936E-01 | loss scale 8388608.0 |speed 15.66 samples/(min*GPU)
[2024-09-15 21:08:01,014] [INFO] [RANK 0] time (ms) | forward: 2032.97 | backward: 1780.64 | allreduce: 0.00 | optimizer: 16.32 | data loader: 0.08
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG

Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.21s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:53,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:05,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 21:09:13,848] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 21:09:13,848] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
[2024-09-15 21:09:13,850] [INFO] [RANK 0]  validation loss at iteration 800 | loss: 5.600558E-01 | PPL: 1.750770E+00 loss 5.600558E-01 |
[2024-09-15 21:09:13,850] [INFO] [RANK 0] -----------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 800 is less than current step: 801. Dropping entry: {'Train/valid_ppl': 1.7507701771217115, 'Train/valid_loss': 0.5600557923316956, '_timestamp': 1726448953.8510647}).
[2024-09-15 21:10:29,976] [INFO] [RANK 0]  iteration      820/  100000 | elapsed time per iteration (ms): 7448.2 | learning rate 8.120E-04 | total loss 2.543712E-01 | loss 2.543712E-01 | loss scale 8388608.0 |speed 8.06 samples/(min*GPU)
[2024-09-15 21:10:29,976] [INFO] [RANK 0] time (ms) | forward: 2022.91 | backward: 1766.13 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.13
[2024-09-15 21:11:48,166] [INFO] [RANK 0]  iteration      840/  100000 | elapsed time per iteration (ms): 3909.5 | learning rate 8.320E-04 | total loss 2.236538E-01 | loss 2.236538E-01 | loss scale 8388608.0 |speed 15.35 samples/(min*GPU)
[2024-09-15 21:11:48,167] [INFO] [RANK 0] time (ms) | forward: 2049.16 | backward: 1843.27 | allreduce: 0.00 | optimizer: 16.28 | data loader: 0.09
[2024-09-15 21:12:26,162] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=9, lr=[0.000841], mom=[[0.9, 0.95]]
[2024-09-15 21:13:05,015] [INFO] [RANK 0]  iteration      860/  100000 | elapsed time per iteration (ms): 3842.4 | learning rate 8.520E-04 | total loss 2.843125E-01 | loss 2.843125E-01 | loss scale 8388608.0 |speed 15.62 samples/(min*GPU)
[2024-09-15 21:13:05,015] [INFO] [RANK 0] time (ms) | forward: 2040.80 | backward: 1784.58 | allreduce: 0.00 | optimizer: 16.25 | data loader: 0.09
[2024-09-15 21:14:21,550] [INFO] [RANK 0]  iteration      880/  100000 | elapsed time per iteration (ms): 3826.7 | learning rate 8.720E-04 | total loss 2.821166E-01 | loss 2.821166E-01 | loss scale 8388608.0 |speed 15.68 samples/(min*GPU)
[2024-09-15 21:14:21,550] [INFO] [RANK 0] time (ms) | forward: 2032.68 | backward: 1776.89 | allreduce: 0.00 | optimizer: 16.34 | data loader: 0.10
[2024-09-15 21:15:38,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=9, lr=[0.000891], mom=[[0.9, 0.95]]
[2024-09-15 21:15:38,172] [INFO] [RANK 0]  iteration      900/  100000 | elapsed time per iteration (ms): 3831.1 | learning rate 8.920E-04 | total loss 2.496045E-01 | loss 2.496045E-01 | loss scale 8388608.0 |speed 15.66 samples/(min*GPU)
[2024-09-15 21:15:38,173] [INFO] [RANK 0] time (ms) | forward: 2040.30 | backward: 1772.22 | allreduce: 0.00 | optimizer: 17.59 | data loader: 0.08
[2024-09-15 21:16:54,376] [INFO] [RANK 0]  iteration      920/  100000 | elapsed time per iteration (ms): 3810.2 | learning rate 9.120E-04 | total loss 2.280650E-01 | loss 2.280650E-01 | loss scale 8388608.0 |speed 15.75 samples/(min*GPU)
[2024-09-15 21:16:54,376] [INFO] [RANK 0] time (ms) | forward: 2022.33 | backward: 1770.59 | allreduce: 0.00 | optimizer: 16.27 | data loader: 0.10
[2024-09-15 21:18:10,975] [INFO] [RANK 0]  iteration      940/  100000 | elapsed time per iteration (ms): 3829.9 | learning rate 9.320E-04 | total loss 2.815791E-01 | loss 2.815791E-01 | loss scale 8388608.0 |speed 15.67 samples/(min*GPU)
[2024-09-15 21:18:10,975] [INFO] [RANK 0] time (ms) | forward: 2024.66 | backward: 1788.20 | allreduce: 0.00 | optimizer: 16.26 | data loader: 0.10
[2024-09-15 21:18:48,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=9, lr=[0.0009410000000000001], mom=[[0.9, 0.95]]
[2024-09-15 21:19:27,239] [INFO] [RANK 0]  iteration      960/  100000 | elapsed time per iteration (ms): 3813.2 | learning rate 9.520E-04 | total loss 3.332175E-01 | loss 3.332174E-01 | loss scale 8388608.0 |speed 15.73 samples/(min*GPU)
[2024-09-15 21:19:27,240] [INFO] [RANK 0] time (ms) | forward: 2043.25 | backward: 1752.40 | allreduce: 0.00 | optimizer: 16.70 | data loader: 0.10
[2024-09-15 21:20:43,433] [INFO] [RANK 0]  iteration      980/  100000 | elapsed time per iteration (ms): 3809.7 | learning rate 9.720E-04 | total loss 3.262809E-01 | loss 3.262809E-01 | loss scale 8388608.0 |speed 15.75 samples/(min*GPU)
[2024-09-15 21:20:43,433] [INFO] [RANK 0] time (ms) | forward: 2039.98 | backward: 1752.05 | allreduce: 0.00 | optimizer: 16.49 | data loader: 0.09
[2024-09-15 21:21:59,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=9, lr=[0.000991], mom=[[0.9, 0.95]]
[2024-09-15 21:21:59,553] [INFO] [RANK 0]  iteration     1000/  100000 | elapsed time per iteration (ms): 3806.0 | learning rate 9.920E-04 | total loss 2.651298E-01 | loss 2.651298E-01 | loss scale 8388608.0 |speed 15.76 samples/(min*GPU)
[2024-09-15 21:21:59,554] [INFO] [RANK 0] time (ms) | forward: 2025.03 | backward: 1761.86 | allreduce: 0.00 | optimizer: 17.78 | data loader: 0.10
[2024-09-15 21:21:59,554] [INFO] [RANK 0] Saving Model...
[2024-09-15 21:22:01,569] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/1000/mp_rank_00_model_states.pt
[2024-09-15 21:22:01,570] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/1000/mp_rank_00_model_states.pt...
[2024-09-15 21:22:14,387] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/1000/mp_rank_00_model_states.pt.
[2024-09-15 21:22:14,496] [INFO] [RANK 0] Saving Ema Model...
[2024-09-15 21:22:15,217] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/1000-ema/mp_rank_00_model_states.pt
[2024-09-15 21:22:15,218] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/1000-ema/mp_rank_00_model_states.pt...
[2024-09-15 21:22:26,454] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/1000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG

Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.14s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.17s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:55,  1.17s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.17s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:52,  1.17s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:48,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:47,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.18s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:12,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:06,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
[2024-09-15 21:23:39,387] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 21:23:39,388] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 21:23:39,389] [INFO] [RANK 0]  validation loss at iteration 1000 | loss: 2.691630E-01 | PPL: 1.308868E+00 loss 2.691630E-01 |
[2024-09-15 21:23:39,390] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 1000 is less than current step: 1001. Dropping entry: {'Train/valid_ppl': 1.3088684075724397, 'Train/valid_loss': 0.26916295289993286, '_timestamp': 1726449819.3920386}).
[2024-09-15 21:24:54,693] [INFO] [RANK 0]  iteration     1020/  100000 | elapsed time per iteration (ms): 8757.0 | learning rate 9.999E-04 | total loss 2.856058E-01 | loss 2.856058E-01 | loss scale 8388608.0 |speed 6.85 samples/(min*GPU)
[2024-09-15 21:24:54,694] [INFO] [RANK 0] time (ms) | forward: 2014.31 | backward: 1731.07 | allreduce: 0.00 | optimizer: 18.84 | data loader: 0.15
[2024-09-15 21:26:10,559] [INFO] [RANK 0]  iteration     1040/  100000 | elapsed time per iteration (ms): 3793.3 | learning rate 9.997E-04 | total loss 2.532828E-01 | loss 2.532828E-01 | loss scale 8388608.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 21:26:10,560] [INFO] [RANK 0] time (ms) | forward: 2019.41 | backward: 1754.22 | allreduce: 0.00 | optimizer: 18.66 | data loader: 0.12
[2024-09-15 21:26:48,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=9, lr=[0.00099959], mom=[[0.9, 0.95]]
[2024-09-15 21:27:26,350] [INFO] [RANK 0]  iteration     1060/  100000 | elapsed time per iteration (ms): 3789.5 | learning rate 9.995E-04 | total loss 2.517932E-01 | loss 2.517932E-01 | loss scale 16777216.0 |speed 15.83 samples/(min*GPU)
[2024-09-15 21:27:26,351] [INFO] [RANK 0] time (ms) | forward: 2031.67 | backward: 1738.72 | allreduce: 0.00 | optimizer: 18.12 | data loader: 0.10
[2024-09-15 21:28:42,083] [INFO] [RANK 0]  iteration     1080/  100000 | elapsed time per iteration (ms): 3786.7 | learning rate 9.993E-04 | total loss 2.278187E-01 | loss 2.278186E-01 | loss scale 16777216.0 |speed 15.85 samples/(min*GPU)
[2024-09-15 21:28:42,084] [INFO] [RANK 0] time (ms) | forward: 2023.96 | backward: 1743.08 | allreduce: 0.00 | optimizer: 18.66 | data loader: 0.09
[2024-09-15 21:29:57,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=9, lr=[0.00099909], mom=[[0.9, 0.95]]
[2024-09-15 21:29:57,772] [INFO] [RANK 0]  iteration     1100/  100000 | elapsed time per iteration (ms): 3784.4 | learning rate 9.991E-04 | total loss 2.939796E-01 | loss 2.939796E-01 | loss scale 16777216.0 |speed 15.85 samples/(min*GPU)
[2024-09-15 21:29:57,774] [INFO] [RANK 0] time (ms) | forward: 2021.72 | backward: 1744.35 | allreduce: 0.00 | optimizer: 17.45 | data loader: 0.10
[2024-09-15 21:31:13,373] [INFO] [RANK 0]  iteration     1120/  100000 | elapsed time per iteration (ms): 3780.0 | learning rate 9.989E-04 | total loss 3.426160E-01 | loss 3.426160E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:31:13,373] [INFO] [RANK 0] time (ms) | forward: 2020.15 | backward: 1742.70 | allreduce: 0.00 | optimizer: 16.31 | data loader: 0.10
[2024-09-15 21:32:29,033] [INFO] [RANK 0]  iteration     1140/  100000 | elapsed time per iteration (ms): 3783.0 | learning rate 9.987E-04 | total loss 2.639034E-01 | loss 2.639034E-01 | loss scale 16777216.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 21:32:29,034] [INFO] [RANK 0] time (ms) | forward: 2022.73 | backward: 1743.14 | allreduce: 0.00 | optimizer: 16.28 | data loader: 0.09
[2024-09-15 21:33:06,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=9, lr=[0.00099859], mom=[[0.9, 0.95]][2024-09-15 21:33:44,694] [INFO] [RANK 0]  iteration     1160/  100000 | elapsed time per iteration (ms): 3783.0 | learning rate 9.985E-04 | total loss 2.602728E-01 | loss 2.602728E-01 | loss scale 16777216.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 21:33:44,695] [INFO] [RANK 0] time (ms) | forward: 2022.16 | backward: 1743.58 | allreduce: 0.00 | optimizer: 16.45 | data loader: 0.08
[2024-09-15 21:35:00,290] [INFO] [RANK 0]  iteration     1180/  100000 | elapsed time per iteration (ms): 3779.8 | learning rate 9.983E-04 | total loss 2.697205E-01 | loss 2.697205E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:35:00,291] [INFO] [RANK 0] time (ms) | forward: 2019.85 | backward: 1742.74 | allreduce: 0.00 | optimizer: 16.39 | data loader: 0.08
[2024-09-15 21:36:15,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=9, lr=[0.00099809], mom=[[0.9, 0.95]]
[2024-09-15 21:36:15,918] [INFO] [RANK 0]  iteration     1200/  100000 | elapsed time per iteration (ms): 3781.4 | learning rate 9.981E-04 | total loss 3.128744E-01 | loss 3.128744E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:36:15,920] [INFO] [RANK 0] time (ms) | forward: 2020.22 | backward: 1744.06 | allreduce: 0.00 | optimizer: 16.27 | data loader: 0.09
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 21:37:28,996] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 21:37:28,996] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 21:37:28,998] [INFO] [RANK 0]  validation loss at iteration 1200 | loss: 3.061832E-01 | PPL: 1.358231E+00 loss 3.061832E-01 |
[2024-09-15 21:37:28,998] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 1200 is less than current step: 1201. Dropping entry: {'Train/valid_ppl': 1.3582310969644866, 'Train/valid_loss': 0.30618318915367126, '_timestamp': 1726450648.9986165}).
[2024-09-15 21:38:44,613] [INFO] [RANK 0]  iteration     1220/  100000 | elapsed time per iteration (ms): 7434.7 | learning rate 9.979E-04 | total loss 2.196553E-01 | loss 2.196552E-01 | loss scale 16777216.0 |speed 8.07 samples/(min*GPU)
[2024-09-15 21:38:44,613] [INFO] [RANK 0] time (ms) | forward: 2021.45 | backward: 1742.13 | allreduce: 0.00 | optimizer: 16.35 | data loader: 0.09
[2024-09-15 21:40:00,208] [INFO] [RANK 0]  iteration     1240/  100000 | elapsed time per iteration (ms): 3779.8 | learning rate 9.977E-04 | total loss 2.192631E-01 | loss 2.192631E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:40:00,209] [INFO] [RANK 0] time (ms) | forward: 2021.21 | backward: 1741.07 | allreduce: 0.00 | optimizer: 16.41 | data loader: 0.08
[2024-09-15 21:40:38,014] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=9, lr=[0.00099759], mom=[[0.9, 0.95]]
[2024-09-15 21:41:15,812] [INFO] [RANK 0]  iteration     1260/  100000 | elapsed time per iteration (ms): 3780.2 | learning rate 9.975E-04 | total loss 2.666021E-01 | loss 2.666021E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:41:15,812] [INFO] [RANK 0] time (ms) | forward: 2020.20 | backward: 1742.90 | allreduce: 0.00 | optimizer: 16.26 | data loader: 0.09
[2024-09-15 21:42:31,417] [INFO] [RANK 0]  iteration     1280/  100000 | elapsed time per iteration (ms): 3780.3 | learning rate 9.973E-04 | total loss 2.422388E-01 | loss 2.422388E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:42:31,418] [INFO] [RANK 0] time (ms) | forward: 2020.76 | backward: 1742.39 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.09
[2024-09-15 21:43:47,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=9, lr=[0.00099709], mom=[[0.9, 0.95]]
[2024-09-15 21:43:47,018] [INFO] [RANK 0]  iteration     1300/  100000 | elapsed time per iteration (ms): 3780.0 | learning rate 9.971E-04 | total loss 2.950639E-01 | loss 2.950639E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:43:47,019] [INFO] [RANK 0] time (ms) | forward: 2019.96 | backward: 1742.91 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.08
[2024-09-15 21:45:02,642] [INFO] [RANK 0]  iteration     1320/  100000 | elapsed time per iteration (ms): 3781.2 | learning rate 9.969E-04 | total loss 2.692364E-01 | loss 2.692364E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:45:02,642] [INFO] [RANK 0] time (ms) | forward: 2021.82 | backward: 1742.27 | allreduce: 0.00 | optimizer: 16.27 | data loader: 0.09
[2024-09-15 21:46:18,279] [INFO] [RANK 0]  iteration     1340/  100000 | elapsed time per iteration (ms): 3781.9 | learning rate 9.967E-04 | total loss 2.889684E-01 | loss 2.889684E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:46:18,280] [INFO] [RANK 0] time (ms) | forward: 2021.38 | backward: 1743.29 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.08
[2024-09-15 21:46:56,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=9, lr=[0.0009965899999999999], mom=[[0.9, 0.95]]
[2024-09-15 21:47:34,077] [INFO] [RANK 0]  iteration     1360/  100000 | elapsed time per iteration (ms): 3789.9 | learning rate 9.965E-04 | total loss 2.934387E-01 | loss 2.934388E-01 | loss scale 16777216.0 |speed 15.83 samples/(min*GPU)
[2024-09-15 21:47:34,077] [INFO] [RANK 0] time (ms) | forward: 2025.48 | backward: 1744.48 | allreduce: 0.00 | optimizer: 18.94 | data loader: 0.10
[2024-09-15 21:48:50,873] [INFO] [RANK 0]  iteration     1380/  100000 | elapsed time per iteration (ms): 3839.8 | learning rate 9.963E-04 | total loss 3.786948E-01 | loss 3.786948E-01 | loss scale 16777216.0 |speed 15.63 samples/(min*GPU)
[2024-09-15 21:48:50,874] [INFO] [RANK 0] time (ms) | forward: 2050.42 | backward: 1751.48 | allreduce: 0.00 | optimizer: 30.08 | data loader: 0.26
[2024-09-15 21:50:06,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=9, lr=[0.00099609], mom=[[0.9, 0.95]]
[2024-09-15 21:50:06,642] [INFO] [RANK 0]  iteration     1400/  100000 | elapsed time per iteration (ms): 3788.4 | learning rate 9.961E-04 | total loss 3.011827E-01 | loss 3.011827E-01 | loss scale 16777216.0 |speed 15.84 samples/(min*GPU)
[2024-09-15 21:50:06,645] [INFO] [RANK 0] time (ms) | forward: 2021.77 | backward: 1743.07 | allreduce: 0.00 | optimizer: 17.29 | data loader: 0.09
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 21:51:19,561] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 21:51:19,562] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 21:51:19,563] [INFO] [RANK 0]  validation loss at iteration 1400 | loss: 2.332807E-01 | PPL: 1.262736E+00 loss 2.332807E-01 |
[2024-09-15 21:51:19,563] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 1400 is less than current step: 1401. Dropping entry: {'Train/valid_ppl': 1.2627358838716372, 'Train/valid_loss': 0.2332807034254074, '_timestamp': 1726451479.5637798}).
[2024-09-15 21:52:35,189] [INFO] [RANK 0]  iteration     1420/  100000 | elapsed time per iteration (ms): 7427.3 | learning rate 9.959E-04 | total loss 3.037311E-01 | loss 3.037311E-01 | loss scale 16777216.0 |speed 8.08 samples/(min*GPU)
[2024-09-15 21:52:35,190] [INFO] [RANK 0] time (ms) | forward: 2020.98 | backward: 1743.23 | allreduce: 0.00 | optimizer: 16.29 | data loader: 0.09
[2024-09-15 21:53:50,839] [INFO] [RANK 0]  iteration     1440/  100000 | elapsed time per iteration (ms): 3782.5 | learning rate 9.957E-04 | total loss 3.230145E-01 | loss 3.230145E-01 | loss scale 16777216.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 21:53:50,840] [INFO] [RANK 0] time (ms) | forward: 2021.52 | backward: 1743.88 | allreduce: 0.00 | optimizer: 16.26 | data loader: 0.08
[2024-09-15 21:54:28,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=9, lr=[0.00099559], mom=[[0.9, 0.95]]
[2024-09-15 21:55:06,446] [INFO] [RANK 0]  iteration     1460/  100000 | elapsed time per iteration (ms): 3780.3 | learning rate 9.955E-04 | total loss 2.505051E-01 | loss 2.505051E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:55:06,446] [INFO] [RANK 0] time (ms) | forward: 2019.25 | backward: 1743.77 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.08
[2024-09-15 21:56:22,066] [INFO] [RANK 0]  iteration     1480/  100000 | elapsed time per iteration (ms): 3781.0 | learning rate 9.953E-04 | total loss 2.935256E-01 | loss 2.935257E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:56:22,067] [INFO] [RANK 0] time (ms) | forward: 2019.57 | backward: 1744.15 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.09
[2024-09-15 21:57:37,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=9, lr=[0.0009950900000000001], mom=[[0.9, 0.95]]
[2024-09-15 21:57:37,661] [INFO] [RANK 0]  iteration     1500/  100000 | elapsed time per iteration (ms): 3779.7 | learning rate 9.951E-04 | total loss 2.258225E-01 | loss 2.258225E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 21:57:37,663] [INFO] [RANK 0] time (ms) | forward: 2019.30 | backward: 1743.17 | allreduce: 0.00 | optimizer: 16.42 | data loader: 0.10
[2024-09-15 21:57:37,664] [INFO] [RANK 0] Saving Model...
[2024-09-15 21:57:39,476] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/1500/mp_rank_00_model_states.pt
[2024-09-15 21:57:39,476] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/1500/mp_rank_00_model_states.pt...
[2024-09-15 21:57:50,637] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/1500/mp_rank_00_model_states.pt.
[2024-09-15 21:57:50,736] [INFO] [RANK 0] Saving Ema Model...
[2024-09-15 21:57:51,340] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/1500-ema/mp_rank_00_model_states.pt
[2024-09-15 21:57:51,340] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/1500-ema/mp_rank_00_model_states.pt...
[2024-09-15 21:58:04,579] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/1500-ema/mp_rank_00_model_states.pt.
[2024-09-15 21:59:19,409] [INFO] [RANK 0]  iteration     1520/  100000 | elapsed time per iteration (ms): 5087.4 | learning rate 9.949E-04 | total loss 2.651757E-01 | loss 2.651757E-01 | loss scale 16777216.0 |speed 11.79 samples/(min*GPU)
[2024-09-15 21:59:19,410] [INFO] [RANK 0] time (ms) | forward: 2003.83 | backward: 1715.32 | allreduce: 0.00 | optimizer: 16.31 | data loader: 0.09
[2024-09-15 22:00:34,758] [INFO] [RANK 0]  iteration     1540/  100000 | elapsed time per iteration (ms): 3767.4 | learning rate 9.947E-04 | total loss 3.033272E-01 | loss 3.033272E-01 | loss scale 16777216.0 |speed 15.93 samples/(min*GPU)
[2024-09-15 22:00:34,759] [INFO] [RANK 0] time (ms) | forward: 2015.44 | backward: 1734.46 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.09
[2024-09-15 22:01:12,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=9, lr=[0.00099459], mom=[[0.9, 0.95]]
[2024-09-15 22:01:50,364] [INFO] [RANK 0]  iteration     1560/  100000 | elapsed time per iteration (ms): 3780.3 | learning rate 9.945E-04 | total loss 3.086655E-01 | loss 3.086655E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:01:50,365] [INFO] [RANK 0] time (ms) | forward: 2022.95 | backward: 1739.92 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.09
[2024-09-15 22:03:05,963] [INFO] [RANK 0]  iteration     1580/  100000 | elapsed time per iteration (ms): 3779.9 | learning rate 9.943E-04 | total loss 2.783312E-01 | loss 2.783312E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:03:05,963] [INFO] [RANK 0] time (ms) | forward: 2021.13 | backward: 1741.39 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.08
[2024-09-15 22:04:21,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=9, lr=[0.00099409], mom=[[0.9, 0.95]]
[2024-09-15 22:04:21,863] [INFO] [RANK 0]  iteration     1600/  100000 | elapsed time per iteration (ms): 3795.0 | learning rate 9.941E-04 | total loss 2.256668E-01 | loss 2.256668E-01 | loss scale 16777216.0 |speed 15.81 samples/(min*GPU)
[2024-09-15 22:04:21,865] [INFO] [RANK 0] time (ms) | forward: 2036.01 | backward: 1741.58 | allreduce: 0.00 | optimizer: 16.59 | data loader: 0.10
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 22:05:34,690] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 22:05:34,691] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 22:05:34,692] [INFO] [RANK 0]  validation loss at iteration 1600 | loss: 1.793496E-01 | PPL: 1.196439E+00 loss 1.793496E-01 |
[2024-09-15 22:05:34,692] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 1600 is less than current step: 1601. Dropping entry: {'Train/valid_ppl': 1.1964389832921496, 'Train/valid_loss': 0.1793496310710907, '_timestamp': 1726452334.6929376}).
[2024-09-15 22:06:50,306] [INFO] [RANK 0]  iteration     1620/  100000 | elapsed time per iteration (ms): 7422.1 | learning rate 9.939E-04 | total loss 3.055200E-01 | loss 3.055200E-01 | loss scale 16777216.0 |speed 8.08 samples/(min*GPU)
[2024-09-15 22:06:50,306] [INFO] [RANK 0] time (ms) | forward: 2019.70 | backward: 1743.91 | allreduce: 0.00 | optimizer: 16.28 | data loader: 0.12
[2024-09-15 22:08:05,959] [INFO] [RANK 0]  iteration     1640/  100000 | elapsed time per iteration (ms): 3782.7 | learning rate 9.937E-04 | total loss 3.225097E-01 | loss 3.225097E-01 | loss scale 16777216.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:08:05,960] [INFO] [RANK 0] time (ms) | forward: 2019.71 | backward: 1745.05 | allreduce: 0.00 | optimizer: 16.72 | data loader: 0.09
[2024-09-15 22:08:43,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=9, lr=[0.00099359], mom=[[0.9, 0.95]]
[2024-09-15 22:09:21,570] [INFO] [RANK 0]  iteration     1660/  100000 | elapsed time per iteration (ms): 3780.6 | learning rate 9.935E-04 | total loss 2.239343E-01 | loss 2.239343E-01 | loss scale 16777216.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:09:21,570] [INFO] [RANK 0] time (ms) | forward: 2019.44 | backward: 1743.96 | allreduce: 0.00 | optimizer: 16.29 | data loader: 0.09
[2024-09-15 22:10:37,241] [INFO] [RANK 0]  iteration     1680/  100000 | elapsed time per iteration (ms): 3783.6 | learning rate 9.933E-04 | total loss 2.757640E-01 | loss 2.757640E-01 | loss scale 16777216.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:10:37,241] [INFO] [RANK 0] time (ms) | forward: 2021.28 | backward: 1745.19 | allreduce: 0.00 | optimizer: 16.23 | data loader: 0.10
[2024-09-15 22:11:52,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=9, lr=[0.00099309], mom=[[0.9, 0.95]]
[2024-09-15 22:11:52,894] [INFO] [RANK 0]  iteration     1700/  100000 | elapsed time per iteration (ms): 3782.7 | learning rate 9.931E-04 | total loss 2.142136E-01 | loss 2.142136E-01 | loss scale 16777216.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:11:52,896] [INFO] [RANK 0] time (ms) | forward: 2023.32 | backward: 1742.16 | allreduce: 0.00 | optimizer: 16.29 | data loader: 0.08
[2024-09-15 22:12:34,450] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
[2024-09-15 22:13:08,489] [INFO] [RANK 0]  iteration     1720/  100000 | elapsed time per iteration (ms): 3779.7 | learning rate 9.929E-04 | total loss 2.390547E-01 | loss 2.390547E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:13:08,489] [INFO] [RANK 0] time (ms) | forward: 2020.61 | backward: 1742.31 | allreduce: 0.00 | optimizer: 15.97 | data loader: 0.09
[2024-09-15 22:14:24,110] [INFO] [RANK 0]  iteration     1740/  100000 | elapsed time per iteration (ms): 3781.1 | learning rate 9.927E-04 | total loss 3.259106E-01 | loss 3.259106E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:14:24,111] [INFO] [RANK 0] time (ms) | forward: 2020.78 | backward: 1743.06 | allreduce: 0.00 | optimizer: 16.37 | data loader: 0.08
[2024-09-15 22:15:01,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=10, lr=[0.0009926000000000002], mom=[[0.9, 0.95]]
[2024-09-15 22:15:39,773] [INFO] [RANK 0]  iteration     1760/  100000 | elapsed time per iteration (ms): 3783.1 | learning rate 9.925E-04 | total loss 3.610790E-01 | loss 3.610790E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:15:39,773] [INFO] [RANK 0] time (ms) | forward: 2024.58 | backward: 1741.29 | allreduce: 0.00 | optimizer: 16.39 | data loader: 0.09
[2024-09-15 22:16:55,376] [INFO] [RANK 0]  iteration     1780/  100000 | elapsed time per iteration (ms): 3780.1 | learning rate 9.923E-04 | total loss 3.450202E-01 | loss 3.450202E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:16:55,376] [INFO] [RANK 0] time (ms) | forward: 2020.08 | backward: 1742.81 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.09
[2024-09-15 22:18:10,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=10, lr=[0.0009921], mom=[[0.9, 0.95]]
[2024-09-15 22:18:10,997] [INFO] [RANK 0]  iteration     1800/  100000 | elapsed time per iteration (ms): 3781.1 | learning rate 9.921E-04 | total loss 2.875253E-01 | loss 2.875253E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:18:10,998] [INFO] [RANK 0] time (ms) | forward: 2021.70 | backward: 1741.98 | allreduce: 0.00 | optimizer: 16.50 | data loader: 0.08
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:47,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 22:19:23,679] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 22:19:23,680] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 22:19:23,682] [INFO] [RANK 0]  validation loss at iteration 1800 | loss: 3.958519E-01 | PPL: 1.485649E+00 loss 3.958519E-01 |
[2024-09-15 22:19:23,682] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 1800 is less than current step: 1801. Dropping entry: {'Train/valid_ppl': 1.4856492473503817, 'Train/valid_loss': 0.39585188031196594, '_timestamp': 1726453163.6824386}).
[2024-09-15 22:20:39,413] [INFO] [RANK 0]  iteration     1820/  100000 | elapsed time per iteration (ms): 7420.8 | learning rate 9.919E-04 | total loss 2.619682E-01 | loss 2.619683E-01 | loss scale 8388608.0 |speed 8.09 samples/(min*GPU)
[2024-09-15 22:20:39,414] [INFO] [RANK 0] time (ms) | forward: 2020.26 | backward: 1749.21 | allreduce: 0.00 | optimizer: 16.32 | data loader: 0.09
[2024-09-15 22:21:55,077] [INFO] [RANK 0]  iteration     1840/  100000 | elapsed time per iteration (ms): 3783.2 | learning rate 9.917E-04 | total loss 3.235991E-01 | loss 3.235991E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:21:55,077] [INFO] [RANK 0] time (ms) | forward: 2018.25 | backward: 1747.76 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.07
[2024-09-15 22:22:32,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=10, lr=[0.0009916], mom=[[0.9, 0.95]]
[2024-09-15 22:23:10,719] [INFO] [RANK 0]  iteration     1860/  100000 | elapsed time per iteration (ms): 3782.1 | learning rate 9.915E-04 | total loss 2.679035E-01 | loss 2.679035E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:23:10,720] [INFO] [RANK 0] time (ms) | forward: 2020.09 | backward: 1744.52 | allreduce: 0.00 | optimizer: 16.63 | data loader: 0.08
[2024-09-15 22:24:26,537] [INFO] [RANK 0]  iteration     1880/  100000 | elapsed time per iteration (ms): 3790.9 | learning rate 9.913E-04 | total loss 2.871023E-01 | loss 2.871024E-01 | loss scale 8388608.0 |speed 15.83 samples/(min*GPU)
[2024-09-15 22:24:26,538] [INFO] [RANK 0] time (ms) | forward: 2030.57 | backward: 1743.08 | allreduce: 0.00 | optimizer: 16.39 | data loader: 0.11
[2024-09-15 22:25:42,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=10, lr=[0.0009911], mom=[[0.9, 0.95]]
[2024-09-15 22:25:42,197] [INFO] [RANK 0]  iteration     1900/  100000 | elapsed time per iteration (ms): 3783.0 | learning rate 9.911E-04 | total loss 2.601987E-01 | loss 2.601987E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:25:42,198] [INFO] [RANK 0] time (ms) | forward: 2023.26 | backward: 1742.52 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.12
[2024-09-15 22:26:57,799] [INFO] [RANK 0]  iteration     1920/  100000 | elapsed time per iteration (ms): 3780.1 | learning rate 9.909E-04 | total loss 2.354512E-01 | loss 2.354512E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:26:57,800] [INFO] [RANK 0] time (ms) | forward: 2021.35 | backward: 1741.59 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.12
[2024-09-15 22:28:13,415] [INFO] [RANK 0]  iteration     1940/  100000 | elapsed time per iteration (ms): 3780.8 | learning rate 9.907E-04 | total loss 3.078676E-01 | loss 3.078676E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:28:13,416] [INFO] [RANK 0] time (ms) | forward: 2021.43 | backward: 1742.06 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.12
[2024-09-15 22:28:51,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=10, lr=[0.0009906000000000001], mom=[[0.9, 0.95]]
[2024-09-15 22:29:29,262] [INFO] [RANK 0]  iteration     1960/  100000 | elapsed time per iteration (ms): 3792.3 | learning rate 9.905E-04 | total loss 2.621799E-01 | loss 2.621799E-01 | loss scale 8388608.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 22:29:29,262] [INFO] [RANK 0] time (ms) | forward: 2033.96 | backward: 1741.10 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.13
[2024-09-15 22:30:44,874] [INFO] [RANK 0]  iteration     1980/  100000 | elapsed time per iteration (ms): 3780.6 | learning rate 9.903E-04 | total loss 2.292665E-01 | loss 2.292665E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:30:44,875] [INFO] [RANK 0] time (ms) | forward: 2021.90 | backward: 1741.37 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.11
[2024-09-15 22:32:00,506] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=10, lr=[0.0009901], mom=[[0.9, 0.95]]
[2024-09-15 22:32:00,506] [INFO] [RANK 0]  iteration     2000/  100000 | elapsed time per iteration (ms): 3781.6 | learning rate 9.901E-04 | total loss 2.518917E-01 | loss 2.518917E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:32:00,508] [INFO] [RANK 0] time (ms) | forward: 2022.74 | backward: 1741.62 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.12
[2024-09-15 22:32:00,511] [INFO] [RANK 0] Saving Model...
[2024-09-15 22:32:02,319] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/2000/mp_rank_00_model_states.pt
[2024-09-15 22:32:02,320] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/2000/mp_rank_00_model_states.pt...
[2024-09-15 22:32:13,545] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/2000/mp_rank_00_model_states.pt.
[2024-09-15 22:32:13,644] [INFO] [RANK 0] Saving Ema Model...
[2024-09-15 22:32:14,280] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/2000-ema/mp_rank_00_model_states.pt
[2024-09-15 22:32:14,280] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/2000-ema/mp_rank_00_model_states.pt...
[2024-09-15 22:32:26,082] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/2000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:56,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:55,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:52,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:48,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:47,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
[2024-09-15 22:33:38,643] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 22:33:38,643] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 22:33:38,645] [INFO] [RANK 0]  validation loss at iteration 2000 | loss: 1.477456E-01 | PPL: 1.159218E+00 loss 1.477456E-01 |
[2024-09-15 22:33:38,645] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 2000 is less than current step: 2001. Dropping entry: {'Train/valid_ppl': 1.1592179127408826, 'Train/valid_loss': 0.14774556457996368, '_timestamp': 1726454018.6463504}).
[2024-09-15 22:34:53,894] [INFO] [RANK 0]  iteration     2020/  100000 | elapsed time per iteration (ms): 8669.4 | learning rate 9.899E-04 | total loss 2.665378E-01 | loss 2.665378E-01 | loss scale 8388608.0 |speed 6.92 samples/(min*GPU)
[2024-09-15 22:34:53,894] [INFO] [RANK 0] time (ms) | forward: 2015.29 | backward: 1729.86 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.12
[2024-09-15 22:36:09,459] [INFO] [RANK 0]  iteration     2040/  100000 | elapsed time per iteration (ms): 3778.3 | learning rate 9.897E-04 | total loss 2.846224E-01 | loss 2.846224E-01 | loss scale 8388608.0 |speed 15.88 samples/(min*GPU)
[2024-09-15 22:36:09,460] [INFO] [RANK 0] time (ms) | forward: 2022.27 | backward: 1738.56 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.12
[2024-09-15 22:36:47,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=10, lr=[0.0009896], mom=[[0.9, 0.95]]
[2024-09-15 22:37:25,080] [INFO] [RANK 0]  iteration     2060/  100000 | elapsed time per iteration (ms): 3781.1 | learning rate 9.895E-04 | total loss 2.418480E-01 | loss 2.418480E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:37:25,081] [INFO] [RANK 0] time (ms) | forward: 2025.03 | backward: 1738.55 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.11
[2024-09-15 22:38:40,691] [INFO] [RANK 0]  iteration     2080/  100000 | elapsed time per iteration (ms): 3780.5 | learning rate 9.893E-04 | total loss 2.731959E-01 | loss 2.731958E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:38:40,692] [INFO] [RANK 0] time (ms) | forward: 2021.93 | backward: 1741.21 | allreduce: 0.00 | optimizer: 16.48 | data loader: 0.13
[2024-09-15 22:39:56,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=10, lr=[0.0009891], mom=[[0.9, 0.95]]
[2024-09-15 22:39:56,340] [INFO] [RANK 0]  iteration     2100/  100000 | elapsed time per iteration (ms): 3782.4 | learning rate 9.891E-04 | total loss 2.972596E-01 | loss 2.972596E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:39:56,341] [INFO] [RANK 0] time (ms) | forward: 2021.66 | backward: 1743.10 | allreduce: 0.00 | optimizer: 16.79 | data loader: 0.12
[2024-09-15 22:41:11,939] [INFO] [RANK 0]  iteration     2120/  100000 | elapsed time per iteration (ms): 3780.0 | learning rate 9.889E-04 | total loss 2.662805E-01 | loss 2.662804E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:41:11,940] [INFO] [RANK 0] time (ms) | forward: 2022.36 | backward: 1739.84 | allreduce: 0.00 | optimizer: 16.88 | data loader: 0.14
[2024-09-15 22:42:27,569] [INFO] [RANK 0]  iteration     2140/  100000 | elapsed time per iteration (ms): 3781.5 | learning rate 9.887E-04 | total loss 2.815272E-01 | loss 2.815271E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:42:27,569] [INFO] [RANK 0] time (ms) | forward: 2022.72 | backward: 1741.59 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.12
[2024-09-15 22:43:05,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=10, lr=[0.0009886], mom=[[0.9, 0.95]]
[2024-09-15 22:43:43,181] [INFO] [RANK 0]  iteration     2160/  100000 | elapsed time per iteration (ms): 3780.6 | learning rate 9.885E-04 | total loss 2.636691E-01 | loss 2.636691E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:43:43,182] [INFO] [RANK 0] time (ms) | forward: 2021.52 | backward: 1741.43 | allreduce: 0.00 | optimizer: 16.77 | data loader: 0.12
[2024-09-15 22:44:58,823] [INFO] [RANK 0]  iteration     2180/  100000 | elapsed time per iteration (ms): 3782.1 | learning rate 9.883E-04 | total loss 2.588289E-01 | loss 2.588290E-01 | loss scale 8388608.0 |speed 15.86 samples/(min*GPU)
[2024-09-15 22:44:58,824] [INFO] [RANK 0] time (ms) | forward: 2024.53 | backward: 1740.26 | allreduce: 0.00 | optimizer: 16.42 | data loader: 0.12
[2024-09-15 22:46:14,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=10, lr=[0.0009881], mom=[[0.9, 0.95]]
[2024-09-15 22:46:14,424] [INFO] [RANK 0]  iteration     2200/  100000 | elapsed time per iteration (ms): 3780.0 | learning rate 9.881E-04 | total loss 2.606584E-01 | loss 2.606584E-01 | loss scale 8388608.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:46:14,425] [INFO] [RANK 0] time (ms) | forward: 2022.86 | backward: 1739.86 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:47,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:25,  1.26s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:23,  1.24s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:22,  1.23s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:41<00:20,  1.23s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.22s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:47<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:53<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:59<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [01:00<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [01:00<00:01,  1.20s/it]
[2024-09-15 22:47:27,471] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 22:47:27,472] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 22:47:27,473] [INFO] [RANK 0]  validation loss at iteration 2200 | loss: 2.785741E-01 | PPL: 1.321245E+00 loss 2.785741E-01 |
[2024-09-15 22:47:27,473] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 2200 is less than current step: 2201. Dropping entry: {'Train/valid_ppl': 1.321244517980156, 'Train/valid_loss': 0.2785741090774536, '_timestamp': 1726454847.4738786}).
[2024-09-15 22:48:35,501] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 8388608, reducing to 4194304
[2024-09-15 22:48:43,063] [INFO] [RANK 0]  iteration     2220/  100000 | elapsed time per iteration (ms): 7432.0 | learning rate 9.879E-04 | total loss 2.800880E-01 | loss 2.800880E-01 | loss scale 4194304.0 |speed 8.07 samples/(min*GPU)
[2024-09-15 22:48:43,064] [INFO] [RANK 0] time (ms) | forward: 2023.21 | backward: 1739.30 | allreduce: 0.00 | optimizer: 16.19 | data loader: 0.14
[2024-09-15 22:49:58,646] [INFO] [RANK 0]  iteration     2240/  100000 | elapsed time per iteration (ms): 3779.2 | learning rate 9.877E-04 | total loss 2.673903E-01 | loss 2.673903E-01 | loss scale 4194304.0 |speed 15.88 samples/(min*GPU)
[2024-09-15 22:49:58,647] [INFO] [RANK 0] time (ms) | forward: 2023.75 | backward: 1738.11 | allreduce: 0.00 | optimizer: 16.37 | data loader: 0.12
[2024-09-15 22:50:36,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=11, lr=[0.00098761], mom=[[0.9, 0.95]]
[2024-09-15 22:51:14,265] [INFO] [RANK 0]  iteration     2260/  100000 | elapsed time per iteration (ms): 3780.9 | learning rate 9.875E-04 | total loss 2.761445E-01 | loss 2.761445E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:51:14,266] [INFO] [RANK 0] time (ms) | forward: 2025.74 | backward: 1737.74 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.12
[2024-09-15 22:52:29,864] [INFO] [RANK 0]  iteration     2280/  100000 | elapsed time per iteration (ms): 3779.9 | learning rate 9.873E-04 | total loss 2.971665E-01 | loss 2.971666E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:52:29,864] [INFO] [RANK 0] time (ms) | forward: 2022.40 | backward: 1739.56 | allreduce: 0.00 | optimizer: 16.87 | data loader: 0.11
[2024-09-15 22:53:45,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=11, lr=[0.00098711], mom=[[0.9, 0.95]]
[2024-09-15 22:53:45,465] [INFO] [RANK 0]  iteration     2300/  100000 | elapsed time per iteration (ms): 3780.1 | learning rate 9.871E-04 | total loss 2.685513E-01 | loss 2.685514E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:53:45,467] [INFO] [RANK 0] time (ms) | forward: 2023.66 | backward: 1739.23 | allreduce: 0.00 | optimizer: 16.32 | data loader: 0.11
[2024-09-15 22:55:01,063] [INFO] [RANK 0]  iteration     2320/  100000 | elapsed time per iteration (ms): 3779.9 | learning rate 9.869E-04 | total loss 2.767392E-01 | loss 2.767392E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:55:01,063] [INFO] [RANK 0] time (ms) | forward: 2023.36 | backward: 1739.07 | allreduce: 0.00 | optimizer: 16.54 | data loader: 0.13
[2024-09-15 22:56:16,649] [INFO] [RANK 0]  iteration     2340/  100000 | elapsed time per iteration (ms): 3779.3 | learning rate 9.867E-04 | total loss 2.812539E-01 | loss 2.812539E-01 | loss scale 4194304.0 |speed 15.88 samples/(min*GPU)
[2024-09-15 22:56:16,649] [INFO] [RANK 0] time (ms) | forward: 2022.96 | backward: 1738.63 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.12
[2024-09-15 22:56:54,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=11, lr=[0.00098661], mom=[[0.9, 0.95]]
[2024-09-15 22:57:32,233] [INFO] [RANK 0]  iteration     2360/  100000 | elapsed time per iteration (ms): 3779.2 | learning rate 9.865E-04 | total loss 2.905354E-01 | loss 2.905354E-01 | loss scale 4194304.0 |speed 15.88 samples/(min*GPU)
[2024-09-15 22:57:32,234] [INFO] [RANK 0] time (ms) | forward: 2022.99 | backward: 1739.01 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.11
[2024-09-15 22:58:47,836] [INFO] [RANK 0]  iteration     2380/  100000 | elapsed time per iteration (ms): 3780.1 | learning rate 9.863E-04 | total loss 2.418989E-01 | loss 2.418989E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 22:58:47,836] [INFO] [RANK 0] time (ms) | forward: 2023.63 | backward: 1738.81 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.11
[2024-09-15 23:00:03,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=11, lr=[0.0009861100000000001], mom=[[0.9, 0.95]]
[2024-09-15 23:00:03,432] [INFO] [RANK 0]  iteration     2400/  100000 | elapsed time per iteration (ms): 3779.8 | learning rate 9.861E-04 | total loss 3.094103E-01 | loss 3.094103E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:00:03,434] [INFO] [RANK 0] time (ms) | forward: 2023.00 | backward: 1739.60 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 23:01:16,060] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 23:01:16,060] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 23:01:16,061] [INFO] [RANK 0]  validation loss at iteration 2400 | loss: 4.559999E-01 | PPL: 1.577750E+00 loss 4.559999E-01 |
[2024-09-15 23:01:16,061] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 2400 is less than current step: 2401. Dropping entry: {'Train/valid_ppl': 1.5777501570601564, 'Train/valid_loss': 0.45599988102912903, '_timestamp': 1726455676.0616171}).
[2024-09-15 23:02:31,894] [INFO] [RANK 0]  iteration     2420/  100000 | elapsed time per iteration (ms): 7423.1 | learning rate 9.859E-04 | total loss 2.363191E-01 | loss 2.363191E-01 | loss scale 4194304.0 |speed 8.08 samples/(min*GPU)
[2024-09-15 23:02:31,894] [INFO] [RANK 0] time (ms) | forward: 2035.98 | backward: 1738.31 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.12
[2024-09-15 23:03:47,732] [INFO] [RANK 0]  iteration     2440/  100000 | elapsed time per iteration (ms): 3791.9 | learning rate 9.857E-04 | total loss 2.827214E-01 | loss 2.827214E-01 | loss scale 4194304.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 23:03:47,732] [INFO] [RANK 0] time (ms) | forward: 2036.17 | backward: 1738.61 | allreduce: 0.00 | optimizer: 16.32 | data loader: 0.12
[2024-09-15 23:04:25,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=11, lr=[0.00098561], mom=[[0.9, 0.95]]
[2024-09-15 23:05:03,599] [INFO] [RANK 0]  iteration     2460/  100000 | elapsed time per iteration (ms): 3793.4 | learning rate 9.855E-04 | total loss 2.435907E-01 | loss 2.435906E-01 | loss scale 4194304.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 23:05:03,600] [INFO] [RANK 0] time (ms) | forward: 2036.47 | backward: 1739.62 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.13
[2024-09-15 23:06:19,332] [INFO] [RANK 0]  iteration     2480/  100000 | elapsed time per iteration (ms): 3786.7 | learning rate 9.853E-04 | total loss 2.306312E-01 | loss 2.306312E-01 | loss scale 4194304.0 |speed 15.85 samples/(min*GPU)
[2024-09-15 23:06:19,333] [INFO] [RANK 0] time (ms) | forward: 2030.94 | backward: 1738.52 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.13
[2024-09-15 23:07:35,115] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=11, lr=[0.00098511], mom=[[0.9, 0.95]]
[2024-09-15 23:07:35,116] [INFO] [RANK 0]  iteration     2500/  100000 | elapsed time per iteration (ms): 3789.2 | learning rate 9.851E-04 | total loss 2.015906E-01 | loss 2.015906E-01 | loss scale 4194304.0 |speed 15.83 samples/(min*GPU)
[2024-09-15 23:07:35,116] [INFO] [RANK 0] time (ms) | forward: 2032.67 | backward: 1739.10 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.13
[2024-09-15 23:07:35,117] [INFO] [RANK 0] Saving Model...
[2024-09-15 23:07:36,976] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/2500/mp_rank_00_model_states.pt
[2024-09-15 23:07:36,976] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/2500/mp_rank_00_model_states.pt...
[2024-09-15 23:07:57,568] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/2500/mp_rank_00_model_states.pt.
[2024-09-15 23:07:57,643] [INFO] [RANK 0] Saving Ema Model...
[2024-09-15 23:07:58,265] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/2500-ema/mp_rank_00_model_states.pt
[2024-09-15 23:07:58,265] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/2500-ema/mp_rank_00_model_states.pt...
[2024-09-15 23:08:19,820] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/2500-ema/mp_rank_00_model_states.pt.
[2024-09-15 23:09:34,486] [INFO] [RANK 0]  iteration     2520/  100000 | elapsed time per iteration (ms): 5968.5 | learning rate 9.849E-04 | total loss 2.943445E-01 | loss 2.943445E-01 | loss scale 4194304.0 |speed 10.05 samples/(min*GPU)
[2024-09-15 23:09:34,486] [INFO] [RANK 0] time (ms) | forward: 2007.94 | backward: 1703.44 | allreduce: 0.00 | optimizer: 16.30 | data loader: 0.12
[2024-09-15 23:10:49,592] [INFO] [RANK 0]  iteration     2540/  100000 | elapsed time per iteration (ms): 3755.3 | learning rate 9.847E-04 | total loss 2.502220E-01 | loss 2.502220E-01 | loss scale 4194304.0 |speed 15.98 samples/(min*GPU)
[2024-09-15 23:10:49,593] [INFO] [RANK 0] time (ms) | forward: 2012.78 | backward: 1725.37 | allreduce: 0.00 | optimizer: 16.34 | data loader: 0.14
[2024-09-15 23:11:27,226] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=11, lr=[0.00098461], mom=[[0.9, 0.95]]
[2024-09-15 23:12:04,939] [INFO] [RANK 0]  iteration     2560/  100000 | elapsed time per iteration (ms): 3767.4 | learning rate 9.845E-04 | total loss 2.450891E-01 | loss 2.450891E-01 | loss scale 4194304.0 |speed 15.93 samples/(min*GPU)
[2024-09-15 23:12:04,940] [INFO] [RANK 0] time (ms) | forward: 2016.86 | backward: 1733.14 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.14
[2024-09-15 23:13:20,544] [INFO] [RANK 0]  iteration     2580/  100000 | elapsed time per iteration (ms): 3780.2 | learning rate 9.843E-04 | total loss 2.704525E-01 | loss 2.704525E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:13:20,545] [INFO] [RANK 0] time (ms) | forward: 2025.72 | backward: 1737.39 | allreduce: 0.00 | optimizer: 16.32 | data loader: 0.13
[2024-09-15 23:14:36,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=11, lr=[0.00098411], mom=[[0.9, 0.95]]
[2024-09-15 23:14:36,181] [INFO] [RANK 0]  iteration     2600/  100000 | elapsed time per iteration (ms): 3781.9 | learning rate 9.841E-04 | total loss 2.533118E-01 | loss 2.533118E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:14:36,182] [INFO] [RANK 0] time (ms) | forward: 2025.62 | backward: 1738.79 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 23:15:48,747] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 23:15:48,748] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 23:15:48,748] [INFO] [RANK 0]  validation loss at iteration 2600 | loss: 1.574571E-01 | PPL: 1.170531E+00 loss 1.574571E-01 |
[2024-09-15 23:15:48,748] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 2600 is less than current step: 2601. Dropping entry: {'Train/valid_ppl': 1.1705305043457908, 'Train/valid_loss': 0.15745706856250763, '_timestamp': 1726456548.7486615}).
[2024-09-15 23:17:04,360] [INFO] [RANK 0]  iteration     2620/  100000 | elapsed time per iteration (ms): 7409.0 | learning rate 9.839E-04 | total loss 2.442088E-01 | loss 2.442088E-01 | loss scale 4194304.0 |speed 8.10 samples/(min*GPU)
[2024-09-15 23:17:04,361] [INFO] [RANK 0] time (ms) | forward: 2024.33 | backward: 1738.99 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.13
[2024-09-15 23:18:19,960] [INFO] [RANK 0]  iteration     2640/  100000 | elapsed time per iteration (ms): 3780.0 | learning rate 9.837E-04 | total loss 2.901176E-01 | loss 2.901177E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:18:19,961] [INFO] [RANK 0] time (ms) | forward: 2023.87 | backward: 1738.81 | allreduce: 0.00 | optimizer: 16.49 | data loader: 0.12
[2024-09-15 23:18:57,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=11, lr=[0.00098361], mom=[[0.9, 0.95]]
[2024-09-15 23:19:35,569] [INFO] [RANK 0]  iteration     2660/  100000 | elapsed time per iteration (ms): 3780.5 | learning rate 9.835E-04 | total loss 2.608379E-01 | loss 2.608380E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:19:35,570] [INFO] [RANK 0] time (ms) | forward: 2022.69 | backward: 1740.51 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.12
[2024-09-15 23:20:51,145] [INFO] [RANK 0]  iteration     2680/  100000 | elapsed time per iteration (ms): 3778.8 | learning rate 9.833E-04 | total loss 2.612255E-01 | loss 2.612255E-01 | loss scale 4194304.0 |speed 15.88 samples/(min*GPU)
[2024-09-15 23:20:51,145] [INFO] [RANK 0] time (ms) | forward: 2021.09 | backward: 1740.23 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.13
[2024-09-15 23:22:06,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=11, lr=[0.0009831100000000001], mom=[[0.9, 0.95]]
[2024-09-15 23:22:06,743] [INFO] [RANK 0]  iteration     2700/  100000 | elapsed time per iteration (ms): 3779.9 | learning rate 9.831E-04 | total loss 2.887925E-01 | loss 2.887925E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:22:06,743] [INFO] [RANK 0] time (ms) | forward: 2021.64 | backward: 1740.87 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.14
[2024-09-15 23:23:22,348] [INFO] [RANK 0]  iteration     2720/  100000 | elapsed time per iteration (ms): 3780.3 | learning rate 9.829E-04 | total loss 2.809424E-01 | loss 2.809424E-01 | loss scale 4194304.0 |speed 15.87 samples/(min*GPU)
[2024-09-15 23:23:22,349] [INFO] [RANK 0] time (ms) | forward: 2020.80 | backward: 1741.82 | allreduce: 0.00 | optimizer: 16.80 | data loader: 0.14
[2024-09-15 23:24:38,511] [INFO] [RANK 0]  iteration     2740/  100000 | elapsed time per iteration (ms): 3808.1 | learning rate 9.827E-04 | total loss 2.697473E-01 | loss 2.697473E-01 | loss scale 4194304.0 |speed 15.76 samples/(min*GPU)
[2024-09-15 23:24:38,511] [INFO] [RANK 0] time (ms) | forward: 2019.76 | backward: 1771.00 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.13
[2024-09-15 23:25:16,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=11, lr=[0.00098261], mom=[[0.9, 0.95]]
[2024-09-15 23:25:54,345] [INFO] [RANK 0]  iteration     2760/  100000 | elapsed time per iteration (ms): 3791.7 | learning rate 9.825E-04 | total loss 3.169772E-01 | loss 3.169772E-01 | loss scale 4194304.0 |speed 15.82 samples/(min*GPU)
[2024-09-15 23:25:54,345] [INFO] [RANK 0] time (ms) | forward: 2025.54 | backward: 1748.49 | allreduce: 0.00 | optimizer: 16.85 | data loader: 0.12
[2024-09-15 23:27:10,039] [INFO] [RANK 0]  iteration     2780/  100000 | elapsed time per iteration (ms): 3784.7 | learning rate 9.823E-04 | total loss 2.321609E-01 | loss 2.321609E-01 | loss scale 4194304.0 |speed 15.85 samples/(min*GPU)
[2024-09-15 23:27:10,040] [INFO] [RANK 0] time (ms) | forward: 2019.33 | backward: 1747.93 | allreduce: 0.00 | optimizer: 16.59 | data loader: 0.12
[2024-09-15 23:28:26,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=11, lr=[0.00098211], mom=[[0.9, 0.95]]
[2024-09-15 23:28:26,272] [INFO] [RANK 0]  iteration     2800/  100000 | elapsed time per iteration (ms): 3811.6 | learning rate 9.821E-04 | total loss 2.702826E-01 | loss 2.702826E-01 | loss scale 4194304.0 |speed 15.74 samples/(min*GPU)
[2024-09-15 23:28:26,272] [INFO] [RANK 0] time (ms) | forward: 2029.35 | backward: 1764.91 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 23:29:38,835] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 23:29:38,836] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 23:29:38,836] [INFO] [RANK 0]  validation loss at iteration 2800 | loss: 1.602877E-01 | PPL: 1.173849E+00 loss 1.602877E-01 |
[2024-09-15 23:29:38,836] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 2800 is less than current step: 2801. Dropping entry: {'Train/valid_ppl': 1.1738485130996432, 'Train/valid_loss': 0.16028767824172974, '_timestamp': 1726457378.8367312}).
[2024-09-15 23:30:54,534] [INFO] [RANK 0]  iteration     2820/  100000 | elapsed time per iteration (ms): 7413.1 | learning rate 9.819E-04 | total loss 2.419498E-01 | loss 2.419498E-01 | loss scale 4194304.0 |speed 8.09 samples/(min*GPU)
[2024-09-15 23:30:54,535] [INFO] [RANK 0] time (ms) | forward: 2021.13 | backward: 1746.08 | allreduce: 0.00 | optimizer: 16.86 | data loader: 0.17
[2024-09-15 23:32:14,926] [INFO] [RANK 0]  iteration     2840/  100000 | elapsed time per iteration (ms): 4019.6 | learning rate 9.817E-04 | total loss 2.405028E-01 | loss 2.405028E-01 | loss scale 4194304.0 |speed 14.93 samples/(min*GPU)
[2024-09-15 23:32:14,927] [INFO] [RANK 0] time (ms) | forward: 2087.64 | backward: 1914.66 | allreduce: 0.00 | optimizer: 16.48 | data loader: 0.13
[2024-09-15 23:32:54,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=11, lr=[0.00098161], mom=[[0.9, 0.95]]
[2024-09-15 23:33:35,743] [INFO] [RANK 0]  iteration     2860/  100000 | elapsed time per iteration (ms): 4040.8 | learning rate 9.815E-04 | total loss 3.018004E-01 | loss 3.018004E-01 | loss scale 4194304.0 |speed 14.85 samples/(min*GPU)
[2024-09-15 23:33:35,743] [INFO] [RANK 0] time (ms) | forward: 2136.19 | backward: 1887.39 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.10
[2024-09-15 23:34:56,745] [INFO] [RANK 0]  iteration     2880/  100000 | elapsed time per iteration (ms): 4050.1 | learning rate 9.813E-04 | total loss 2.578792E-01 | loss 2.578792E-01 | loss scale 4194304.0 |speed 14.81 samples/(min*GPU)
[2024-09-15 23:34:56,745] [INFO] [RANK 0] time (ms) | forward: 2115.36 | backward: 1917.49 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.13
[2024-09-15 23:36:17,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=11, lr=[0.00098111], mom=[[0.9, 0.95]]
[2024-09-15 23:36:17,897] [INFO] [RANK 0]  iteration     2900/  100000 | elapsed time per iteration (ms): 4057.6 | learning rate 9.811E-04 | total loss 2.891790E-01 | loss 2.891790E-01 | loss scale 4194304.0 |speed 14.79 samples/(min*GPU)
[2024-09-15 23:36:17,897] [INFO] [RANK 0] time (ms) | forward: 2111.52 | backward: 1928.91 | allreduce: 0.00 | optimizer: 16.35 | data loader: 0.12
[2024-09-15 23:37:38,893] [INFO] [RANK 0]  iteration     2920/  100000 | elapsed time per iteration (ms): 4049.8 | learning rate 9.809E-04 | total loss 2.752726E-01 | loss 2.752726E-01 | loss scale 4194304.0 |speed 14.82 samples/(min*GPU)
[2024-09-15 23:37:38,894] [INFO] [RANK 0] time (ms) | forward: 2113.83 | backward: 1918.51 | allreduce: 0.00 | optimizer: 16.64 | data loader: 0.11
[2024-09-15 23:39:00,102] [INFO] [RANK 0]  iteration     2940/  100000 | elapsed time per iteration (ms): 4060.4 | learning rate 9.807E-04 | total loss 2.566371E-01 | loss 2.566371E-01 | loss scale 4194304.0 |speed 14.78 samples/(min*GPU)
[2024-09-15 23:39:00,102] [INFO] [RANK 0] time (ms) | forward: 2132.25 | backward: 1910.66 | allreduce: 0.00 | optimizer: 16.69 | data loader: 0.12
[2024-09-15 23:39:40,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=11, lr=[0.00098061], mom=[[0.9, 0.95]]
[2024-09-15 23:40:20,960] [INFO] [RANK 0]  iteration     2960/  100000 | elapsed time per iteration (ms): 4042.9 | learning rate 9.805E-04 | total loss 3.025297E-01 | loss 3.025297E-01 | loss scale 4194304.0 |speed 14.84 samples/(min*GPU)
[2024-09-15 23:40:20,960] [INFO] [RANK 0] time (ms) | forward: 2120.51 | backward: 1904.43 | allreduce: 0.00 | optimizer: 17.13 | data loader: 0.12
[2024-09-15 23:41:41,053] [INFO] [RANK 0]  iteration     2980/  100000 | elapsed time per iteration (ms): 4004.6 | learning rate 9.803E-04 | total loss 3.032862E-01 | loss 3.032862E-01 | loss scale 4194304.0 |speed 14.98 samples/(min*GPU)
[2024-09-15 23:41:41,053] [INFO] [RANK 0] time (ms) | forward: 2107.59 | backward: 1879.35 | allreduce: 0.00 | optimizer: 16.86 | data loader: 0.12
[2024-09-15 23:43:02,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=11, lr=[0.00098011], mom=[[0.9, 0.95]]
[2024-09-15 23:43:02,009] [INFO] [RANK 0]  iteration     3000/  100000 | elapsed time per iteration (ms): 4047.8 | learning rate 9.801E-04 | total loss 3.008218E-01 | loss 3.008218E-01 | loss scale 4194304.0 |speed 14.82 samples/(min*GPU)
[2024-09-15 23:43:02,010] [INFO] [RANK 0] time (ms) | forward: 2128.39 | backward: 1902.30 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.13
[2024-09-15 23:43:02,010] [INFO] [RANK 0] Saving Model...
[2024-09-15 23:43:03,845] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/3000/mp_rank_00_model_states.pt
[2024-09-15 23:43:03,846] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/3000/mp_rank_00_model_states.pt...
[2024-09-15 23:43:27,434] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/3000/mp_rank_00_model_states.pt.
[2024-09-15 23:43:27,521] [INFO] [RANK 0] Saving Ema Model...
[2024-09-15 23:43:28,147] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/3000-ema/mp_rank_00_model_states.pt
[2024-09-15 23:43:28,148] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/3000-ema/mp_rank_00_model_states.pt...
[2024-09-15 23:43:49,350] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/3000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:54,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:52,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:48,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:47,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:13<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:40,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:39,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:26<00:32,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:31,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:30,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:32<00:27,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:33<00:26,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:24,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:39<00:20,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:18,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:45<00:14,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:51<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:57<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.18s/it]
[2024-09-15 23:45:01,299] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 23:45:01,299] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 23:45:01,299] [INFO] [RANK 0]  validation loss at iteration 3000 | loss: 5.460973E-01 | PPL: 1.726502E+00 loss 5.460973E-01 |
[2024-09-15 23:45:01,299] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 3000 is less than current step: 3001. Dropping entry: {'Train/valid_ppl': 1.7265017968507355, 'Train/valid_loss': 0.5460972785949707, '_timestamp': 1726458301.3002512}).
[2024-09-15 23:46:21,498] [INFO] [RANK 0]  iteration     3020/  100000 | elapsed time per iteration (ms): 9974.4 | learning rate 9.799E-04 | total loss 2.709957E-01 | loss 2.709957E-01 | loss scale 4194304.0 |speed 6.02 samples/(min*GPU)
[2024-09-15 23:46:21,499] [INFO] [RANK 0] time (ms) | forward: 2067.02 | backward: 1925.31 | allreduce: 0.00 | optimizer: 16.77 | data loader: 0.14
[2024-09-15 23:47:41,320] [INFO] [RANK 0]  iteration     3040/  100000 | elapsed time per iteration (ms): 3991.1 | learning rate 9.797E-04 | total loss 2.609398E-01 | loss 2.609398E-01 | loss scale 4194304.0 |speed 15.03 samples/(min*GPU)
[2024-09-15 23:47:41,321] [INFO] [RANK 0] time (ms) | forward: 2108.12 | backward: 1865.77 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.12
[2024-09-15 23:48:21,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=11, lr=[0.00097961], mom=[[0.9, 0.95]]
[2024-09-15 23:49:02,260] [INFO] [RANK 0]  iteration     3060/  100000 | elapsed time per iteration (ms): 4047.0 | learning rate 9.795E-04 | total loss 2.571570E-01 | loss 2.571570E-01 | loss scale 4194304.0 |speed 14.83 samples/(min*GPU)
[2024-09-15 23:49:02,261] [INFO] [RANK 0] time (ms) | forward: 2107.39 | backward: 1922.42 | allreduce: 0.00 | optimizer: 16.39 | data loader: 0.13
[2024-09-15 23:50:22,499] [INFO] [RANK 0]  iteration     3080/  100000 | elapsed time per iteration (ms): 4011.9 | learning rate 9.793E-04 | total loss 2.657479E-01 | loss 2.657479E-01 | loss scale 4194304.0 |speed 14.96 samples/(min*GPU)
[2024-09-15 23:50:22,500] [INFO] [RANK 0] time (ms) | forward: 2111.94 | backward: 1882.75 | allreduce: 0.00 | optimizer: 16.41 | data loader: 0.11
[2024-09-15 23:51:44,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=11, lr=[0.00097911], mom=[[0.9, 0.95]]
[2024-09-15 23:51:44,126] [INFO] [RANK 0]  iteration     3100/  100000 | elapsed time per iteration (ms): 4081.3 | learning rate 9.791E-04 | total loss 2.427825E-01 | loss 2.427825E-01 | loss scale 4194304.0 |speed 14.70 samples/(min*GPU)
[2024-09-15 23:51:44,126] [INFO] [RANK 0] time (ms) | forward: 2140.15 | backward: 1923.77 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.13
[2024-09-15 23:53:04,488] [INFO] [RANK 0]  iteration     3120/  100000 | elapsed time per iteration (ms): 4018.1 | learning rate 9.789E-04 | total loss 2.984623E-01 | loss 2.984624E-01 | loss scale 4194304.0 |speed 14.93 samples/(min*GPU)
[2024-09-15 23:53:04,489] [INFO] [RANK 0] time (ms) | forward: 2084.40 | backward: 1916.62 | allreduce: 0.00 | optimizer: 16.29 | data loader: 0.11
[2024-09-15 23:54:25,454] [INFO] [RANK 0]  iteration     3140/  100000 | elapsed time per iteration (ms): 4048.3 | learning rate 9.787E-04 | total loss 2.967833E-01 | loss 2.967833E-01 | loss scale 4194304.0 |speed 14.82 samples/(min*GPU)
[2024-09-15 23:54:25,455] [INFO] [RANK 0] time (ms) | forward: 2108.82 | backward: 1922.07 | allreduce: 0.00 | optimizer: 16.59 | data loader: 0.14
[2024-09-15 23:55:06,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=11, lr=[0.00097861], mom=[[0.9, 0.95]]
[2024-09-15 23:55:46,633] [INFO] [RANK 0]  iteration     3160/  100000 | elapsed time per iteration (ms): 4059.0 | learning rate 9.785E-04 | total loss 3.105317E-01 | loss 3.105317E-01 | loss scale 4194304.0 |speed 14.78 samples/(min*GPU)
[2024-09-15 23:55:46,634] [INFO] [RANK 0] time (ms) | forward: 2135.96 | backward: 1905.84 | allreduce: 0.00 | optimizer: 16.37 | data loader: 0.14
[2024-09-15 23:57:07,445] [INFO] [RANK 0]  iteration     3180/  100000 | elapsed time per iteration (ms): 4040.6 | learning rate 9.783E-04 | total loss 2.919774E-01 | loss 2.919774E-01 | loss scale 4194304.0 |speed 14.85 samples/(min*GPU)
[2024-09-15 23:57:07,446] [INFO] [RANK 0] time (ms) | forward: 2121.38 | backward: 1901.90 | allreduce: 0.00 | optimizer: 16.50 | data loader: 0.14
[2024-09-15 23:58:28,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=11, lr=[0.0009781100000000001], mom=[[0.9, 0.95]]
[2024-09-15 23:58:28,462] [INFO] [RANK 0]  iteration     3200/  100000 | elapsed time per iteration (ms): 4050.8 | learning rate 9.781E-04 | total loss 2.757958E-01 | loss 2.757958E-01 | loss scale 4194304.0 |speed 14.81 samples/(min*GPU)
[2024-09-15 23:58:28,462] [INFO] [RANK 0] time (ms) | forward: 2114.40 | backward: 1918.98 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:47,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-15 23:59:40,974] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-15 23:59:40,975] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-15 23:59:40,975] [INFO] [RANK 0]  validation loss at iteration 3200 | loss: 2.157780E-01 | PPL: 1.240827E+00 loss 2.157780E-01 |
[2024-09-15 23:59:40,975] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 3200 is less than current step: 3201. Dropping entry: {'Train/valid_ppl': 1.2408268949083956, 'Train/valid_loss': 0.21577800810337067, '_timestamp': 1726459180.9754322}).
[2024-09-16 00:01:02,353] [INFO] [RANK 0]  iteration     3220/  100000 | elapsed time per iteration (ms): 7694.6 | learning rate 9.779E-04 | total loss 2.582720E-01 | loss 2.582720E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 00:01:02,354] [INFO] [RANK 0] time (ms) | forward: 2119.69 | backward: 1931.29 | allreduce: 0.00 | optimizer: 17.15 | data loader: 0.15
[2024-09-16 00:02:23,431] [INFO] [RANK 0]  iteration     3240/  100000 | elapsed time per iteration (ms): 4053.9 | learning rate 9.777E-04 | total loss 2.367033E-01 | loss 2.367033E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 00:02:23,432] [INFO] [RANK 0] time (ms) | forward: 2141.04 | backward: 1895.48 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.12
[2024-09-16 00:03:03,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=11, lr=[0.00097761], mom=[[0.9, 0.95]]
[2024-09-16 00:03:43,317] [INFO] [RANK 0]  iteration     3260/  100000 | elapsed time per iteration (ms): 3994.3 | learning rate 9.775E-04 | total loss 2.674557E-01 | loss 2.674557E-01 | loss scale 8388608.0 |speed 15.02 samples/(min*GPU)
[2024-09-16 00:03:43,318] [INFO] [RANK 0] time (ms) | forward: 2113.88 | backward: 1863.27 | allreduce: 0.00 | optimizer: 16.36 | data loader: 0.12
[2024-09-16 00:05:04,149] [INFO] [RANK 0]  iteration     3280/  100000 | elapsed time per iteration (ms): 4041.6 | learning rate 9.773E-04 | total loss 2.582732E-01 | loss 2.582732E-01 | loss scale 8388608.0 |speed 14.85 samples/(min*GPU)
[2024-09-16 00:05:04,150] [INFO] [RANK 0] time (ms) | forward: 2108.26 | backward: 1916.02 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.14
[2024-09-16 00:06:26,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=11, lr=[0.00097711], mom=[[0.9, 0.95]]
[2024-09-16 00:06:26,355] [INFO] [RANK 0]  iteration     3300/  100000 | elapsed time per iteration (ms): 4110.3 | learning rate 9.771E-04 | total loss 2.393815E-01 | loss 2.393815E-01 | loss scale 8388608.0 |speed 14.60 samples/(min*GPU)
[2024-09-16 00:06:26,355] [INFO] [RANK 0] time (ms) | forward: 2163.08 | backward: 1930.02 | allreduce: 0.00 | optimizer: 16.34 | data loader: 0.12
[2024-09-16 00:07:46,520] [INFO] [RANK 0]  iteration     3320/  100000 | elapsed time per iteration (ms): 4008.3 | learning rate 9.769E-04 | total loss 2.880405E-01 | loss 2.880405E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 00:07:46,521] [INFO] [RANK 0] time (ms) | forward: 2062.57 | backward: 1927.80 | allreduce: 0.00 | optimizer: 17.10 | data loader: 0.15
[2024-09-16 00:09:07,074] [INFO] [RANK 0]  iteration     3340/  100000 | elapsed time per iteration (ms): 4027.7 | learning rate 9.767E-04 | total loss 3.537430E-01 | loss 3.537431E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 00:09:07,075] [INFO] [RANK 0] time (ms) | forward: 2130.56 | backward: 1879.85 | allreduce: 0.00 | optimizer: 16.50 | data loader: 0.12
[2024-09-16 00:09:47,392] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=11, lr=[0.00097661], mom=[[0.9, 0.95]]
[2024-09-16 00:10:28,272] [INFO] [RANK 0]  iteration     3360/  100000 | elapsed time per iteration (ms): 4059.9 | learning rate 9.765E-04 | total loss 3.078650E-01 | loss 3.078650E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 00:10:28,273] [INFO] [RANK 0] time (ms) | forward: 2092.40 | backward: 1949.71 | allreduce: 0.00 | optimizer: 16.93 | data loader: 0.13
[2024-09-16 00:11:49,300] [INFO] [RANK 0]  iteration     3380/  100000 | elapsed time per iteration (ms): 4051.4 | learning rate 9.763E-04 | total loss 3.136054E-01 | loss 3.136054E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 00:11:49,301] [INFO] [RANK 0] time (ms) | forward: 2110.59 | backward: 1923.34 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.14
[2024-09-16 00:13:10,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=11, lr=[0.0009761100000000001], mom=[[0.9, 0.95]]
[2024-09-16 00:13:10,466] [INFO] [RANK 0]  iteration     3400/  100000 | elapsed time per iteration (ms): 4058.3 | learning rate 9.761E-04 | total loss 2.970043E-01 | loss 2.970043E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 00:13:10,467] [INFO] [RANK 0] time (ms) | forward: 2117.43 | backward: 1922.07 | allreduce: 0.00 | optimizer: 17.98 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 00:14:23,081] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 00:14:23,082] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 00:14:23,082] [INFO] [RANK 0]  validation loss at iteration 3400 | loss: 3.060964E-01 | PPL: 1.358113E+00 loss 3.060964E-01 |
[2024-09-16 00:14:23,082] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 3400 is less than current step: 3401. Dropping entry: {'Train/valid_ppl': 1.358113269333768, 'Train/valid_loss': 0.3060964345932007, '_timestamp': 1726460063.082532}).
[2024-09-16 00:15:44,307] [INFO] [RANK 0]  iteration     3420/  100000 | elapsed time per iteration (ms): 7692.1 | learning rate 9.759E-04 | total loss 2.586516E-01 | loss 2.586516E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 00:15:44,308] [INFO] [RANK 0] time (ms) | forward: 2126.62 | backward: 1917.26 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.14
[2024-09-16 00:17:04,566] [INFO] [RANK 0]  iteration     3440/  100000 | elapsed time per iteration (ms): 4012.9 | learning rate 9.757E-04 | total loss 2.654808E-01 | loss 2.654808E-01 | loss scale 8388608.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 00:17:04,566] [INFO] [RANK 0] time (ms) | forward: 2082.16 | backward: 1913.10 | allreduce: 0.00 | optimizer: 16.82 | data loader: 0.12
[2024-09-16 00:17:44,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=11, lr=[0.00097561], mom=[[0.9, 0.95]]
[2024-09-16 00:18:24,504] [INFO] [RANK 0]  iteration     3460/  100000 | elapsed time per iteration (ms): 3996.9 | learning rate 9.755E-04 | total loss 2.768937E-01 | loss 2.768937E-01 | loss scale 8388608.0 |speed 15.01 samples/(min*GPU)
[2024-09-16 00:18:24,505] [INFO] [RANK 0] time (ms) | forward: 2116.54 | backward: 1862.91 | allreduce: 0.00 | optimizer: 16.63 | data loader: 0.12
[2024-09-16 00:19:45,778] [INFO] [RANK 0]  iteration     3480/  100000 | elapsed time per iteration (ms): 4063.7 | learning rate 9.753E-04 | total loss 3.210615E-01 | loss 3.210615E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 00:19:45,778] [INFO] [RANK 0] time (ms) | forward: 2120.79 | backward: 1925.48 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.12
[2024-09-16 00:21:07,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=11, lr=[0.0009751100000000001], mom=[[0.9, 0.95]]
[2024-09-16 00:21:07,138] [INFO] [RANK 0]  iteration     3500/  100000 | elapsed time per iteration (ms): 4068.0 | learning rate 9.751E-04 | total loss 3.282876E-01 | loss 3.282877E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 00:21:07,138] [INFO] [RANK 0] time (ms) | forward: 2130.19 | backward: 1920.56 | allreduce: 0.00 | optimizer: 16.42 | data loader: 0.10
[2024-09-16 00:21:07,138] [INFO] [RANK 0] Saving Model...
[2024-09-16 00:21:08,944] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/3500/mp_rank_00_model_states.pt
[2024-09-16 00:21:08,944] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/3500/mp_rank_00_model_states.pt...
[2024-09-16 00:21:30,999] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/3500/mp_rank_00_model_states.pt.
[2024-09-16 00:21:31,071] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 00:21:31,627] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/3500-ema/mp_rank_00_model_states.pt
[2024-09-16 00:21:31,627] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/3500-ema/mp_rank_00_model_states.pt...
[2024-09-16 00:21:53,067] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/3500-ema/mp_rank_00_model_states.pt.
[2024-09-16 00:23:13,641] [INFO] [RANK 0]  iteration     3520/  100000 | elapsed time per iteration (ms): 6325.2 | learning rate 9.749E-04 | total loss 2.861338E-01 | loss 2.861338E-01 | loss scale 8388608.0 |speed 9.49 samples/(min*GPU)
[2024-09-16 00:23:13,642] [INFO] [RANK 0] time (ms) | forward: 2048.11 | backward: 1960.13 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.10
[2024-09-16 00:24:33,637] [INFO] [RANK 0]  iteration     3540/  100000 | elapsed time per iteration (ms): 3999.8 | learning rate 9.747E-04 | total loss 3.181045E-01 | loss 3.181045E-01 | loss scale 8388608.0 |speed 15.00 samples/(min*GPU)
[2024-09-16 00:24:33,638] [INFO] [RANK 0] time (ms) | forward: 2114.96 | backward: 1867.57 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.12
[2024-09-16 00:25:14,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=11, lr=[0.00097461], mom=[[0.9, 0.95]]
[2024-09-16 00:25:54,532] [INFO] [RANK 0]  iteration     3560/  100000 | elapsed time per iteration (ms): 4044.7 | learning rate 9.745E-04 | total loss 2.481522E-01 | loss 2.481522E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 00:25:54,532] [INFO] [RANK 0] time (ms) | forward: 2125.97 | backward: 1901.12 | allreduce: 0.00 | optimizer: 16.80 | data loader: 0.12
[2024-09-16 00:27:14,615] [INFO] [RANK 0]  iteration     3580/  100000 | elapsed time per iteration (ms): 4004.2 | learning rate 9.743E-04 | total loss 2.442746E-01 | loss 2.442746E-01 | loss scale 8388608.0 |speed 14.98 samples/(min*GPU)
[2024-09-16 00:27:14,616] [INFO] [RANK 0] time (ms) | forward: 2119.01 | backward: 1867.51 | allreduce: 0.00 | optimizer: 16.82 | data loader: 0.13
[2024-09-16 00:28:35,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=11, lr=[0.00097411], mom=[[0.9, 0.95]]
[2024-09-16 00:28:35,701] [INFO] [RANK 0]  iteration     3600/  100000 | elapsed time per iteration (ms): 4054.3 | learning rate 9.741E-04 | total loss 2.619606E-01 | loss 2.619606E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 00:28:35,701] [INFO] [RANK 0] time (ms) | forward: 2112.04 | backward: 1924.87 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 00:29:48,610] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 00:29:48,611] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 00:29:48,611] [INFO] [RANK 0]  validation loss at iteration 3600 | loss: 2.109318E-01 | PPL: 1.234828E+00 loss 2.109318E-01 |
[2024-09-16 00:29:48,611] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 3600 is less than current step: 3601. Dropping entry: {'Train/valid_ppl': 1.2348281096877554, 'Train/valid_loss': 0.21093177795410156, '_timestamp': 1726460988.6118147}).
[2024-09-16 00:31:09,556] [INFO] [RANK 0]  iteration     3620/  100000 | elapsed time per iteration (ms): 7692.8 | learning rate 9.739E-04 | total loss 2.910051E-01 | loss 2.910051E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 00:31:09,556] [INFO] [RANK 0] time (ms) | forward: 2133.32 | backward: 1896.36 | allreduce: 0.00 | optimizer: 16.75 | data loader: 0.14
[2024-09-16 00:32:31,449] [INFO] [RANK 0]  iteration     3640/  100000 | elapsed time per iteration (ms): 4094.6 | learning rate 9.737E-04 | total loss 2.574288E-01 | loss 2.574288E-01 | loss scale 8388608.0 |speed 14.65 samples/(min*GPU)
[2024-09-16 00:32:31,449] [INFO] [RANK 0] time (ms) | forward: 2154.30 | backward: 1923.06 | allreduce: 0.00 | optimizer: 16.45 | data loader: 0.13
[2024-09-16 00:33:11,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=11, lr=[0.00097361], mom=[[0.9, 0.95]]
[2024-09-16 00:33:52,779] [INFO] [RANK 0]  iteration     3660/  100000 | elapsed time per iteration (ms): 4066.5 | learning rate 9.735E-04 | total loss 2.326657E-01 | loss 2.326657E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 00:33:52,780] [INFO] [RANK 0] time (ms) | forward: 2116.75 | backward: 1932.37 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.11
[2024-09-16 00:35:14,137] [INFO] [RANK 0]  iteration     3680/  100000 | elapsed time per iteration (ms): 4067.9 | learning rate 9.733E-04 | total loss 2.938448E-01 | loss 2.938448E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 00:35:14,138] [INFO] [RANK 0] time (ms) | forward: 2115.12 | backward: 1935.55 | allreduce: 0.00 | optimizer: 16.40 | data loader: 0.13
[2024-09-16 00:36:34,866] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=11, lr=[0.00097311], mom=[[0.9, 0.95]]
[2024-09-16 00:36:34,867] [INFO] [RANK 0]  iteration     3700/  100000 | elapsed time per iteration (ms): 4036.5 | learning rate 9.731E-04 | total loss 2.388266E-01 | loss 2.388266E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 00:36:34,867] [INFO] [RANK 0] time (ms) | forward: 2117.00 | backward: 1902.09 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.12
[2024-09-16 00:37:55,741] [INFO] [RANK 0]  iteration     3720/  100000 | elapsed time per iteration (ms): 4043.7 | learning rate 9.729E-04 | total loss 2.925904E-01 | loss 2.925904E-01 | loss scale 8388608.0 |speed 14.84 samples/(min*GPU)
[2024-09-16 00:37:55,742] [INFO] [RANK 0] time (ms) | forward: 2095.71 | backward: 1930.70 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.14
[2024-09-16 00:39:16,874] [INFO] [RANK 0]  iteration     3740/  100000 | elapsed time per iteration (ms): 4056.7 | learning rate 9.727E-04 | total loss 2.947077E-01 | loss 2.947077E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 00:39:16,875] [INFO] [RANK 0] time (ms) | forward: 2116.48 | backward: 1922.66 | allreduce: 0.00 | optimizer: 16.70 | data loader: 0.12
[2024-09-16 00:39:57,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=11, lr=[0.00097261], mom=[[0.9, 0.95]]
[2024-09-16 00:40:37,864] [INFO] [RANK 0]  iteration     3760/  100000 | elapsed time per iteration (ms): 4049.5 | learning rate 9.725E-04 | total loss 2.849612E-01 | loss 2.849612E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 00:40:37,864] [INFO] [RANK 0] time (ms) | forward: 2114.57 | backward: 1917.51 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.12
[2024-09-16 00:41:59,266] [INFO] [RANK 0]  iteration     3780/  100000 | elapsed time per iteration (ms): 4070.1 | learning rate 9.723E-04 | total loss 2.381487E-01 | loss 2.381487E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 00:41:59,267] [INFO] [RANK 0] time (ms) | forward: 2122.02 | backward: 1920.61 | allreduce: 0.00 | optimizer: 16.89 | data loader: 0.13
[2024-09-16 00:43:20,338] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=11, lr=[0.0009721100000000001], mom=[[0.9, 0.95]]
[2024-09-16 00:43:20,338] [INFO] [RANK 0]  iteration     3800/  100000 | elapsed time per iteration (ms): 4053.6 | learning rate 9.721E-04 | total loss 2.890337E-01 | loss 2.890337E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 00:43:20,339] [INFO] [RANK 0] time (ms) | forward: 2126.47 | backward: 1909.75 | allreduce: 0.00 | optimizer: 16.57 | data loader: 0.14
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 00:44:32,956] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 00:44:32,956] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 00:44:32,956] [INFO] [RANK 0]  validation loss at iteration 3800 | loss: 1.299189E-01 | PPL: 1.138736E+00 loss 1.299189E-01 |
[2024-09-16 00:44:32,956] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 3800 is less than current step: 3801. Dropping entry: {'Train/valid_ppl': 1.1387360316320048, 'Train/valid_loss': 0.1299189031124115, '_timestamp': 1726461872.957165}).
[2024-09-16 00:45:54,134] [INFO] [RANK 0]  iteration     3820/  100000 | elapsed time per iteration (ms): 7689.8 | learning rate 9.719E-04 | total loss 2.566461E-01 | loss 2.566462E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 00:45:54,135] [INFO] [RANK 0] time (ms) | forward: 2090.75 | backward: 1950.84 | allreduce: 0.00 | optimizer: 16.48 | data loader: 0.14
[2024-09-16 00:47:15,090] [INFO] [RANK 0]  iteration     3840/  100000 | elapsed time per iteration (ms): 4047.8 | learning rate 9.717E-04 | total loss 3.085414E-01 | loss 3.085413E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 00:47:15,090] [INFO] [RANK 0] time (ms) | forward: 2122.69 | backward: 1907.73 | allreduce: 0.00 | optimizer: 16.54 | data loader: 0.12
[2024-09-16 00:47:55,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=11, lr=[0.00097161], mom=[[0.9, 0.95]]
[2024-09-16 00:48:36,172] [INFO] [RANK 0]  iteration     3860/  100000 | elapsed time per iteration (ms): 4054.1 | learning rate 9.715E-04 | total loss 2.630186E-01 | loss 2.630186E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 00:48:36,173] [INFO] [RANK 0] time (ms) | forward: 2112.72 | backward: 1923.37 | allreduce: 0.00 | optimizer: 17.19 | data loader: 0.13
[2024-09-16 00:49:57,547] [INFO] [RANK 0]  iteration     3880/  100000 | elapsed time per iteration (ms): 4068.8 | learning rate 9.713E-04 | total loss 2.932810E-01 | loss 2.932810E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 00:49:57,548] [INFO] [RANK 0] time (ms) | forward: 2101.21 | backward: 1950.25 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.15
[2024-09-16 00:51:18,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=11, lr=[0.0009711100000000001], mom=[[0.9, 0.95]]
[2024-09-16 00:51:18,034] [INFO] [RANK 0]  iteration     3900/  100000 | elapsed time per iteration (ms): 4024.3 | learning rate 9.711E-04 | total loss 2.912396E-01 | loss 2.912396E-01 | loss scale 8388608.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 00:51:18,035] [INFO] [RANK 0] time (ms) | forward: 2128.01 | backward: 1878.81 | allreduce: 0.00 | optimizer: 16.67 | data loader: 0.12
[2024-09-16 00:52:39,190] [INFO] [RANK 0]  iteration     3920/  100000 | elapsed time per iteration (ms): 4057.8 | learning rate 9.709E-04 | total loss 2.397754E-01 | loss 2.397755E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 00:52:39,190] [INFO] [RANK 0] time (ms) | forward: 2094.46 | backward: 1945.88 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.14
[2024-09-16 00:54:00,299] [INFO] [RANK 0]  iteration     3940/  100000 | elapsed time per iteration (ms): 4055.5 | learning rate 9.707E-04 | total loss 2.332821E-01 | loss 2.332821E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 00:54:00,299] [INFO] [RANK 0] time (ms) | forward: 2108.95 | backward: 1929.10 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.13
[2024-09-16 00:54:40,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=11, lr=[0.00097061], mom=[[0.9, 0.95]]
[2024-09-16 00:55:21,108] [INFO] [RANK 0]  iteration     3960/  100000 | elapsed time per iteration (ms): 4040.5 | learning rate 9.705E-04 | total loss 2.196028E-01 | loss 2.196027E-01 | loss scale 8388608.0 |speed 14.85 samples/(min*GPU)
[2024-09-16 00:55:21,109] [INFO] [RANK 0] time (ms) | forward: 2138.42 | backward: 1884.09 | allreduce: 0.00 | optimizer: 17.12 | data loader: 0.13
[2024-09-16 00:56:42,323] [INFO] [RANK 0]  iteration     3980/  100000 | elapsed time per iteration (ms): 4060.7 | learning rate 9.703E-04 | total loss 2.818649E-01 | loss 2.818649E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 00:56:42,323] [INFO] [RANK 0] time (ms) | forward: 2115.63 | backward: 1927.52 | allreduce: 0.00 | optimizer: 16.74 | data loader: 0.12
[2024-09-16 00:58:03,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=11, lr=[0.00097011], mom=[[0.9, 0.95]]
[2024-09-16 00:58:03,311] [INFO] [RANK 0]  iteration     4000/  100000 | elapsed time per iteration (ms): 4049.4 | learning rate 9.701E-04 | total loss 2.713817E-01 | loss 2.713817E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 00:58:03,311] [INFO] [RANK 0] time (ms) | forward: 2099.10 | backward: 1933.12 | allreduce: 0.00 | optimizer: 16.36 | data loader: 0.12
[2024-09-16 00:58:03,312] [INFO] [RANK 0] Saving Model...
[2024-09-16 00:58:05,196] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/4000/mp_rank_00_model_states.pt
[2024-09-16 00:58:05,196] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/4000/mp_rank_00_model_states.pt...
[2024-09-16 00:58:25,654] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/4000/mp_rank_00_model_states.pt.
[2024-09-16 00:58:25,713] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 00:58:26,279] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/4000-ema/mp_rank_00_model_states.pt
[2024-09-16 00:58:26,279] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/4000-ema/mp_rank_00_model_states.pt...
[2024-09-16 00:58:48,257] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/4000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:56,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:55,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:52,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:48,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:40,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:39,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:26<00:32,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:31,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:30,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:32<00:27,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:25,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:24,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:39<00:20,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:18,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:45<00:14,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:51<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:57<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.18s/it]
[2024-09-16 01:00:00,295] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 01:00:00,295] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 01:00:00,295] [INFO] [RANK 0]  validation loss at iteration 4000 | loss: 2.170697E-01 | PPL: 1.242431E+00 loss 2.170697E-01 |
[2024-09-16 01:00:00,295] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 4000 is less than current step: 4001. Dropping entry: {'Train/valid_ppl': 1.2424307340144292, 'Train/valid_loss': 0.21706973016262054, '_timestamp': 1726462800.2958643}).
[2024-09-16 01:01:20,280] [INFO] [RANK 0]  iteration     4020/  100000 | elapsed time per iteration (ms): 9848.4 | learning rate 9.699E-04 | total loss 2.619017E-01 | loss 2.619017E-01 | loss scale 8388608.0 |speed 6.09 samples/(min*GPU)
[2024-09-16 01:01:20,280] [INFO] [RANK 0] time (ms) | forward: 2096.62 | backward: 1885.30 | allreduce: 0.00 | optimizer: 16.48 | data loader: 0.13
[2024-09-16 01:02:12,294] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 8388608, reducing to 4194304
[2024-09-16 01:02:40,987] [INFO] [RANK 0]  iteration     4040/  100000 | elapsed time per iteration (ms): 4035.4 | learning rate 9.697E-04 | total loss 2.254185E-01 | loss 2.254185E-01 | loss scale 4194304.0 |speed 14.87 samples/(min*GPU)
[2024-09-16 01:02:41,221] [INFO] [RANK 0] time (ms) | forward: 2114.17 | backward: 1904.02 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.14
[2024-09-16 01:03:21,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=12, lr=[0.00096962], mom=[[0.9, 0.95]]
[2024-09-16 01:04:02,282] [INFO] [RANK 0]  iteration     4060/  100000 | elapsed time per iteration (ms): 4064.8 | learning rate 9.695E-04 | total loss 2.862781E-01 | loss 2.862782E-01 | loss scale 4194304.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 01:04:02,283] [INFO] [RANK 0] time (ms) | forward: 2112.93 | backward: 1922.87 | allreduce: 0.00 | optimizer: 16.45 | data loader: 0.13
[2024-09-16 01:05:22,925] [INFO] [RANK 0]  iteration     4080/  100000 | elapsed time per iteration (ms): 4032.1 | learning rate 9.693E-04 | total loss 2.396653E-01 | loss 2.396653E-01 | loss scale 4194304.0 |speed 14.88 samples/(min*GPU)
[2024-09-16 01:05:22,926] [INFO] [RANK 0] time (ms) | forward: 2102.33 | backward: 1912.43 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.14
[2024-09-16 01:06:44,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=12, lr=[0.00096912], mom=[[0.9, 0.95]]
[2024-09-16 01:06:44,525] [INFO] [RANK 0]  iteration     4100/  100000 | elapsed time per iteration (ms): 4080.0 | learning rate 9.691E-04 | total loss 2.451212E-01 | loss 2.451212E-01 | loss scale 4194304.0 |speed 14.71 samples/(min*GPU)
[2024-09-16 01:06:44,526] [INFO] [RANK 0] time (ms) | forward: 2120.39 | backward: 1942.25 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.11
[2024-09-16 01:08:04,854] [INFO] [RANK 0]  iteration     4120/  100000 | elapsed time per iteration (ms): 4016.4 | learning rate 9.689E-04 | total loss 2.409674E-01 | loss 2.409673E-01 | loss scale 4194304.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 01:08:04,855] [INFO] [RANK 0] time (ms) | forward: 2091.61 | backward: 1907.49 | allreduce: 0.00 | optimizer: 16.52 | data loader: 0.13
[2024-09-16 01:09:25,038] [INFO] [RANK 0]  iteration     4140/  100000 | elapsed time per iteration (ms): 4009.2 | learning rate 9.687E-04 | total loss 2.463295E-01 | loss 2.463295E-01 | loss scale 4194304.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 01:09:25,039] [INFO] [RANK 0] time (ms) | forward: 2115.44 | backward: 1876.41 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.13
[2024-09-16 01:10:05,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=12, lr=[0.00096862], mom=[[0.9, 0.95]]
[2024-09-16 01:10:45,275] [INFO] [RANK 0]  iteration     4160/  100000 | elapsed time per iteration (ms): 4011.9 | learning rate 9.685E-04 | total loss 2.413709E-01 | loss 2.413709E-01 | loss scale 4194304.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 01:10:45,276] [INFO] [RANK 0] time (ms) | forward: 2120.94 | backward: 1872.44 | allreduce: 0.00 | optimizer: 17.62 | data loader: 0.14
[2024-09-16 01:12:05,405] [INFO] [RANK 0]  iteration     4180/  100000 | elapsed time per iteration (ms): 4006.5 | learning rate 9.683E-04 | total loss 2.739601E-01 | loss 2.739601E-01 | loss scale 4194304.0 |speed 14.98 samples/(min*GPU)
[2024-09-16 01:12:05,405] [INFO] [RANK 0] time (ms) | forward: 2119.00 | backward: 1869.91 | allreduce: 0.00 | optimizer: 16.75 | data loader: 0.14
[2024-09-16 01:13:25,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=12, lr=[0.00096812], mom=[[0.9, 0.95]]
[2024-09-16 01:13:25,365] [INFO] [RANK 0]  iteration     4200/  100000 | elapsed time per iteration (ms): 3998.0 | learning rate 9.681E-04 | total loss 2.685384E-01 | loss 2.685384E-01 | loss scale 4194304.0 |speed 15.01 samples/(min*GPU)
[2024-09-16 01:13:25,365] [INFO] [RANK 0] time (ms) | forward: 2116.07 | backward: 1864.46 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.16
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 01:14:38,011] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 01:14:38,011] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 01:14:38,012] [INFO] [RANK 0]  validation loss at iteration 4200 | loss: 1.475826E-01 | PPL: 1.159029E+00 loss 1.475826E-01 |
[2024-09-16 01:14:38,012] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 4200 is less than current step: 4201. Dropping entry: {'Train/valid_ppl': 1.159029023025558, 'Train/valid_loss': 0.14758260548114777, '_timestamp': 1726463678.012444}).
[2024-09-16 01:15:59,590] [INFO] [RANK 0]  iteration     4220/  100000 | elapsed time per iteration (ms): 7711.3 | learning rate 9.679E-04 | total loss 2.849597E-01 | loss 2.849597E-01 | loss scale 4194304.0 |speed 7.78 samples/(min*GPU)
[2024-09-16 01:15:59,591] [INFO] [RANK 0] time (ms) | forward: 2092.74 | backward: 1968.97 | allreduce: 0.00 | optimizer: 16.37 | data loader: 0.13
[2024-09-16 01:17:19,863] [INFO] [RANK 0]  iteration     4240/  100000 | elapsed time per iteration (ms): 4013.6 | learning rate 9.677E-04 | total loss 2.552932E-01 | loss 2.552932E-01 | loss scale 4194304.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 01:17:19,863] [INFO] [RANK 0] time (ms) | forward: 2114.85 | backward: 1881.40 | allreduce: 0.00 | optimizer: 16.57 | data loader: 0.13
[2024-09-16 01:18:00,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=12, lr=[0.0009676200000000001], mom=[[0.9, 0.95]]
[2024-09-16 01:18:40,799] [INFO] [RANK 0]  iteration     4260/  100000 | elapsed time per iteration (ms): 4046.8 | learning rate 9.675E-04 | total loss 2.585176E-01 | loss 2.585176E-01 | loss scale 4194304.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 01:18:40,800] [INFO] [RANK 0] time (ms) | forward: 2126.26 | backward: 1903.13 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.13
[2024-09-16 01:20:01,857] [INFO] [RANK 0]  iteration     4280/  100000 | elapsed time per iteration (ms): 4052.9 | learning rate 9.673E-04 | total loss 3.587884E-01 | loss 3.587884E-01 | loss scale 4194304.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 01:20:01,858] [INFO] [RANK 0] time (ms) | forward: 2094.67 | backward: 1940.81 | allreduce: 0.00 | optimizer: 16.64 | data loader: 0.14
[2024-09-16 01:21:21,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=12, lr=[0.00096712], mom=[[0.9, 0.95]]
[2024-09-16 01:21:21,858] [INFO] [RANK 0]  iteration     4300/  100000 | elapsed time per iteration (ms): 4000.0 | learning rate 9.671E-04 | total loss 3.069977E-01 | loss 3.069977E-01 | loss scale 4194304.0 |speed 15.00 samples/(min*GPU)
[2024-09-16 01:21:21,858] [INFO] [RANK 0] time (ms) | forward: 2103.71 | backward: 1878.68 | allreduce: 0.00 | optimizer: 16.80 | data loader: 0.13
[2024-09-16 01:22:42,102] [INFO] [RANK 0]  iteration     4320/  100000 | elapsed time per iteration (ms): 4012.2 | learning rate 9.669E-04 | total loss 3.330576E-01 | loss 3.330576E-01 | loss scale 4194304.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 01:22:42,103] [INFO] [RANK 0] time (ms) | forward: 2113.58 | backward: 1881.21 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.13
[2024-09-16 01:24:03,082] [INFO] [RANK 0]  iteration     4340/  100000 | elapsed time per iteration (ms): 4049.0 | learning rate 9.667E-04 | total loss 2.641405E-01 | loss 2.641405E-01 | loss scale 4194304.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 01:24:03,083] [INFO] [RANK 0] time (ms) | forward: 2120.53 | backward: 1910.92 | allreduce: 0.00 | optimizer: 16.73 | data loader: 0.17
[2024-09-16 01:24:43,101] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=12, lr=[0.0009666200000000001], mom=[[0.9, 0.95]]
[2024-09-16 01:25:23,114] [INFO] [RANK 0]  iteration     4360/  100000 | elapsed time per iteration (ms): 4001.6 | learning rate 9.665E-04 | total loss 2.409620E-01 | loss 2.409620E-01 | loss scale 4194304.0 |speed 14.99 samples/(min*GPU)
[2024-09-16 01:25:23,115] [INFO] [RANK 0] time (ms) | forward: 2097.40 | backward: 1886.71 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.15
[2024-09-16 01:26:43,692] [INFO] [RANK 0]  iteration     4380/  100000 | elapsed time per iteration (ms): 4028.9 | learning rate 9.663E-04 | total loss 2.549353E-01 | loss 2.549353E-01 | loss scale 4194304.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 01:26:43,699] [INFO] [RANK 0] time (ms) | forward: 2133.38 | backward: 1877.29 | allreduce: 0.00 | optimizer: 17.39 | data loader: 0.13
[2024-09-16 01:28:04,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=12, lr=[0.00096612], mom=[[0.9, 0.95]]
[2024-09-16 01:28:04,036] [INFO] [RANK 0]  iteration     4400/  100000 | elapsed time per iteration (ms): 4017.2 | learning rate 9.661E-04 | total loss 2.424184E-01 | loss 2.424184E-01 | loss scale 4194304.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 01:28:04,036] [INFO] [RANK 0] time (ms) | forward: 2074.03 | backward: 1924.95 | allreduce: 0.00 | optimizer: 17.05 | data loader: 0.14
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 01:29:16,399] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 01:29:16,400] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 01:29:16,400] [INFO] [RANK 0]  validation loss at iteration 4400 | loss: 2.271844E-01 | PPL: 1.255061E+00 loss 2.271844E-01 |
[2024-09-16 01:29:16,400] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 4400 is less than current step: 4401. Dropping entry: {'Train/valid_ppl': 1.2550612985581666, 'Train/valid_loss': 0.22718441486358643, '_timestamp': 1726464556.4005263}).
[2024-09-16 01:30:37,222] [INFO] [RANK 0]  iteration     4420/  100000 | elapsed time per iteration (ms): 7659.3 | learning rate 9.659E-04 | total loss 2.590330E-01 | loss 2.590330E-01 | loss scale 4194304.0 |speed 7.83 samples/(min*GPU)
[2024-09-16 01:30:37,223] [INFO] [RANK 0] time (ms) | forward: 2114.56 | backward: 1909.29 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.13
[2024-09-16 01:31:58,977] [INFO] [RANK 0]  iteration     4440/  100000 | elapsed time per iteration (ms): 4087.7 | learning rate 9.657E-04 | total loss 2.814158E-01 | loss 2.814159E-01 | loss scale 4194304.0 |speed 14.68 samples/(min*GPU)
[2024-09-16 01:31:58,978] [INFO] [RANK 0] time (ms) | forward: 2115.01 | backward: 1955.53 | allreduce: 0.00 | optimizer: 16.36 | data loader: 0.14
[2024-09-16 01:32:39,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=12, lr=[0.00096562], mom=[[0.9, 0.95]]
[2024-09-16 01:33:19,129] [INFO] [RANK 0]  iteration     4460/  100000 | elapsed time per iteration (ms): 4007.6 | learning rate 9.655E-04 | total loss 2.564575E-01 | loss 2.564576E-01 | loss scale 4194304.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 01:33:19,130] [INFO] [RANK 0] time (ms) | forward: 2094.41 | backward: 1895.56 | allreduce: 0.00 | optimizer: 16.79 | data loader: 0.12
[2024-09-16 01:34:39,953] [INFO] [RANK 0]  iteration     4480/  100000 | elapsed time per iteration (ms): 4041.2 | learning rate 9.653E-04 | total loss 2.799661E-01 | loss 2.799661E-01 | loss scale 4194304.0 |speed 14.85 samples/(min*GPU)
[2024-09-16 01:34:39,953] [INFO] [RANK 0] time (ms) | forward: 2125.34 | backward: 1898.38 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.15
[2024-09-16 01:36:00,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=12, lr=[0.00096512], mom=[[0.9, 0.95]]
[2024-09-16 01:36:00,684] [INFO] [RANK 0]  iteration     4500/  100000 | elapsed time per iteration (ms): 4036.6 | learning rate 9.651E-04 | total loss 3.104894E-01 | loss 3.104894E-01 | loss scale 4194304.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 01:36:00,685] [INFO] [RANK 0] time (ms) | forward: 2104.18 | backward: 1914.97 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.15
[2024-09-16 01:36:00,685] [INFO] [RANK 0] Saving Model...
[2024-09-16 01:36:02,571] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/4500/mp_rank_00_model_states.pt
[2024-09-16 01:36:02,571] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/4500/mp_rank_00_model_states.pt...
[2024-09-16 01:36:20,750] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/4500/mp_rank_00_model_states.pt.
[2024-09-16 01:36:20,817] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 01:36:21,392] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/4500-ema/mp_rank_00_model_states.pt
[2024-09-16 01:36:21,392] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/4500-ema/mp_rank_00_model_states.pt...
[2024-09-16 01:36:43,177] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/4500-ema/mp_rank_00_model_states.pt.
[2024-09-16 01:38:03,828] [INFO] [RANK 0]  iteration     4520/  100000 | elapsed time per iteration (ms): 6157.2 | learning rate 9.649E-04 | total loss 2.662394E-01 | loss 2.662394E-01 | loss scale 4194304.0 |speed 9.74 samples/(min*GPU)
[2024-09-16 01:38:03,829] [INFO] [RANK 0] time (ms) | forward: 2042.87 | backward: 1967.57 | allreduce: 0.00 | optimizer: 17.56 | data loader: 0.14
[2024-09-16 01:39:24,283] [INFO] [RANK 0]  iteration     4540/  100000 | elapsed time per iteration (ms): 4022.7 | learning rate 9.647E-04 | total loss 2.994575E-01 | loss 2.994575E-01 | loss scale 4194304.0 |speed 14.92 samples/(min*GPU)
[2024-09-16 01:39:24,284] [INFO] [RANK 0] time (ms) | forward: 2055.24 | backward: 1950.06 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.14
[2024-09-16 01:40:04,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=12, lr=[0.00096462], mom=[[0.9, 0.95]]
[2024-09-16 01:40:44,071] [INFO] [RANK 0]  iteration     4560/  100000 | elapsed time per iteration (ms): 3989.4 | learning rate 9.645E-04 | total loss 3.203237E-01 | loss 3.203237E-01 | loss scale 4194304.0 |speed 15.04 samples/(min*GPU)
[2024-09-16 01:40:44,071] [INFO] [RANK 0] time (ms) | forward: 2108.74 | backward: 1863.19 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.14
[2024-09-16 01:42:06,206] [INFO] [RANK 0]  iteration     4580/  100000 | elapsed time per iteration (ms): 4106.7 | learning rate 9.643E-04 | total loss 2.584507E-01 | loss 2.584507E-01 | loss scale 4194304.0 |speed 14.61 samples/(min*GPU)
[2024-09-16 01:42:06,207] [INFO] [RANK 0] time (ms) | forward: 2149.87 | backward: 1933.27 | allreduce: 0.00 | optimizer: 22.46 | data loader: 0.18
[2024-09-16 01:43:28,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=12, lr=[0.00096412], mom=[[0.9, 0.95]]
[2024-09-16 01:43:28,045] [INFO] [RANK 0]  iteration     4600/  100000 | elapsed time per iteration (ms): 4092.0 | learning rate 9.641E-04 | total loss 2.730540E-01 | loss 2.730539E-01 | loss scale 4194304.0 |speed 14.66 samples/(min*GPU)
[2024-09-16 01:43:28,046] [INFO] [RANK 0] time (ms) | forward: 2141.25 | backward: 1928.48 | allreduce: 0.00 | optimizer: 21.20 | data loader: 0.18
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 01:44:41,029] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 01:44:41,029] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 01:44:41,030] [INFO] [RANK 0]  validation loss at iteration 4600 | loss: 4.656771E-01 | PPL: 1.593093E+00 loss 4.656771E-01 |
[2024-09-16 01:44:41,030] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 4600 is less than current step: 4601. Dropping entry: {'Train/valid_ppl': 1.593092573855797, 'Train/valid_loss': 0.4656771421432495, '_timestamp': 1726465481.0303907}).
[2024-09-16 01:46:03,098] [INFO] [RANK 0]  iteration     4620/  100000 | elapsed time per iteration (ms): 7752.6 | learning rate 9.639E-04 | total loss 2.400029E-01 | loss 2.400029E-01 | loss scale 4194304.0 |speed 7.74 samples/(min*GPU)
[2024-09-16 01:46:03,098] [INFO] [RANK 0] time (ms) | forward: 2104.70 | backward: 1976.41 | allreduce: 0.00 | optimizer: 21.32 | data loader: 0.19
[2024-09-16 01:47:24,288] [INFO] [RANK 0]  iteration     4640/  100000 | elapsed time per iteration (ms): 4059.5 | learning rate 9.637E-04 | total loss 2.487872E-01 | loss 2.487872E-01 | loss scale 4194304.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 01:47:24,289] [INFO] [RANK 0] time (ms) | forward: 2153.15 | backward: 1885.24 | allreduce: 0.00 | optimizer: 20.18 | data loader: 0.17
[2024-09-16 01:48:04,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=12, lr=[0.0009636200000000001], mom=[[0.9, 0.95]]
[2024-09-16 01:48:44,792] [INFO] [RANK 0]  iteration     4660/  100000 | elapsed time per iteration (ms): 4025.2 | learning rate 9.635E-04 | total loss 3.116032E-01 | loss 3.116032E-01 | loss scale 4194304.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 01:48:44,792] [INFO] [RANK 0] time (ms) | forward: 2094.01 | backward: 1913.54 | allreduce: 0.00 | optimizer: 16.77 | data loader: 0.14
[2024-09-16 01:50:06,583] [INFO] [RANK 0]  iteration     4680/  100000 | elapsed time per iteration (ms): 4089.6 | learning rate 9.633E-04 | total loss 2.875507E-01 | loss 2.875507E-01 | loss scale 4194304.0 |speed 14.67 samples/(min*GPU)
[2024-09-16 01:50:06,584] [INFO] [RANK 0] time (ms) | forward: 2119.37 | backward: 1952.84 | allreduce: 0.00 | optimizer: 16.54 | data loader: 0.15
[2024-09-16 01:51:26,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=12, lr=[0.00096312], mom=[[0.9, 0.95]]
[2024-09-16 01:51:26,841] [INFO] [RANK 0]  iteration     4700/  100000 | elapsed time per iteration (ms): 4012.9 | learning rate 9.631E-04 | total loss 2.421236E-01 | loss 2.421236E-01 | loss scale 4194304.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 01:51:26,841] [INFO] [RANK 0] time (ms) | forward: 2099.26 | backward: 1895.87 | allreduce: 0.00 | optimizer: 16.89 | data loader: 0.12
[2024-09-16 01:52:48,171] [INFO] [RANK 0]  iteration     4720/  100000 | elapsed time per iteration (ms): 4066.5 | learning rate 9.629E-04 | total loss 2.686411E-01 | loss 2.686411E-01 | loss scale 4194304.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 01:52:48,172] [INFO] [RANK 0] time (ms) | forward: 2089.30 | backward: 1959.35 | allreduce: 0.00 | optimizer: 17.06 | data loader: 0.14
[2024-09-16 01:54:09,193] [INFO] [RANK 0]  iteration     4740/  100000 | elapsed time per iteration (ms): 4051.1 | learning rate 9.627E-04 | total loss 2.914868E-01 | loss 2.914868E-01 | loss scale 4194304.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 01:54:09,194] [INFO] [RANK 0] time (ms) | forward: 2124.10 | backward: 1909.66 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.14
[2024-09-16 01:54:49,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=12, lr=[0.0009626200000000001], mom=[[0.9, 0.95]]
[2024-09-16 01:55:29,407] [INFO] [RANK 0]  iteration     4760/  100000 | elapsed time per iteration (ms): 4010.7 | learning rate 9.625E-04 | total loss 2.646375E-01 | loss 2.646375E-01 | loss scale 4194304.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 01:55:29,408] [INFO] [RANK 0] time (ms) | forward: 2109.98 | backward: 1883.21 | allreduce: 0.00 | optimizer: 16.63 | data loader: 0.13
[2024-09-16 01:56:49,544] [INFO] [RANK 0]  iteration     4780/  100000 | elapsed time per iteration (ms): 4006.9 | learning rate 9.623E-04 | total loss 2.604162E-01 | loss 2.604162E-01 | loss scale 4194304.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 01:56:49,545] [INFO] [RANK 0] time (ms) | forward: 2125.20 | backward: 1864.37 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.14
[2024-09-16 01:58:09,884] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=12, lr=[0.00096212], mom=[[0.9, 0.95]]
[2024-09-16 01:58:09,884] [INFO] [RANK 0]  iteration     4800/  100000 | elapsed time per iteration (ms): 4017.0 | learning rate 9.621E-04 | total loss 2.718138E-01 | loss 2.718138E-01 | loss scale 4194304.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 01:58:09,885] [INFO] [RANK 0] time (ms) | forward: 2129.87 | backward: 1869.86 | allreduce: 0.00 | optimizer: 16.39 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 01:59:22,513] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 01:59:22,514] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 01:59:22,514] [INFO] [RANK 0]  validation loss at iteration 4800 | loss: 1.657073E-01 | PPL: 1.180228E+00 loss 1.657073E-01 |
[2024-09-16 01:59:22,514] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 4800 is less than current step: 4801. Dropping entry: {'Train/valid_ppl': 1.1802275693579014, 'Train/valid_loss': 0.1657072752714157, '_timestamp': 1726466362.5145996}).
[2024-09-16 02:00:44,465] [INFO] [RANK 0]  iteration     4820/  100000 | elapsed time per iteration (ms): 7729.0 | learning rate 9.619E-04 | total loss 2.885128E-01 | loss 2.885128E-01 | loss scale 4194304.0 |speed 7.76 samples/(min*GPU)
[2024-09-16 02:00:44,466] [INFO] [RANK 0] time (ms) | forward: 2126.65 | backward: 1953.49 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.15
[2024-09-16 02:02:05,596] [INFO] [RANK 0]  iteration     4840/  100000 | elapsed time per iteration (ms): 4056.5 | learning rate 9.617E-04 | total loss 2.477106E-01 | loss 2.477106E-01 | loss scale 4194304.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 02:02:05,596] [INFO] [RANK 0] time (ms) | forward: 2120.27 | backward: 1918.31 | allreduce: 0.00 | optimizer: 17.14 | data loader: 0.15
[2024-09-16 02:02:45,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=12, lr=[0.00096162], mom=[[0.9, 0.95]]
[2024-09-16 02:03:26,560] [INFO] [RANK 0]  iteration     4860/  100000 | elapsed time per iteration (ms): 4048.2 | learning rate 9.615E-04 | total loss 2.797031E-01 | loss 2.797032E-01 | loss scale 4194304.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 02:03:26,561] [INFO] [RANK 0] time (ms) | forward: 2136.32 | backward: 1894.54 | allreduce: 0.00 | optimizer: 16.54 | data loader: 0.14
[2024-09-16 02:04:46,811] [INFO] [RANK 0]  iteration     4880/  100000 | elapsed time per iteration (ms): 4012.5 | learning rate 9.613E-04 | total loss 2.636627E-01 | loss 2.636627E-01 | loss scale 4194304.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 02:04:46,812] [INFO] [RANK 0] time (ms) | forward: 2068.71 | backward: 1926.37 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.12
[2024-09-16 02:06:06,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=12, lr=[0.00096112], mom=[[0.9, 0.95]]
[2024-09-16 02:06:06,946] [INFO] [RANK 0]  iteration     4900/  100000 | elapsed time per iteration (ms): 4006.8 | learning rate 9.611E-04 | total loss 2.878774E-01 | loss 2.878774E-01 | loss scale 4194304.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 02:06:06,947] [INFO] [RANK 0] time (ms) | forward: 2107.23 | backward: 1882.10 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.13
[2024-09-16 02:07:28,270] [INFO] [RANK 0]  iteration     4920/  100000 | elapsed time per iteration (ms): 4066.2 | learning rate 9.609E-04 | total loss 2.910943E-01 | loss 2.910943E-01 | loss scale 4194304.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 02:07:28,270] [INFO] [RANK 0] time (ms) | forward: 2097.16 | backward: 1950.99 | allreduce: 0.00 | optimizer: 17.19 | data loader: 0.15
[2024-09-16 02:08:49,463] [INFO] [RANK 0]  iteration     4940/  100000 | elapsed time per iteration (ms): 4059.7 | learning rate 9.607E-04 | total loss 2.891105E-01 | loss 2.891105E-01 | loss scale 4194304.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 02:08:49,464] [INFO] [RANK 0] time (ms) | forward: 2119.78 | backward: 1922.62 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.14
[2024-09-16 02:09:30,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=12, lr=[0.00096062], mom=[[0.9, 0.95]]
[2024-09-16 02:10:10,680] [INFO] [RANK 0]  iteration     4960/  100000 | elapsed time per iteration (ms): 4060.8 | learning rate 9.605E-04 | total loss 2.687388E-01 | loss 2.687388E-01 | loss scale 4194304.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 02:10:10,680] [INFO] [RANK 0] time (ms) | forward: 2112.22 | backward: 1931.39 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.14
[2024-09-16 02:11:31,470] [INFO] [RANK 0]  iteration     4980/  100000 | elapsed time per iteration (ms): 4039.5 | learning rate 9.603E-04 | total loss 2.848407E-01 | loss 2.848407E-01 | loss scale 4194304.0 |speed 14.85 samples/(min*GPU)
[2024-09-16 02:11:31,471] [INFO] [RANK 0] time (ms) | forward: 2116.30 | backward: 1905.90 | allreduce: 0.00 | optimizer: 16.50 | data loader: 0.15
[2024-09-16 02:12:51,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=12, lr=[0.00096012], mom=[[0.9, 0.95]]
[2024-09-16 02:12:51,285] [INFO] [RANK 0]  iteration     5000/  100000 | elapsed time per iteration (ms): 3990.8 | learning rate 9.601E-04 | total loss 2.273699E-01 | loss 2.273699E-01 | loss scale 4194304.0 |speed 15.03 samples/(min*GPU)
[2024-09-16 02:12:51,286] [INFO] [RANK 0] time (ms) | forward: 2116.33 | backward: 1857.15 | allreduce: 0.00 | optimizer: 16.45 | data loader: 0.14
[2024-09-16 02:12:51,286] [INFO] [RANK 0] Saving Model...
[2024-09-16 02:12:53,256] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/5000/mp_rank_00_model_states.pt
[2024-09-16 02:12:53,256] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/5000/mp_rank_00_model_states.pt...
[2024-09-16 02:13:14,000] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/5000/mp_rank_00_model_states.pt.
[2024-09-16 02:13:14,088] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 02:13:14,727] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/5000-ema/mp_rank_00_model_states.pt
[2024-09-16 02:13:14,727] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/5000-ema/mp_rank_00_model_states.pt...
[2024-09-16 02:13:35,842] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/5000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:55,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:54,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:52,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:47,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:39,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:24,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
[2024-09-16 02:14:48,027] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 02:14:48,027] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 02:14:48,027] [INFO] [RANK 0]  validation loss at iteration 5000 | loss: 1.635710E-01 | PPL: 1.177709E+00 loss 1.635710E-01 |
[2024-09-16 02:14:48,027] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 5000 is less than current step: 5001. Dropping entry: {'Train/valid_ppl': 1.1777089345742613, 'Train/valid_loss': 0.16357097029685974, '_timestamp': 1726467288.0281405}).
[2024-09-16 02:16:07,928] [INFO] [RANK 0]  iteration     5020/  100000 | elapsed time per iteration (ms): 9832.1 | learning rate 9.599E-04 | total loss 2.033769E-01 | loss 2.033769E-01 | loss scale 4194304.0 |speed 6.10 samples/(min*GPU)
[2024-09-16 02:16:07,929] [INFO] [RANK 0] time (ms) | forward: 2126.40 | backward: 1851.40 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.17
[2024-09-16 02:17:29,765] [INFO] [RANK 0]  iteration     5040/  100000 | elapsed time per iteration (ms): 4091.8 | learning rate 9.597E-04 | total loss 2.489266E-01 | loss 2.489266E-01 | loss scale 8388608.0 |speed 14.66 samples/(min*GPU)
[2024-09-16 02:17:29,766] [INFO] [RANK 0] time (ms) | forward: 2126.93 | backward: 1947.61 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.12
[2024-09-16 02:18:09,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=12, lr=[0.00095962], mom=[[0.9, 0.95]]
[2024-09-16 02:18:50,509] [INFO] [RANK 0]  iteration     5060/  100000 | elapsed time per iteration (ms): 4037.2 | learning rate 9.595E-04 | total loss 2.777481E-01 | loss 2.777481E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 02:18:50,510] [INFO] [RANK 0] time (ms) | forward: 2127.37 | backward: 1892.35 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.13
[2024-09-16 02:20:11,439] [INFO] [RANK 0]  iteration     5080/  100000 | elapsed time per iteration (ms): 4046.5 | learning rate 9.593E-04 | total loss 3.363179E-01 | loss 3.363178E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 02:20:11,440] [INFO] [RANK 0] time (ms) | forward: 2088.55 | backward: 1940.58 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.11
[2024-09-16 02:21:32,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=12, lr=[0.00095912], mom=[[0.9, 0.95]]
[2024-09-16 02:21:32,642] [INFO] [RANK 0]  iteration     5100/  100000 | elapsed time per iteration (ms): 4060.2 | learning rate 9.591E-04 | total loss 2.517366E-01 | loss 2.517366E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 02:21:32,643] [INFO] [RANK 0] time (ms) | forward: 2139.29 | backward: 1903.47 | allreduce: 0.00 | optimizer: 16.57 | data loader: 0.13
[2024-09-16 02:22:54,008] [INFO] [RANK 0]  iteration     5120/  100000 | elapsed time per iteration (ms): 4068.3 | learning rate 9.589E-04 | total loss 2.511374E-01 | loss 2.511374E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 02:22:54,009] [INFO] [RANK 0] time (ms) | forward: 2109.23 | backward: 1941.78 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.13
[2024-09-16 02:24:14,067] [INFO] [RANK 0]  iteration     5140/  100000 | elapsed time per iteration (ms): 4003.0 | learning rate 9.587E-04 | total loss 2.771600E-01 | loss 2.771599E-01 | loss scale 8388608.0 |speed 14.99 samples/(min*GPU)
[2024-09-16 02:24:14,068] [INFO] [RANK 0] time (ms) | forward: 2121.18 | backward: 1864.41 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.14
[2024-09-16 02:24:54,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=12, lr=[0.0009586200000000001], mom=[[0.9, 0.95]]
[2024-09-16 02:25:34,981] [INFO] [RANK 0]  iteration     5160/  100000 | elapsed time per iteration (ms): 4045.7 | learning rate 9.585E-04 | total loss 2.468481E-01 | loss 2.468481E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 02:25:34,981] [INFO] [RANK 0] time (ms) | forward: 2136.88 | backward: 1891.45 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.14
[2024-09-16 02:26:55,251] [INFO] [RANK 0]  iteration     5180/  100000 | elapsed time per iteration (ms): 4013.5 | learning rate 9.583E-04 | total loss 2.975136E-01 | loss 2.975136E-01 | loss scale 8388608.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 02:26:55,252] [INFO] [RANK 0] time (ms) | forward: 2108.16 | backward: 1887.73 | allreduce: 0.00 | optimizer: 16.79 | data loader: 0.12
[2024-09-16 02:28:15,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=12, lr=[0.00095812], mom=[[0.9, 0.95]]
[2024-09-16 02:28:15,764] [INFO] [RANK 0]  iteration     5200/  100000 | elapsed time per iteration (ms): 4025.7 | learning rate 9.581E-04 | total loss 2.508669E-01 | loss 2.508669E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 02:28:15,765] [INFO] [RANK 0] time (ms) | forward: 2126.53 | backward: 1881.74 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 02:29:28,674] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 02:29:28,675] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 02:29:28,675] [INFO] [RANK 0]  validation loss at iteration 5200 | loss: 2.790632E-01 | PPL: 1.321891E+00 loss 2.790632E-01 |
[2024-09-16 02:29:28,675] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 5200 is less than current step: 5201. Dropping entry: {'Train/valid_ppl': 1.3218908387156534, 'Train/valid_loss': 0.2790631651878357, '_timestamp': 1726468168.6755733}).
[2024-09-16 02:30:49,404] [INFO] [RANK 0]  iteration     5220/  100000 | elapsed time per iteration (ms): 7682.0 | learning rate 9.579E-04 | total loss 2.642464E-01 | loss 2.642464E-01 | loss scale 8388608.0 |speed 7.81 samples/(min*GPU)
[2024-09-16 02:30:49,405] [INFO] [RANK 0] time (ms) | forward: 2101.94 | backward: 1917.13 | allreduce: 0.00 | optimizer: 16.52 | data loader: 0.14
[2024-09-16 02:32:10,600] [INFO] [RANK 0]  iteration     5240/  100000 | elapsed time per iteration (ms): 4059.8 | learning rate 9.577E-04 | total loss 3.328815E-01 | loss 3.328815E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 02:32:10,601] [INFO] [RANK 0] time (ms) | forward: 2137.23 | backward: 1905.16 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.14
[2024-09-16 02:32:51,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=12, lr=[0.0009576200000000001], mom=[[0.9, 0.95]]
[2024-09-16 02:33:31,828] [INFO] [RANK 0]  iteration     5260/  100000 | elapsed time per iteration (ms): 4061.4 | learning rate 9.575E-04 | total loss 2.942462E-01 | loss 2.942462E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 02:33:31,829] [INFO] [RANK 0] time (ms) | forward: 2107.11 | backward: 1936.60 | allreduce: 0.00 | optimizer: 16.85 | data loader: 0.12
[2024-09-16 02:34:52,848] [INFO] [RANK 0]  iteration     5280/  100000 | elapsed time per iteration (ms): 4051.0 | learning rate 9.573E-04 | total loss 2.517437E-01 | loss 2.517437E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 02:34:52,848] [INFO] [RANK 0] time (ms) | forward: 2140.19 | backward: 1893.25 | allreduce: 0.00 | optimizer: 16.68 | data loader: 0.13
[2024-09-16 02:36:13,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=12, lr=[0.00095712], mom=[[0.9, 0.95]]
[2024-09-16 02:36:13,038] [INFO] [RANK 0]  iteration     5300/  100000 | elapsed time per iteration (ms): 4009.5 | learning rate 9.571E-04 | total loss 3.484834E-01 | loss 3.484834E-01 | loss scale 8388608.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 02:36:13,038] [INFO] [RANK 0] time (ms) | forward: 2121.92 | backward: 1870.34 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.14
[2024-09-16 02:37:34,299] [INFO] [RANK 0]  iteration     5320/  100000 | elapsed time per iteration (ms): 4063.0 | learning rate 9.569E-04 | total loss 2.699290E-01 | loss 2.699290E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 02:37:34,300] [INFO] [RANK 0] time (ms) | forward: 2104.95 | backward: 1940.01 | allreduce: 0.00 | optimizer: 17.28 | data loader: 0.15
[2024-09-16 02:38:55,419] [INFO] [RANK 0]  iteration     5340/  100000 | elapsed time per iteration (ms): 4056.0 | learning rate 9.567E-04 | total loss 2.315400E-01 | loss 2.315400E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 02:38:55,419] [INFO] [RANK 0] time (ms) | forward: 2146.25 | backward: 1892.34 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.14
[2024-09-16 02:39:35,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=12, lr=[0.00095662], mom=[[0.9, 0.95]]
[2024-09-16 02:40:16,499] [INFO] [RANK 0]  iteration     5360/  100000 | elapsed time per iteration (ms): 4054.0 | learning rate 9.565E-04 | total loss 3.026230E-01 | loss 3.026230E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 02:40:16,499] [INFO] [RANK 0] time (ms) | forward: 2123.33 | backward: 1913.31 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.15
[2024-09-16 02:41:36,550] [INFO] [RANK 0]  iteration     5380/  100000 | elapsed time per iteration (ms): 4002.6 | learning rate 9.563E-04 | total loss 2.630423E-01 | loss 2.630423E-01 | loss scale 8388608.0 |speed 14.99 samples/(min*GPU)
[2024-09-16 02:41:36,551] [INFO] [RANK 0] time (ms) | forward: 2096.52 | backward: 1888.33 | allreduce: 0.00 | optimizer: 16.92 | data loader: 0.13
[2024-09-16 02:42:57,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=12, lr=[0.00095612], mom=[[0.9, 0.95]]
[2024-09-16 02:42:57,701] [INFO] [RANK 0]  iteration     5400/  100000 | elapsed time per iteration (ms): 4057.5 | learning rate 9.561E-04 | total loss 3.124733E-01 | loss 3.124733E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 02:42:57,702] [INFO] [RANK 0] time (ms) | forward: 2135.42 | backward: 1904.77 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 02:44:10,297] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 02:44:10,297] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 02:44:10,297] [INFO] [RANK 0]  validation loss at iteration 5400 | loss: 1.368480E-01 | PPL: 1.146654E+00 loss 1.368480E-01 |
[2024-09-16 02:44:10,297] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 5400 is less than current step: 5401. Dropping entry: {'Train/valid_ppl': 1.1466538298669202, 'Train/valid_loss': 0.13684798777103424, '_timestamp': 1726469050.2980704}).
[2024-09-16 02:45:31,250] [INFO] [RANK 0]  iteration     5420/  100000 | elapsed time per iteration (ms): 7677.4 | learning rate 9.559E-04 | total loss 2.797107E-01 | loss 2.797107E-01 | loss scale 8388608.0 |speed 7.82 samples/(min*GPU)
[2024-09-16 02:45:31,250] [INFO] [RANK 0] time (ms) | forward: 2104.94 | backward: 1925.43 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.14
[2024-09-16 02:46:52,951] [INFO] [RANK 0]  iteration     5440/  100000 | elapsed time per iteration (ms): 4085.0 | learning rate 9.557E-04 | total loss 3.125091E-01 | loss 3.125091E-01 | loss scale 8388608.0 |speed 14.69 samples/(min*GPU)
[2024-09-16 02:46:52,951] [INFO] [RANK 0] time (ms) | forward: 2156.99 | backward: 1910.19 | allreduce: 0.00 | optimizer: 17.03 | data loader: 0.12
[2024-09-16 02:47:33,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=12, lr=[0.00095562], mom=[[0.9, 0.95]]
[2024-09-16 02:48:13,807] [INFO] [RANK 0]  iteration     5460/  100000 | elapsed time per iteration (ms): 4042.8 | learning rate 9.555E-04 | total loss 2.634947E-01 | loss 2.634947E-01 | loss scale 8388608.0 |speed 14.84 samples/(min*GPU)
[2024-09-16 02:48:13,807] [INFO] [RANK 0] time (ms) | forward: 2098.50 | backward: 1926.39 | allreduce: 0.00 | optimizer: 17.08 | data loader: 0.15
[2024-09-16 02:49:34,895] [INFO] [RANK 0]  iteration     5480/  100000 | elapsed time per iteration (ms): 4054.4 | learning rate 9.553E-04 | total loss 2.610092E-01 | loss 2.610093E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 02:49:34,896] [INFO] [RANK 0] time (ms) | forward: 2123.25 | backward: 1913.26 | allreduce: 0.00 | optimizer: 17.07 | data loader: 0.14
[2024-09-16 02:50:55,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=12, lr=[0.00095512], mom=[[0.9, 0.95]]
[2024-09-16 02:50:55,989] [INFO] [RANK 0]  iteration     5500/  100000 | elapsed time per iteration (ms): 4054.7 | learning rate 9.551E-04 | total loss 2.907729E-01 | loss 2.907729E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 02:50:55,990] [INFO] [RANK 0] time (ms) | forward: 2139.63 | backward: 1897.72 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.13
[2024-09-16 02:50:55,990] [INFO] [RANK 0] Saving Model...
[2024-09-16 02:50:57,872] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/5500/mp_rank_00_model_states.pt
[2024-09-16 02:50:57,872] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/5500/mp_rank_00_model_states.pt...
[2024-09-16 02:51:25,213] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/5500/mp_rank_00_model_states.pt.
[2024-09-16 02:51:25,302] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 02:51:25,888] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/5500-ema/mp_rank_00_model_states.pt
[2024-09-16 02:51:25,889] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/5500-ema/mp_rank_00_model_states.pt...
[2024-09-16 02:51:47,445] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/5500-ema/mp_rank_00_model_states.pt.
[2024-09-16 02:53:07,195] [INFO] [RANK 0]  iteration     5520/  100000 | elapsed time per iteration (ms): 6560.3 | learning rate 9.549E-04 | total loss 2.656909E-01 | loss 2.656909E-01 | loss scale 8388608.0 |speed 9.15 samples/(min*GPU)
[2024-09-16 02:53:07,196] [INFO] [RANK 0] time (ms) | forward: 2085.12 | backward: 1881.62 | allreduce: 0.00 | optimizer: 16.40 | data loader: 0.12
[2024-09-16 02:54:27,038] [INFO] [RANK 0]  iteration     5540/  100000 | elapsed time per iteration (ms): 3992.2 | learning rate 9.547E-04 | total loss 2.813208E-01 | loss 2.813208E-01 | loss scale 8388608.0 |speed 15.03 samples/(min*GPU)
[2024-09-16 02:54:27,039] [INFO] [RANK 0] time (ms) | forward: 2123.84 | backward: 1851.01 | allreduce: 0.00 | optimizer: 16.49 | data loader: 0.15
[2024-09-16 02:55:07,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=12, lr=[0.00095462], mom=[[0.9, 0.95]]
[2024-09-16 02:55:47,932] [INFO] [RANK 0]  iteration     5560/  100000 | elapsed time per iteration (ms): 4044.7 | learning rate 9.545E-04 | total loss 2.296647E-01 | loss 2.296647E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 02:55:47,933] [INFO] [RANK 0] time (ms) | forward: 2135.66 | backward: 1891.74 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.13
[2024-09-16 02:57:09,106] [INFO] [RANK 0]  iteration     5580/  100000 | elapsed time per iteration (ms): 4058.7 | learning rate 9.543E-04 | total loss 2.968761E-01 | loss 2.968761E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 02:57:09,106] [INFO] [RANK 0] time (ms) | forward: 2106.50 | backward: 1934.12 | allreduce: 0.00 | optimizer: 17.21 | data loader: 0.14
[2024-09-16 02:58:29,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=12, lr=[0.00095412], mom=[[0.9, 0.95]]
[2024-09-16 02:58:29,355] [INFO] [RANK 0]  iteration     5600/  100000 | elapsed time per iteration (ms): 4012.5 | learning rate 9.541E-04 | total loss 2.113923E-01 | loss 2.113923E-01 | loss scale 8388608.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 02:58:29,356] [INFO] [RANK 0] time (ms) | forward: 2106.69 | backward: 1888.51 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.12
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 02:59:42,228] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 02:59:42,228] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 02:59:42,228] [INFO] [RANK 0]  validation loss at iteration 5600 | loss: 1.604933E-01 | PPL: 1.174090E+00 loss 1.604933E-01 |
[2024-09-16 02:59:42,228] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 5600 is less than current step: 5601. Dropping entry: {'Train/valid_ppl': 1.174089923461696, 'Train/valid_loss': 0.16049331426620483, '_timestamp': 1726469982.2291698}).
[2024-09-16 03:01:02,892] [INFO] [RANK 0]  iteration     5620/  100000 | elapsed time per iteration (ms): 7676.8 | learning rate 9.539E-04 | total loss 2.377764E-01 | loss 2.377764E-01 | loss scale 8388608.0 |speed 7.82 samples/(min*GPU)
[2024-09-16 03:01:02,892] [INFO] [RANK 0] time (ms) | forward: 2097.40 | backward: 1918.46 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.13
[2024-09-16 03:02:23,843] [INFO] [RANK 0]  iteration     5640/  100000 | elapsed time per iteration (ms): 4047.6 | learning rate 9.537E-04 | total loss 2.463108E-01 | loss 2.463108E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 03:02:23,844] [INFO] [RANK 0] time (ms) | forward: 2120.62 | backward: 1909.66 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.15
[2024-09-16 03:03:04,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=12, lr=[0.0009536200000000001], mom=[[0.9, 0.95]]
[2024-09-16 03:03:45,346] [INFO] [RANK 0]  iteration     5660/  100000 | elapsed time per iteration (ms): 4075.1 | learning rate 9.535E-04 | total loss 2.799449E-01 | loss 2.799450E-01 | loss scale 8388608.0 |speed 14.72 samples/(min*GPU)
[2024-09-16 03:03:45,347] [INFO] [RANK 0] time (ms) | forward: 2123.31 | backward: 1934.52 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.13
[2024-09-16 03:05:06,713] [INFO] [RANK 0]  iteration     5680/  100000 | elapsed time per iteration (ms): 4068.4 | learning rate 9.533E-04 | total loss 2.762894E-01 | loss 2.762895E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 03:05:06,714] [INFO] [RANK 0] time (ms) | forward: 2144.71 | backward: 1906.37 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.14
[2024-09-16 03:06:26,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=12, lr=[0.00095312], mom=[[0.9, 0.95]]
[2024-09-16 03:06:26,860] [INFO] [RANK 0]  iteration     5700/  100000 | elapsed time per iteration (ms): 4007.4 | learning rate 9.531E-04 | total loss 2.599531E-01 | loss 2.599531E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 03:06:26,861] [INFO] [RANK 0] time (ms) | forward: 2119.22 | backward: 1870.85 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.14
[2024-09-16 03:07:48,040] [INFO] [RANK 0]  iteration     5720/  100000 | elapsed time per iteration (ms): 4059.0 | learning rate 9.529E-04 | total loss 2.751801E-01 | loss 2.751801E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 03:07:48,041] [INFO] [RANK 0] time (ms) | forward: 2105.88 | backward: 1935.69 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.12
[2024-09-16 03:09:09,221] [INFO] [RANK 0]  iteration     5740/  100000 | elapsed time per iteration (ms): 4059.1 | learning rate 9.527E-04 | total loss 2.988897E-01 | loss 2.988897E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 03:09:09,222] [INFO] [RANK 0] time (ms) | forward: 2124.50 | backward: 1917.32 | allreduce: 0.00 | optimizer: 16.41 | data loader: 0.12
[2024-09-16 03:09:50,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=12, lr=[0.00095262], mom=[[0.9, 0.95]]
[2024-09-16 03:10:30,513] [INFO] [RANK 0]  iteration     5760/  100000 | elapsed time per iteration (ms): 4064.6 | learning rate 9.525E-04 | total loss 2.903554E-01 | loss 2.903555E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 03:10:30,513] [INFO] [RANK 0] time (ms) | forward: 2111.98 | backward: 1935.32 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.13
[2024-09-16 03:11:50,534] [INFO] [RANK 0]  iteration     5780/  100000 | elapsed time per iteration (ms): 4001.1 | learning rate 9.523E-04 | total loss 2.547877E-01 | loss 2.547876E-01 | loss scale 8388608.0 |speed 15.00 samples/(min*GPU)
[2024-09-16 03:11:50,535] [INFO] [RANK 0] time (ms) | forward: 2111.62 | backward: 1871.90 | allreduce: 0.00 | optimizer: 16.74 | data loader: 0.15
[2024-09-16 03:13:12,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=12, lr=[0.00095212], mom=[[0.9, 0.95]]
[2024-09-16 03:13:12,450] [INFO] [RANK 0]  iteration     5800/  100000 | elapsed time per iteration (ms): 4095.8 | learning rate 9.521E-04 | total loss 2.414217E-01 | loss 2.414217E-01 | loss scale 8388608.0 |speed 14.65 samples/(min*GPU)
[2024-09-16 03:13:12,450] [INFO] [RANK 0] time (ms) | forward: 2147.19 | backward: 1931.39 | allreduce: 0.00 | optimizer: 16.38 | data loader: 0.14
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 03:14:24,996] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 03:14:24,997] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 03:14:24,997] [INFO] [RANK 0]  validation loss at iteration 5800 | loss: 1.701209E-01 | PPL: 1.185448E+00 loss 1.701209E-01 |
[2024-09-16 03:14:24,997] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 5800 is less than current step: 5801. Dropping entry: {'Train/valid_ppl': 1.1854481219755904, 'Train/valid_loss': 0.17012086510658264, '_timestamp': 1726470864.997657}).
[2024-09-16 03:15:46,059] [INFO] [RANK 0]  iteration     5820/  100000 | elapsed time per iteration (ms): 7680.5 | learning rate 9.519E-04 | total loss 2.859256E-01 | loss 2.859256E-01 | loss scale 8388608.0 |speed 7.81 samples/(min*GPU)
[2024-09-16 03:15:46,060] [INFO] [RANK 0] time (ms) | forward: 2120.81 | backward: 1914.97 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.16
[2024-09-16 03:17:06,917] [INFO] [RANK 0]  iteration     5840/  100000 | elapsed time per iteration (ms): 4042.9 | learning rate 9.517E-04 | total loss 2.640864E-01 | loss 2.640863E-01 | loss scale 8388608.0 |speed 14.84 samples/(min*GPU)
[2024-09-16 03:17:06,917] [INFO] [RANK 0] time (ms) | forward: 2142.61 | backward: 1882.38 | allreduce: 0.00 | optimizer: 17.03 | data loader: 0.11
[2024-09-16 03:17:47,149] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=12, lr=[0.00095162], mom=[[0.9, 0.95]]
[2024-09-16 03:18:27,414] [INFO] [RANK 0]  iteration     5860/  100000 | elapsed time per iteration (ms): 4024.9 | learning rate 9.515E-04 | total loss 2.799894E-01 | loss 2.799894E-01 | loss scale 8388608.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 03:18:27,415] [INFO] [RANK 0] time (ms) | forward: 2065.57 | backward: 1942.02 | allreduce: 0.00 | optimizer: 16.49 | data loader: 0.15
[2024-09-16 03:19:48,586] [INFO] [RANK 0]  iteration     5880/  100000 | elapsed time per iteration (ms): 4058.6 | learning rate 9.513E-04 | total loss 2.392050E-01 | loss 2.392050E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 03:19:48,586] [INFO] [RANK 0] time (ms) | forward: 2127.71 | backward: 1912.59 | allreduce: 0.00 | optimizer: 17.44 | data loader: 0.12
[2024-09-16 03:21:09,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=12, lr=[0.00095112], mom=[[0.9, 0.95]]
[2024-09-16 03:21:09,989] [INFO] [RANK 0]  iteration     5900/  100000 | elapsed time per iteration (ms): 4070.2 | learning rate 9.511E-04 | total loss 2.942400E-01 | loss 2.942401E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 03:21:09,990] [INFO] [RANK 0] time (ms) | forward: 2132.32 | backward: 1920.52 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.16
[2024-09-16 03:22:30,721] [INFO] [RANK 0]  iteration     5920/  100000 | elapsed time per iteration (ms): 4036.6 | learning rate 9.509E-04 | total loss 2.829221E-01 | loss 2.829221E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 03:22:30,721] [INFO] [RANK 0] time (ms) | forward: 2095.71 | backward: 1923.50 | allreduce: 0.00 | optimizer: 16.54 | data loader: 0.15
[2024-09-16 03:23:50,796] [INFO] [RANK 0]  iteration     5940/  100000 | elapsed time per iteration (ms): 4003.8 | learning rate 9.507E-04 | total loss 2.661437E-01 | loss 2.661436E-01 | loss scale 8388608.0 |speed 14.99 samples/(min*GPU)
[2024-09-16 03:23:50,797] [INFO] [RANK 0] time (ms) | forward: 2114.72 | backward: 1871.57 | allreduce: 0.00 | optimizer: 16.66 | data loader: 0.15
[2024-09-16 03:24:31,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=12, lr=[0.00095062], mom=[[0.9, 0.95]]
[2024-09-16 03:25:11,891] [INFO] [RANK 0]  iteration     5960/  100000 | elapsed time per iteration (ms): 4054.8 | learning rate 9.505E-04 | total loss 2.921137E-01 | loss 2.921137E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 03:25:11,892] [INFO] [RANK 0] time (ms) | forward: 2109.81 | backward: 1927.53 | allreduce: 0.00 | optimizer: 16.59 | data loader: 0.14
[2024-09-16 03:26:32,991] [INFO] [RANK 0]  iteration     5980/  100000 | elapsed time per iteration (ms): 4055.0 | learning rate 9.503E-04 | total loss 2.592683E-01 | loss 2.592683E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 03:26:32,992] [INFO] [RANK 0] time (ms) | forward: 2087.34 | backward: 1950.14 | allreduce: 0.00 | optimizer: 16.69 | data loader: 0.13
[2024-09-16 03:27:53,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=12, lr=[0.0009501199999999999], mom=[[0.9, 0.95]]
[2024-09-16 03:27:53,562] [INFO] [RANK 0]  iteration     6000/  100000 | elapsed time per iteration (ms): 4028.6 | learning rate 9.501E-04 | total loss 2.939749E-01 | loss 2.939748E-01 | loss scale 8388608.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 03:27:53,563] [INFO] [RANK 0] time (ms) | forward: 2139.96 | backward: 1871.07 | allreduce: 0.00 | optimizer: 16.71 | data loader: 0.12
[2024-09-16 03:27:53,563] [INFO] [RANK 0] Saving Model...
[2024-09-16 03:27:55,430] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/6000/mp_rank_00_model_states.pt
[2024-09-16 03:27:55,431] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/6000/mp_rank_00_model_states.pt...
[2024-09-16 03:28:16,185] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/6000/mp_rank_00_model_states.pt.
[2024-09-16 03:28:16,245] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 03:28:16,860] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/6000-ema/mp_rank_00_model_states.pt
[2024-09-16 03:28:16,860] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/6000-ema/mp_rank_00_model_states.pt...
[2024-09-16 03:28:39,250] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/6000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:56,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:55,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:54,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:52,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:48,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:40,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:30,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
[2024-09-16 03:29:51,395] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 03:29:51,395] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 03:29:51,395] [INFO] [RANK 0]  validation loss at iteration 6000 | loss: 1.767395E-01 | PPL: 1.193320E+00 loss 1.767395E-01 |
[2024-09-16 03:29:51,395] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 6000 is less than current step: 6001. Dropping entry: {'Train/valid_ppl': 1.1933202092801036, 'Train/valid_loss': 0.17673951387405396, '_timestamp': 1726471791.3962803}).
[2024-09-16 03:31:12,303] [INFO] [RANK 0]  iteration     6020/  100000 | elapsed time per iteration (ms): 9937.0 | learning rate 9.499E-04 | total loss 3.197181E-01 | loss 3.197181E-01 | loss scale 8388608.0 |speed 6.04 samples/(min*GPU)
[2024-09-16 03:31:12,304] [INFO] [RANK 0] time (ms) | forward: 2104.29 | backward: 1923.83 | allreduce: 0.00 | optimizer: 16.41 | data loader: 0.11
[2024-09-16 03:32:32,577] [INFO] [RANK 0]  iteration     6040/  100000 | elapsed time per iteration (ms): 4013.7 | learning rate 9.497E-04 | total loss 2.579522E-01 | loss 2.579522E-01 | loss scale 16777216.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 03:32:32,578] [INFO] [RANK 0] time (ms) | forward: 2129.28 | backward: 1867.25 | allreduce: 0.00 | optimizer: 16.37 | data loader: 0.13
[2024-09-16 03:33:12,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=6050, skipped=12, lr=[0.0009496200000000001], mom=[[0.9, 0.95]]
[2024-09-16 03:33:53,910] [INFO] [RANK 0]  iteration     6060/  100000 | elapsed time per iteration (ms): 4066.7 | learning rate 9.495E-04 | total loss 2.832119E-01 | loss 2.832119E-01 | loss scale 16777216.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 03:33:53,911] [INFO] [RANK 0] time (ms) | forward: 2121.71 | backward: 1927.36 | allreduce: 0.00 | optimizer: 16.75 | data loader: 0.13
[2024-09-16 03:35:14,503] [INFO] [RANK 0]  iteration     6080/  100000 | elapsed time per iteration (ms): 4029.6 | learning rate 9.493E-04 | total loss 2.713272E-01 | loss 2.713271E-01 | loss scale 16777216.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 03:35:14,503] [INFO] [RANK 0] time (ms) | forward: 2096.39 | backward: 1915.77 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.12
[2024-09-16 03:36:22,602] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
[2024-09-16 03:36:34,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=6100, skipped=13, lr=[0.0009491300000000001], mom=[[0.9, 0.95]]
[2024-09-16 03:36:34,786] [INFO] [RANK 0]  iteration     6100/  100000 | elapsed time per iteration (ms): 4014.2 | learning rate 9.491E-04 | total loss 2.317089E-01 | loss 2.317089E-01 | loss scale 8388608.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 03:36:34,786] [INFO] [RANK 0] time (ms) | forward: 2120.41 | backward: 1876.73 | allreduce: 0.00 | optimizer: 16.19 | data loader: 0.14
[2024-09-16 03:37:55,757] [INFO] [RANK 0]  iteration     6120/  100000 | elapsed time per iteration (ms): 4048.6 | learning rate 9.489E-04 | total loss 2.948494E-01 | loss 2.948494E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 03:37:55,758] [INFO] [RANK 0] time (ms) | forward: 2124.18 | backward: 1906.97 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.11
[2024-09-16 03:39:16,955] [INFO] [RANK 0]  iteration     6140/  100000 | elapsed time per iteration (ms): 4059.9 | learning rate 9.487E-04 | total loss 2.233870E-01 | loss 2.233870E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 03:39:16,955] [INFO] [RANK 0] time (ms) | forward: 2103.87 | backward: 1938.19 | allreduce: 0.00 | optimizer: 16.97 | data loader: 0.14
[2024-09-16 03:39:57,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=6150, skipped=13, lr=[0.00094863], mom=[[0.9, 0.95]]
[2024-09-16 03:40:38,241] [INFO] [RANK 0]  iteration     6160/  100000 | elapsed time per iteration (ms): 4064.3 | learning rate 9.485E-04 | total loss 2.596805E-01 | loss 2.596805E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 03:40:38,242] [INFO] [RANK 0] time (ms) | forward: 2136.47 | backward: 1910.33 | allreduce: 0.00 | optimizer: 16.71 | data loader: 0.12
[2024-09-16 03:41:59,312] [INFO] [RANK 0]  iteration     6180/  100000 | elapsed time per iteration (ms): 4053.6 | learning rate 9.483E-04 | total loss 2.345022E-01 | loss 2.345022E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 03:41:59,313] [INFO] [RANK 0] time (ms) | forward: 2104.76 | backward: 1931.17 | allreduce: 0.00 | optimizer: 16.78 | data loader: 0.14
[2024-09-16 03:43:20,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=6200, skipped=13, lr=[0.00094813], mom=[[0.9, 0.95]]
[2024-09-16 03:43:20,655] [INFO] [RANK 0]  iteration     6200/  100000 | elapsed time per iteration (ms): 4067.1 | learning rate 9.481E-04 | total loss 2.754350E-01 | loss 2.754350E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 03:43:20,655] [INFO] [RANK 0] time (ms) | forward: 2147.36 | backward: 1902.27 | allreduce: 0.00 | optimizer: 16.66 | data loader: 0.14
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:50,  1.26s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:48,  1.24s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:46,  1.23s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:45,  1.22s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:41,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [01:00<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [01:00<00:01,  1.20s/it]
[2024-09-16 03:44:33,672] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 03:44:33,673] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 03:44:33,673] [INFO] [RANK 0]  validation loss at iteration 6200 | loss: 2.435983E-01 | PPL: 1.275832E+00 loss 2.435983E-01 |
[2024-09-16 03:44:33,673] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 6200 is less than current step: 6201. Dropping entry: {'Train/valid_ppl': 1.27583170340064, 'Train/valid_loss': 0.24359828233718872, '_timestamp': 1726472673.6736763}).
[2024-09-16 03:45:54,590] [INFO] [RANK 0]  iteration     6220/  100000 | elapsed time per iteration (ms): 7696.8 | learning rate 9.479E-04 | total loss 3.363611E-01 | loss 3.363611E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 03:45:54,591] [INFO] [RANK 0] time (ms) | forward: 2122.87 | backward: 1905.66 | allreduce: 0.00 | optimizer: 16.54 | data loader: 0.15
[2024-09-16 03:47:15,875] [INFO] [RANK 0]  iteration     6240/  100000 | elapsed time per iteration (ms): 4064.2 | learning rate 9.477E-04 | total loss 2.091882E-01 | loss 2.091882E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 03:47:15,875] [INFO] [RANK 0] time (ms) | forward: 2103.16 | backward: 1943.00 | allreduce: 0.00 | optimizer: 17.21 | data loader: 0.13
[2024-09-16 03:47:56,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=6250, skipped=13, lr=[0.00094763], mom=[[0.9, 0.95]]
[2024-09-16 03:48:37,222] [INFO] [RANK 0]  iteration     6260/  100000 | elapsed time per iteration (ms): 4067.4 | learning rate 9.475E-04 | total loss 2.745691E-01 | loss 2.745690E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 03:48:37,223] [INFO] [RANK 0] time (ms) | forward: 2130.90 | backward: 1919.14 | allreduce: 0.00 | optimizer: 16.52 | data loader: 0.13
[2024-09-16 03:49:58,376] [INFO] [RANK 0]  iteration     6280/  100000 | elapsed time per iteration (ms): 4057.7 | learning rate 9.473E-04 | total loss 2.553853E-01 | loss 2.553853E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 03:49:58,376] [INFO] [RANK 0] time (ms) | forward: 2138.94 | backward: 1901.30 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.13
[2024-09-16 03:51:18,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=6300, skipped=13, lr=[0.00094713], mom=[[0.9, 0.95]]
[2024-09-16 03:51:18,656] [INFO] [RANK 0]  iteration     6300/  100000 | elapsed time per iteration (ms): 4014.0 | learning rate 9.471E-04 | total loss 2.192620E-01 | loss 2.192620E-01 | loss scale 8388608.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 03:51:18,656] [INFO] [RANK 0] time (ms) | forward: 2072.22 | backward: 1924.51 | allreduce: 0.00 | optimizer: 16.45 | data loader: 0.14
[2024-09-16 03:52:38,621] [INFO] [RANK 0]  iteration     6320/  100000 | elapsed time per iteration (ms): 3998.3 | learning rate 9.469E-04 | total loss 2.338551E-01 | loss 2.338551E-01 | loss scale 8388608.0 |speed 15.01 samples/(min*GPU)
[2024-09-16 03:52:38,622] [INFO] [RANK 0] time (ms) | forward: 2119.10 | backward: 1861.39 | allreduce: 0.00 | optimizer: 16.94 | data loader: 0.14
[2024-09-16 03:53:59,176] [INFO] [RANK 0]  iteration     6340/  100000 | elapsed time per iteration (ms): 4027.7 | learning rate 9.467E-04 | total loss 2.970885E-01 | loss 2.970885E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 03:53:59,177] [INFO] [RANK 0] time (ms) | forward: 2138.36 | backward: 1872.11 | allreduce: 0.00 | optimizer: 16.46 | data loader: 0.15
[2024-09-16 03:54:40,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=6350, skipped=13, lr=[0.00094663], mom=[[0.9, 0.95]]
[2024-09-16 03:55:21,049] [INFO] [RANK 0]  iteration     6360/  100000 | elapsed time per iteration (ms): 4093.6 | learning rate 9.465E-04 | total loss 3.004988E-01 | loss 3.004988E-01 | loss scale 8388608.0 |speed 14.66 samples/(min*GPU)
[2024-09-16 03:55:21,049] [INFO] [RANK 0] time (ms) | forward: 2113.40 | backward: 1962.35 | allreduce: 0.00 | optimizer: 17.07 | data loader: 0.14
[2024-09-16 03:56:41,607] [INFO] [RANK 0]  iteration     6380/  100000 | elapsed time per iteration (ms): 4027.9 | learning rate 9.463E-04 | total loss 3.144248E-01 | loss 3.144248E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 03:56:41,608] [INFO] [RANK 0] time (ms) | forward: 2138.34 | backward: 1871.80 | allreduce: 0.00 | optimizer: 16.97 | data loader: 0.18
[2024-09-16 03:58:03,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=6400, skipped=13, lr=[0.00094613], mom=[[0.9, 0.95]]
[2024-09-16 03:58:03,071] [INFO] [RANK 0]  iteration     6400/  100000 | elapsed time per iteration (ms): 4073.2 | learning rate 9.461E-04 | total loss 2.560092E-01 | loss 2.560093E-01 | loss scale 8388608.0 |speed 14.73 samples/(min*GPU)
[2024-09-16 03:58:03,071] [INFO] [RANK 0] time (ms) | forward: 2103.77 | backward: 1951.39 | allreduce: 0.00 | optimizer: 17.15 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 03:59:16,875] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 03:59:16,875] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 03:59:16,875] [INFO] [RANK 0]  validation loss at iteration 6400 | loss: 1.424472E-01 | PPL: 1.153092E+00 loss 1.424472E-01 |
[2024-09-16 03:59:16,875] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 6400 is less than current step: 6401. Dropping entry: {'Train/valid_ppl': 1.1530922515472293, 'Train/valid_loss': 0.14244724810123444, '_timestamp': 1726473556.8761072}).
[2024-09-16 04:00:39,295] [INFO] [RANK 0]  iteration     6420/  100000 | elapsed time per iteration (ms): 7811.2 | learning rate 9.459E-04 | total loss 2.647210E-01 | loss 2.647210E-01 | loss scale 8388608.0 |speed 7.68 samples/(min*GPU)
[2024-09-16 04:00:39,296] [INFO] [RANK 0] time (ms) | forward: 2150.14 | backward: 1948.86 | allreduce: 0.00 | optimizer: 20.93 | data loader: 0.18
[2024-09-16 04:02:00,464] [INFO] [RANK 0]  iteration     6440/  100000 | elapsed time per iteration (ms): 4058.4 | learning rate 9.457E-04 | total loss 2.698056E-01 | loss 2.698056E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 04:02:00,464] [INFO] [RANK 0] time (ms) | forward: 2098.57 | backward: 1939.97 | allreduce: 0.00 | optimizer: 18.89 | data loader: 0.15
[2024-09-16 04:02:40,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=6450, skipped=13, lr=[0.00094563], mom=[[0.9, 0.95]]
[2024-09-16 04:03:21,650] [INFO] [RANK 0]  iteration     6460/  100000 | elapsed time per iteration (ms): 4059.3 | learning rate 9.455E-04 | total loss 2.482448E-01 | loss 2.482448E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 04:03:21,651] [INFO] [RANK 0] time (ms) | forward: 2106.44 | backward: 1933.82 | allreduce: 0.00 | optimizer: 18.13 | data loader: 0.16
[2024-09-16 04:04:42,715] [INFO] [RANK 0]  iteration     6480/  100000 | elapsed time per iteration (ms): 4053.2 | learning rate 9.453E-04 | total loss 2.732192E-01 | loss 2.732192E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 04:04:42,716] [INFO] [RANK 0] time (ms) | forward: 2136.75 | backward: 1899.05 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.14
[2024-09-16 04:06:03,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=6500, skipped=13, lr=[0.0009451300000000001], mom=[[0.9, 0.95]]
[2024-09-16 04:06:03,809] [INFO] [RANK 0]  iteration     6500/  100000 | elapsed time per iteration (ms): 4054.7 | learning rate 9.451E-04 | total loss 2.945731E-01 | loss 2.945731E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 04:06:03,816] [INFO] [RANK 0] time (ms) | forward: 2095.47 | backward: 1941.78 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.13
[2024-09-16 04:06:03,816] [INFO] [RANK 0] Saving Model...
[2024-09-16 04:06:05,749] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/6500/mp_rank_00_model_states.pt
[2024-09-16 04:06:05,749] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/6500/mp_rank_00_model_states.pt...
[2024-09-16 04:06:29,454] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/6500/mp_rank_00_model_states.pt.
[2024-09-16 04:06:29,533] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 04:06:30,188] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/6500-ema/mp_rank_00_model_states.pt
[2024-09-16 04:06:30,188] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/6500-ema/mp_rank_00_model_states.pt...
[2024-09-16 04:06:54,002] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/6500-ema/mp_rank_00_model_states.pt.
[2024-09-16 04:08:13,528] [INFO] [RANK 0]  iteration     6520/  100000 | elapsed time per iteration (ms): 6486.0 | learning rate 9.449E-04 | total loss 2.871455E-01 | loss 2.871455E-01 | loss scale 8388608.0 |speed 9.25 samples/(min*GPU)
[2024-09-16 04:08:13,529] [INFO] [RANK 0] time (ms) | forward: 2062.64 | backward: 1891.72 | allreduce: 0.00 | optimizer: 16.81 | data loader: 0.14
[2024-09-16 04:09:33,608] [INFO] [RANK 0]  iteration     6540/  100000 | elapsed time per iteration (ms): 4004.0 | learning rate 9.447E-04 | total loss 2.362111E-01 | loss 2.362111E-01 | loss scale 8388608.0 |speed 14.98 samples/(min*GPU)
[2024-09-16 04:09:33,609] [INFO] [RANK 0] time (ms) | forward: 2085.98 | backward: 1900.57 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.13
[2024-09-16 04:10:13,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=6550, skipped=13, lr=[0.00094463], mom=[[0.9, 0.95]]
[2024-09-16 04:10:53,752] [INFO] [RANK 0]  iteration     6560/  100000 | elapsed time per iteration (ms): 4007.2 | learning rate 9.445E-04 | total loss 2.485311E-01 | loss 2.485311E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 04:10:53,753] [INFO] [RANK 0] time (ms) | forward: 2122.11 | backward: 1867.81 | allreduce: 0.00 | optimizer: 16.45 | data loader: 0.13
[2024-09-16 04:12:14,865] [INFO] [RANK 0]  iteration     6580/  100000 | elapsed time per iteration (ms): 4055.7 | learning rate 9.443E-04 | total loss 2.895010E-01 | loss 2.895010E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 04:12:14,866] [INFO] [RANK 0] time (ms) | forward: 2130.17 | backward: 1907.98 | allreduce: 0.00 | optimizer: 16.67 | data loader: 0.15
[2024-09-16 04:13:35,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=6600, skipped=13, lr=[0.0009441300000000001], mom=[[0.9, 0.95]]
[2024-09-16 04:13:35,243] [INFO] [RANK 0]  iteration     6600/  100000 | elapsed time per iteration (ms): 4018.9 | learning rate 9.441E-04 | total loss 3.235498E-01 | loss 3.235497E-01 | loss scale 8388608.0 |speed 14.93 samples/(min*GPU)
[2024-09-16 04:13:35,244] [INFO] [RANK 0] time (ms) | forward: 2123.31 | backward: 1878.34 | allreduce: 0.00 | optimizer: 16.42 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 04:14:48,407] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 04:14:48,407] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 04:14:48,407] [INFO] [RANK 0]  validation loss at iteration 6600 | loss: 4.184964E-01 | PPL: 1.519675E+00 loss 4.184964E-01 |
[2024-09-16 04:14:48,407] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 6600 is less than current step: 6601. Dropping entry: {'Train/valid_ppl': 1.5196748086861434, 'Train/valid_loss': 0.41849637031555176, '_timestamp': 1726474488.4084816}).
[2024-09-16 04:16:10,628] [INFO] [RANK 0]  iteration     6620/  100000 | elapsed time per iteration (ms): 7769.2 | learning rate 9.439E-04 | total loss 2.622118E-01 | loss 2.622117E-01 | loss scale 8388608.0 |speed 7.72 samples/(min*GPU)
[2024-09-16 04:16:10,629] [INFO] [RANK 0] time (ms) | forward: 2138.27 | backward: 1954.99 | allreduce: 0.00 | optimizer: 16.92 | data loader: 0.13
[2024-09-16 04:17:31,031] [INFO] [RANK 0]  iteration     6640/  100000 | elapsed time per iteration (ms): 4020.2 | learning rate 9.437E-04 | total loss 2.972223E-01 | loss 2.972223E-01 | loss scale 8388608.0 |speed 14.92 samples/(min*GPU)
[2024-09-16 04:17:31,032] [INFO] [RANK 0] time (ms) | forward: 2115.37 | backward: 1887.56 | allreduce: 0.00 | optimizer: 16.40 | data loader: 0.14
[2024-09-16 04:18:11,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=6650, skipped=13, lr=[0.00094363], mom=[[0.9, 0.95]]
[2024-09-16 04:18:52,678] [INFO] [RANK 0]  iteration     6660/  100000 | elapsed time per iteration (ms): 4082.4 | learning rate 9.435E-04 | total loss 2.212787E-01 | loss 2.212787E-01 | loss scale 8388608.0 |speed 14.70 samples/(min*GPU)
[2024-09-16 04:18:52,679] [INFO] [RANK 0] time (ms) | forward: 2134.97 | backward: 1930.13 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.13
[2024-09-16 04:20:13,292] [INFO] [RANK 0]  iteration     6680/  100000 | elapsed time per iteration (ms): 4030.7 | learning rate 9.433E-04 | total loss 2.510544E-01 | loss 2.510544E-01 | loss scale 8388608.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 04:20:13,293] [INFO] [RANK 0] time (ms) | forward: 2109.07 | backward: 1904.37 | allreduce: 0.00 | optimizer: 16.44 | data loader: 0.14
[2024-09-16 04:21:34,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=6700, skipped=13, lr=[0.00094313], mom=[[0.9, 0.95]]
[2024-09-16 04:21:34,251] [INFO] [RANK 0]  iteration     6700/  100000 | elapsed time per iteration (ms): 4048.0 | learning rate 9.431E-04 | total loss 2.837027E-01 | loss 2.837027E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 04:21:34,251] [INFO] [RANK 0] time (ms) | forward: 2129.81 | backward: 1900.95 | allreduce: 0.00 | optimizer: 16.34 | data loader: 0.08
[2024-09-16 04:22:55,553] [INFO] [RANK 0]  iteration     6720/  100000 | elapsed time per iteration (ms): 4065.1 | learning rate 9.429E-04 | total loss 2.935906E-01 | loss 2.935906E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 04:22:55,554] [INFO] [RANK 0] time (ms) | forward: 2112.23 | backward: 1934.77 | allreduce: 0.00 | optimizer: 17.28 | data loader: 0.13
[2024-09-16 04:24:16,814] [INFO] [RANK 0]  iteration     6740/  100000 | elapsed time per iteration (ms): 4063.0 | learning rate 9.427E-04 | total loss 2.640134E-01 | loss 2.640134E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 04:24:16,815] [INFO] [RANK 0] time (ms) | forward: 2113.12 | backward: 1932.69 | allreduce: 0.00 | optimizer: 16.39 | data loader: 0.12
[2024-09-16 04:24:57,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=6750, skipped=13, lr=[0.00094263], mom=[[0.9, 0.95]]
[2024-09-16 04:25:37,958] [INFO] [RANK 0]  iteration     6760/  100000 | elapsed time per iteration (ms): 4057.2 | learning rate 9.425E-04 | total loss 2.516858E-01 | loss 2.516859E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 04:25:37,958] [INFO] [RANK 0] time (ms) | forward: 2105.82 | backward: 1934.01 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.13
[2024-09-16 04:26:58,503] [INFO] [RANK 0]  iteration     6780/  100000 | elapsed time per iteration (ms): 4027.3 | learning rate 9.423E-04 | total loss 2.810756E-01 | loss 2.810756E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 04:26:58,503] [INFO] [RANK 0] time (ms) | forward: 2129.73 | backward: 1879.98 | allreduce: 0.00 | optimizer: 16.70 | data loader: 0.12
[2024-09-16 04:28:19,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=6800, skipped=13, lr=[0.00094213], mom=[[0.9, 0.95]]
[2024-09-16 04:28:19,526] [INFO] [RANK 0]  iteration     6800/  100000 | elapsed time per iteration (ms): 4051.2 | learning rate 9.421E-04 | total loss 2.404752E-01 | loss 2.404752E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 04:28:19,527] [INFO] [RANK 0] time (ms) | forward: 2111.65 | backward: 1921.66 | allreduce: 0.00 | optimizer: 17.07 | data loader: 0.14
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:25,  1.27s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:23,  1.25s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:22,  1.23s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:41<00:20,  1.22s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.22s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:47<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:53<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:59<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [01:00<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [01:00<00:01,  1.20s/it]
[2024-09-16 04:29:32,671] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 04:29:32,671] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 04:29:32,671] [INFO] [RANK 0]  validation loss at iteration 6800 | loss: 1.289771E-01 | PPL: 1.137664E+00 loss 1.289771E-01 |
[2024-09-16 04:29:32,671] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 6800 is less than current step: 6801. Dropping entry: {'Train/valid_ppl': 1.137664060120432, 'Train/valid_loss': 0.12897709012031555, '_timestamp': 1726475372.6718657}).
[2024-09-16 04:30:53,690] [INFO] [RANK 0]  iteration     6820/  100000 | elapsed time per iteration (ms): 7708.2 | learning rate 9.419E-04 | total loss 2.530267E-01 | loss 2.530266E-01 | loss scale 8388608.0 |speed 7.78 samples/(min*GPU)
[2024-09-16 04:30:53,690] [INFO] [RANK 0] time (ms) | forward: 2135.62 | backward: 1897.79 | allreduce: 0.00 | optimizer: 16.68 | data loader: 0.12
[2024-09-16 04:32:13,787] [INFO] [RANK 0]  iteration     6840/  100000 | elapsed time per iteration (ms): 4004.9 | learning rate 9.417E-04 | total loss 2.732423E-01 | loss 2.732423E-01 | loss scale 8388608.0 |speed 14.98 samples/(min*GPU)
[2024-09-16 04:32:13,788] [INFO] [RANK 0] time (ms) | forward: 2116.98 | backward: 1870.29 | allreduce: 0.00 | optimizer: 16.77 | data loader: 0.12
[2024-09-16 04:32:53,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=6850, skipped=13, lr=[0.0009416299999999999], mom=[[0.9, 0.95]]
[2024-09-16 04:33:34,891] [INFO] [RANK 0]  iteration     6860/  100000 | elapsed time per iteration (ms): 4055.2 | learning rate 9.415E-04 | total loss 3.022274E-01 | loss 3.022273E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 04:33:34,891] [INFO] [RANK 0] time (ms) | forward: 2127.05 | backward: 1910.41 | allreduce: 0.00 | optimizer: 16.90 | data loader: 0.12
[2024-09-16 04:34:56,243] [INFO] [RANK 0]  iteration     6880/  100000 | elapsed time per iteration (ms): 4067.6 | learning rate 9.413E-04 | total loss 2.593286E-01 | loss 2.593286E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 04:34:56,244] [INFO] [RANK 0] time (ms) | forward: 2114.10 | backward: 1936.12 | allreduce: 0.00 | optimizer: 16.55 | data loader: 0.12
[2024-09-16 04:36:17,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=6900, skipped=13, lr=[0.0009411300000000001], mom=[[0.9, 0.95]]
[2024-09-16 04:36:17,300] [INFO] [RANK 0]  iteration     6900/  100000 | elapsed time per iteration (ms): 4052.9 | learning rate 9.411E-04 | total loss 2.871545E-01 | loss 2.871544E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 04:36:17,301] [INFO] [RANK 0] time (ms) | forward: 2097.12 | backward: 1937.79 | allreduce: 0.00 | optimizer: 17.11 | data loader: 0.15
[2024-09-16 04:37:37,513] [INFO] [RANK 0]  iteration     6920/  100000 | elapsed time per iteration (ms): 4010.6 | learning rate 9.409E-04 | total loss 2.940059E-01 | loss 2.940060E-01 | loss scale 8388608.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 04:37:37,514] [INFO] [RANK 0] time (ms) | forward: 2106.32 | backward: 1886.63 | allreduce: 0.00 | optimizer: 16.86 | data loader: 0.12
[2024-09-16 04:38:58,763] [INFO] [RANK 0]  iteration     6940/  100000 | elapsed time per iteration (ms): 4062.5 | learning rate 9.407E-04 | total loss 2.635211E-01 | loss 2.635211E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 04:38:58,764] [INFO] [RANK 0] time (ms) | forward: 2121.11 | backward: 1923.90 | allreduce: 0.00 | optimizer: 16.69 | data loader: 0.11
[2024-09-16 04:39:38,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=6950, skipped=13, lr=[0.00094063], mom=[[0.9, 0.95]]
[2024-09-16 04:40:18,801] [INFO] [RANK 0]  iteration     6960/  100000 | elapsed time per iteration (ms): 4001.9 | learning rate 9.405E-04 | total loss 2.966708E-01 | loss 2.966708E-01 | loss scale 8388608.0 |speed 14.99 samples/(min*GPU)
[2024-09-16 04:40:18,802] [INFO] [RANK 0] time (ms) | forward: 2115.76 | backward: 1867.85 | allreduce: 0.00 | optimizer: 17.42 | data loader: 0.15
[2024-09-16 04:41:39,906] [INFO] [RANK 0]  iteration     6980/  100000 | elapsed time per iteration (ms): 4055.2 | learning rate 9.403E-04 | total loss 2.437705E-01 | loss 2.437705E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 04:41:39,907] [INFO] [RANK 0] time (ms) | forward: 2106.75 | backward: 1929.89 | allreduce: 0.00 | optimizer: 17.76 | data loader: 0.15
[2024-09-16 04:43:01,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=7000, skipped=13, lr=[0.0009401300000000001], mom=[[0.9, 0.95]]
[2024-09-16 04:43:01,331] [INFO] [RANK 0]  iteration     7000/  100000 | elapsed time per iteration (ms): 4071.3 | learning rate 9.401E-04 | total loss 2.843048E-01 | loss 2.843048E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 04:43:01,332] [INFO] [RANK 0] time (ms) | forward: 2123.23 | backward: 1930.60 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.13
[2024-09-16 04:43:01,332] [INFO] [RANK 0] Saving Model...
[2024-09-16 04:43:03,226] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/7000/mp_rank_00_model_states.pt
[2024-09-16 04:43:03,227] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/7000/mp_rank_00_model_states.pt...
[2024-09-16 04:43:22,771] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/7000/mp_rank_00_model_states.pt.
[2024-09-16 04:43:22,831] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 04:43:23,446] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/7000-ema/mp_rank_00_model_states.pt
[2024-09-16 04:43:23,447] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/7000-ema/mp_rank_00_model_states.pt...
[2024-09-16 04:43:45,530] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/7000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:55,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:54,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:06<00:52,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:47,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:39,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:26<00:33,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:31,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:30,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:32<00:27,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:24,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:45<00:14,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:51<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:57<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.18s/it]
[2024-09-16 04:45:01,898] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 04:45:01,898] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 04:45:01,898] [INFO] [RANK 0]  validation loss at iteration 7000 | loss: 3.367295E-01 | PPL: 1.400360E+00 loss 3.367295E-01 |
[2024-09-16 04:45:01,898] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 7000 is less than current step: 7001. Dropping entry: {'Train/valid_ppl': 1.4003602522006262, 'Train/valid_loss': 0.3367295265197754, '_timestamp': 1726476301.899014}).
[2024-09-16 04:46:22,729] [INFO] [RANK 0]  iteration     7020/  100000 | elapsed time per iteration (ms): 10069.9 | learning rate 9.399E-04 | total loss 2.768755E-01 | loss 2.768755E-01 | loss scale 8388608.0 |speed 5.96 samples/(min*GPU)
[2024-09-16 04:46:22,730] [INFO] [RANK 0] time (ms) | forward: 2100.58 | backward: 1918.80 | allreduce: 0.00 | optimizer: 21.30 | data loader: 0.20
[2024-09-16 04:47:44,751] [INFO] [RANK 0]  iteration     7040/  100000 | elapsed time per iteration (ms): 4101.1 | learning rate 9.397E-04 | total loss 2.880745E-01 | loss 2.880745E-01 | loss scale 8388608.0 |speed 14.63 samples/(min*GPU)
[2024-09-16 04:47:44,752] [INFO] [RANK 0] time (ms) | forward: 2140.87 | backward: 1940.13 | allreduce: 0.00 | optimizer: 19.18 | data loader: 0.18
[2024-09-16 04:48:25,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=7050, skipped=13, lr=[0.00093963], mom=[[0.9, 0.95]]
[2024-09-16 04:49:05,345] [INFO] [RANK 0]  iteration     7060/  100000 | elapsed time per iteration (ms): 4029.7 | learning rate 9.395E-04 | total loss 3.154813E-01 | loss 3.154813E-01 | loss scale 8388608.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 04:49:05,346] [INFO] [RANK 0] time (ms) | forward: 2103.95 | backward: 1906.07 | allreduce: 0.00 | optimizer: 18.68 | data loader: 0.16
[2024-09-16 04:50:26,743] [INFO] [RANK 0]  iteration     7080/  100000 | elapsed time per iteration (ms): 4069.9 | learning rate 9.393E-04 | total loss 2.982437E-01 | loss 2.982437E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 04:50:26,744] [INFO] [RANK 0] time (ms) | forward: 2121.57 | backward: 1925.86 | allreduce: 0.00 | optimizer: 21.28 | data loader: 0.19
[2024-09-16 04:51:47,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=7100, skipped=13, lr=[0.00093913], mom=[[0.9, 0.95]]
[2024-09-16 04:51:47,005] [INFO] [RANK 0]  iteration     7100/  100000 | elapsed time per iteration (ms): 4013.1 | learning rate 9.391E-04 | total loss 2.435599E-01 | loss 2.435599E-01 | loss scale 16777216.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 04:51:47,006] [INFO] [RANK 0] time (ms) | forward: 2108.10 | backward: 1884.63 | allreduce: 0.00 | optimizer: 19.40 | data loader: 0.16
[2024-09-16 04:53:09,205] [INFO] [RANK 0]  iteration     7120/  100000 | elapsed time per iteration (ms): 4110.0 | learning rate 9.389E-04 | total loss 2.423441E-01 | loss 2.423441E-01 | loss scale 16777216.0 |speed 14.60 samples/(min*GPU)
[2024-09-16 04:53:09,206] [INFO] [RANK 0] time (ms) | forward: 2147.07 | backward: 1941.27 | allreduce: 0.00 | optimizer: 20.70 | data loader: 0.15
[2024-09-16 04:54:29,518] [INFO] [RANK 0]  iteration     7140/  100000 | elapsed time per iteration (ms): 4015.6 | learning rate 9.387E-04 | total loss 2.592517E-01 | loss 2.592517E-01 | loss scale 16777216.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 04:54:29,519] [INFO] [RANK 0] time (ms) | forward: 2118.71 | backward: 1875.17 | allreduce: 0.00 | optimizer: 20.67 | data loader: 0.21
[2024-09-16 04:55:09,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=7150, skipped=13, lr=[0.00093863], mom=[[0.9, 0.95]]
[2024-09-16 04:55:50,880] [INFO] [RANK 0]  iteration     7160/  100000 | elapsed time per iteration (ms): 4068.1 | learning rate 9.385E-04 | total loss 3.170745E-01 | loss 3.170745E-01 | loss scale 16777216.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 04:55:50,882] [INFO] [RANK 0] time (ms) | forward: 2140.34 | backward: 1904.58 | allreduce: 0.00 | optimizer: 22.02 | data loader: 0.17
[2024-09-16 04:57:12,341] [INFO] [RANK 0]  iteration     7180/  100000 | elapsed time per iteration (ms): 4073.0 | learning rate 9.383E-04 | total loss 2.994008E-01 | loss 2.994007E-01 | loss scale 16777216.0 |speed 14.73 samples/(min*GPU)
[2024-09-16 04:57:12,342] [INFO] [RANK 0] time (ms) | forward: 2126.45 | backward: 1928.36 | allreduce: 0.00 | optimizer: 17.22 | data loader: 0.18
[2024-09-16 04:58:33,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=7200, skipped=13, lr=[0.00093813], mom=[[0.9, 0.95]]
[2024-09-16 04:58:33,556] [INFO] [RANK 0]  iteration     7200/  100000 | elapsed time per iteration (ms): 4060.7 | learning rate 9.381E-04 | total loss 2.760305E-01 | loss 2.760305E-01 | loss scale 16777216.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 04:58:33,556] [INFO] [RANK 0] time (ms) | forward: 2116.79 | backward: 1923.49 | allreduce: 0.00 | optimizer: 19.45 | data loader: 0.17
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 05:00:19,307] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 05:00:19,308] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 05:00:19,308] [INFO] [RANK 0]  validation loss at iteration 7200 | loss: 1.672682E-01 | PPL: 1.182071E+00 loss 1.672682E-01 |
[2024-09-16 05:00:19,308] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 7200 is less than current step: 7201. Dropping entry: {'Train/valid_ppl': 1.182071309171262, 'Train/valid_loss': 0.16726824641227722, '_timestamp': 1726477219.3086543}).
[2024-09-16 05:01:39,104] [INFO] [RANK 0]  iteration     7220/  100000 | elapsed time per iteration (ms): 9277.4 | learning rate 9.379E-04 | total loss 2.434331E-01 | loss 2.434331E-01 | loss scale 16777216.0 |speed 6.47 samples/(min*GPU)
[2024-09-16 05:01:39,104] [INFO] [RANK 0] time (ms) | forward: 2108.82 | backward: 1861.58 | allreduce: 0.00 | optimizer: 18.49 | data loader: 0.18
[2024-09-16 05:02:59,426] [INFO] [RANK 0]  iteration     7240/  100000 | elapsed time per iteration (ms): 4016.1 | learning rate 9.377E-04 | total loss 3.125185E-01 | loss 3.125185E-01 | loss scale 16777216.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 05:02:59,427] [INFO] [RANK 0] time (ms) | forward: 2103.16 | backward: 1890.53 | allreduce: 0.00 | optimizer: 21.36 | data loader: 0.17
[2024-09-16 05:03:39,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=7250, skipped=13, lr=[0.00093763], mom=[[0.9, 0.95]]
[2024-09-16 05:04:20,637] [INFO] [RANK 0]  iteration     7260/  100000 | elapsed time per iteration (ms): 4060.6 | learning rate 9.375E-04 | total loss 2.976799E-01 | loss 2.976799E-01 | loss scale 16777216.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 05:04:20,638] [INFO] [RANK 0] time (ms) | forward: 2120.97 | backward: 1920.30 | allreduce: 0.00 | optimizer: 18.33 | data loader: 0.18
[2024-09-16 05:05:42,270] [INFO] [RANK 0]  iteration     7280/  100000 | elapsed time per iteration (ms): 4081.7 | learning rate 9.373E-04 | total loss 2.656152E-01 | loss 2.656152E-01 | loss scale 16777216.0 |speed 14.70 samples/(min*GPU)
[2024-09-16 05:05:42,272] [INFO] [RANK 0] time (ms) | forward: 2128.66 | backward: 1932.31 | allreduce: 0.00 | optimizer: 19.67 | data loader: 0.15
[2024-09-16 05:07:03,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=7300, skipped=13, lr=[0.00093713], mom=[[0.9, 0.95]]
[2024-09-16 05:07:03,831] [INFO] [RANK 0]  iteration     7300/  100000 | elapsed time per iteration (ms): 4078.0 | learning rate 9.371E-04 | total loss 2.638251E-01 | loss 2.638251E-01 | loss scale 16777216.0 |speed 14.71 samples/(min*GPU)
[2024-09-16 05:07:03,831] [INFO] [RANK 0] time (ms) | forward: 2132.27 | backward: 1926.75 | allreduce: 0.00 | optimizer: 17.99 | data loader: 0.16
[2024-09-16 05:08:24,762] [INFO] [RANK 0]  iteration     7320/  100000 | elapsed time per iteration (ms): 4046.6 | learning rate 9.369E-04 | total loss 3.137144E-01 | loss 3.137144E-01 | loss scale 16777216.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 05:08:24,763] [INFO] [RANK 0] time (ms) | forward: 2108.39 | backward: 1918.57 | allreduce: 0.00 | optimizer: 18.68 | data loader: 0.18
[2024-09-16 05:09:45,753] [INFO] [RANK 0]  iteration     7340/  100000 | elapsed time per iteration (ms): 4049.6 | learning rate 9.367E-04 | total loss 2.622587E-01 | loss 2.622587E-01 | loss scale 16777216.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 05:09:45,754] [INFO] [RANK 0] time (ms) | forward: 2121.56 | backward: 1907.43 | allreduce: 0.00 | optimizer: 19.48 | data loader: 0.18
[2024-09-16 05:10:26,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=7350, skipped=13, lr=[0.0009366299999999999], mom=[[0.9, 0.95]]
[2024-09-16 05:11:07,096] [INFO] [RANK 0]  iteration     7360/  100000 | elapsed time per iteration (ms): 4067.2 | learning rate 9.365E-04 | total loss 2.341131E-01 | loss 2.341131E-01 | loss scale 16777216.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 05:11:07,097] [INFO] [RANK 0] time (ms) | forward: 2113.63 | backward: 1933.80 | allreduce: 0.00 | optimizer: 18.79 | data loader: 0.15
[2024-09-16 05:12:28,755] [INFO] [RANK 0]  iteration     7380/  100000 | elapsed time per iteration (ms): 4082.9 | learning rate 9.363E-04 | total loss 3.290881E-01 | loss 3.290881E-01 | loss scale 16777216.0 |speed 14.70 samples/(min*GPU)
[2024-09-16 05:12:28,756] [INFO] [RANK 0] time (ms) | forward: 2120.15 | backward: 1940.49 | allreduce: 0.00 | optimizer: 21.30 | data loader: 0.16
[2024-09-16 05:13:49,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=7400, skipped=13, lr=[0.0009361300000000001], mom=[[0.9, 0.95]]
[2024-09-16 05:13:49,041] [INFO] [RANK 0]  iteration     7400/  100000 | elapsed time per iteration (ms): 4014.3 | learning rate 9.361E-04 | total loss 2.825956E-01 | loss 2.825956E-01 | loss scale 16777216.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 05:13:49,042] [INFO] [RANK 0] time (ms) | forward: 2090.95 | backward: 1904.79 | allreduce: 0.00 | optimizer: 17.65 | data loader: 0.15
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 05:15:01,841] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 05:15:01,841] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 05:15:01,841] [INFO] [RANK 0]  validation loss at iteration 7400 | loss: 3.913594E-01 | PPL: 1.478990E+00 loss 3.913594E-01 |
[2024-09-16 05:15:01,841] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 7400 is less than current step: 7401. Dropping entry: {'Train/valid_ppl': 1.4789899062991387, 'Train/valid_loss': 0.3913593590259552, '_timestamp': 1726478101.8422787}).
[2024-09-16 05:16:23,118] [INFO] [RANK 0]  iteration     7420/  100000 | elapsed time per iteration (ms): 7703.8 | learning rate 9.359E-04 | total loss 2.061186E-01 | loss 2.061186E-01 | loss scale 16777216.0 |speed 7.79 samples/(min*GPU)
[2024-09-16 05:16:23,119] [INFO] [RANK 0] time (ms) | forward: 2112.98 | backward: 1931.41 | allreduce: 0.00 | optimizer: 18.43 | data loader: 0.17
[2024-09-16 05:17:44,364] [INFO] [RANK 0]  iteration     7440/  100000 | elapsed time per iteration (ms): 4062.3 | learning rate 9.357E-04 | total loss 2.780423E-01 | loss 2.780423E-01 | loss scale 16777216.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 05:17:44,365] [INFO] [RANK 0] time (ms) | forward: 2123.15 | backward: 1917.97 | allreduce: 0.00 | optimizer: 20.16 | data loader: 0.16
[2024-09-16 05:18:24,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=7450, skipped=13, lr=[0.00093563], mom=[[0.9, 0.95]]
[2024-09-16 05:19:05,609] [INFO] [RANK 0]  iteration     7460/  100000 | elapsed time per iteration (ms): 4062.2 | learning rate 9.355E-04 | total loss 2.936832E-01 | loss 2.936832E-01 | loss scale 16777216.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 05:19:05,609] [INFO] [RANK 0] time (ms) | forward: 2125.71 | backward: 1917.36 | allreduce: 0.00 | optimizer: 18.22 | data loader: 0.15
[2024-09-16 05:20:26,828] [INFO] [RANK 0]  iteration     7480/  100000 | elapsed time per iteration (ms): 4061.0 | learning rate 9.353E-04 | total loss 2.251329E-01 | loss 2.251329E-01 | loss scale 16777216.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 05:20:26,829] [INFO] [RANK 0] time (ms) | forward: 2129.97 | backward: 1910.71 | allreduce: 0.00 | optimizer: 19.32 | data loader: 0.16
[2024-09-16 05:21:48,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=7500, skipped=13, lr=[0.00093513], mom=[[0.9, 0.95]]
[2024-09-16 05:21:48,301] [INFO] [RANK 0]  iteration     7500/  100000 | elapsed time per iteration (ms): 4073.7 | learning rate 9.351E-04 | total loss 3.237183E-01 | loss 3.237183E-01 | loss scale 16777216.0 |speed 14.73 samples/(min*GPU)
[2024-09-16 05:21:48,302] [INFO] [RANK 0] time (ms) | forward: 2122.74 | backward: 1928.81 | allreduce: 0.00 | optimizer: 21.10 | data loader: 0.18
[2024-09-16 05:21:48,302] [INFO] [RANK 0] Saving Model...
[2024-09-16 05:21:50,586] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/7500/mp_rank_00_model_states.pt
[2024-09-16 05:21:50,586] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/7500/mp_rank_00_model_states.pt...
[2024-09-16 05:22:14,254] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/7500/mp_rank_00_model_states.pt.
[2024-09-16 05:22:14,338] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 05:22:15,000] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/7500-ema/mp_rank_00_model_states.pt
[2024-09-16 05:22:15,001] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/7500-ema/mp_rank_00_model_states.pt...
[2024-09-16 05:22:37,781] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/7500-ema/mp_rank_00_model_states.pt.
[2024-09-16 05:23:57,671] [INFO] [RANK 0]  iteration     7520/  100000 | elapsed time per iteration (ms): 6468.5 | learning rate 9.349E-04 | total loss 2.592782E-01 | loss 2.592782E-01 | loss scale 16777216.0 |speed 9.28 samples/(min*GPU)
[2024-09-16 05:23:57,672] [INFO] [RANK 0] time (ms) | forward: 2069.88 | backward: 1899.78 | allreduce: 0.00 | optimizer: 20.00 | data loader: 0.16
[2024-09-16 05:25:17,963] [INFO] [RANK 0]  iteration     7540/  100000 | elapsed time per iteration (ms): 4014.6 | learning rate 9.347E-04 | total loss 2.776016E-01 | loss 2.776016E-01 | loss scale 16777216.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 05:25:17,965] [INFO] [RANK 0] time (ms) | forward: 2101.79 | backward: 1892.25 | allreduce: 0.00 | optimizer: 19.51 | data loader: 0.15
[2024-09-16 05:25:58,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=7550, skipped=13, lr=[0.00093463], mom=[[0.9, 0.95]]
[2024-09-16 05:26:39,031] [INFO] [RANK 0]  iteration     7560/  100000 | elapsed time per iteration (ms): 4053.4 | learning rate 9.345E-04 | total loss 2.698053E-01 | loss 2.698053E-01 | loss scale 16777216.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 05:26:39,032] [INFO] [RANK 0] time (ms) | forward: 2124.10 | backward: 1909.14 | allreduce: 0.00 | optimizer: 19.08 | data loader: 0.18
[2024-09-16 05:28:00,256] [INFO] [RANK 0]  iteration     7580/  100000 | elapsed time per iteration (ms): 4061.3 | learning rate 9.343E-04 | total loss 2.727613E-01 | loss 2.727613E-01 | loss scale 16777216.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 05:28:00,256] [INFO] [RANK 0] time (ms) | forward: 2110.21 | backward: 1928.90 | allreduce: 0.00 | optimizer: 21.09 | data loader: 0.18
[2024-09-16 05:29:21,572] [INFO] [logging.py:96:log_dist] [Rank 0] step=7600, skipped=13, lr=[0.00093413], mom=[[0.9, 0.95]]
[2024-09-16 05:29:21,572] [INFO] [RANK 0]  iteration     7600/  100000 | elapsed time per iteration (ms): 4065.8 | learning rate 9.341E-04 | total loss 2.794166E-01 | loss 2.794166E-01 | loss scale 16777216.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 05:29:21,573] [INFO] [RANK 0] time (ms) | forward: 2130.15 | backward: 1915.62 | allreduce: 0.00 | optimizer: 19.07 | data loader: 0.15
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 05:33:55,060] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 05:33:55,060] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 05:33:55,060] [INFO] [RANK 0]  validation loss at iteration 7600 | loss: 6.664264E-01 | PPL: 1.947266E+00 loss 6.664264E-01 |
[2024-09-16 05:33:55,060] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 7600 is less than current step: 7601. Dropping entry: {'Train/valid_ppl': 1.947266161061779, 'Train/valid_loss': 0.666426420211792, '_timestamp': 1726479235.0612025}).
[2024-09-16 05:35:14,480] [INFO] [RANK 0]  iteration     7620/  100000 | elapsed time per iteration (ms): 17645.4 | learning rate 9.339E-04 | total loss 2.330870E-01 | loss 2.330870E-01 | loss scale 16777216.0 |speed 3.40 samples/(min*GPU)
[2024-09-16 05:35:14,481] [INFO] [RANK 0] time (ms) | forward: 2013.74 | backward: 1934.76 | allreduce: 0.00 | optimizer: 21.33 | data loader: 0.20
[2024-09-16 05:36:34,484] [INFO] [RANK 0]  iteration     7640/  100000 | elapsed time per iteration (ms): 4000.2 | learning rate 9.337E-04 | total loss 2.395391E-01 | loss 2.395392E-01 | loss scale 16777216.0 |speed 15.00 samples/(min*GPU)
[2024-09-16 05:36:34,485] [INFO] [RANK 0] time (ms) | forward: 2047.23 | backward: 1934.16 | allreduce: 0.00 | optimizer: 17.98 | data loader: 0.17
[2024-09-16 05:36:58,502] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
[2024-09-16 05:37:14,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=7650, skipped=14, lr=[0.00093364], mom=[[0.9, 0.95]]
[2024-09-16 05:37:55,233] [INFO] [RANK 0]  iteration     7660/  100000 | elapsed time per iteration (ms): 4037.4 | learning rate 9.335E-04 | total loss 2.380672E-01 | loss 2.380672E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 05:37:55,233] [INFO] [RANK 0] time (ms) | forward: 2123.29 | backward: 1886.88 | allreduce: 0.00 | optimizer: 26.01 | data loader: 0.23
[2024-09-16 05:39:16,834] [INFO] [RANK 0]  iteration     7680/  100000 | elapsed time per iteration (ms): 4080.1 | learning rate 9.333E-04 | total loss 2.516988E-01 | loss 2.516988E-01 | loss scale 8388608.0 |speed 14.71 samples/(min*GPU)
[2024-09-16 05:39:16,835] [INFO] [RANK 0] time (ms) | forward: 2121.61 | backward: 1937.92 | allreduce: 0.00 | optimizer: 19.49 | data loader: 0.17
[2024-09-16 05:40:37,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=7700, skipped=14, lr=[0.00093314], mom=[[0.9, 0.95]]
[2024-09-16 05:40:37,886] [INFO] [RANK 0]  iteration     7700/  100000 | elapsed time per iteration (ms): 4052.6 | learning rate 9.331E-04 | total loss 2.519607E-01 | loss 2.519607E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 05:40:37,886] [INFO] [RANK 0] time (ms) | forward: 2118.43 | backward: 1914.62 | allreduce: 0.00 | optimizer: 18.63 | data loader: 0.13
[2024-09-16 05:41:59,409] [INFO] [RANK 0]  iteration     7720/  100000 | elapsed time per iteration (ms): 4076.2 | learning rate 9.329E-04 | total loss 2.827799E-01 | loss 2.827799E-01 | loss scale 8388608.0 |speed 14.72 samples/(min*GPU)
[2024-09-16 05:41:59,410] [INFO] [RANK 0] time (ms) | forward: 2121.64 | backward: 1932.69 | allreduce: 0.00 | optimizer: 20.90 | data loader: 0.16
[2024-09-16 05:43:20,248] [INFO] [RANK 0]  iteration     7740/  100000 | elapsed time per iteration (ms): 4041.9 | learning rate 9.327E-04 | total loss 2.766800E-01 | loss 2.766800E-01 | loss scale 8388608.0 |speed 14.84 samples/(min*GPU)
[2024-09-16 05:43:20,249] [INFO] [RANK 0] time (ms) | forward: 2112.78 | backward: 1909.95 | allreduce: 0.00 | optimizer: 18.22 | data loader: 0.17
[2024-09-16 05:44:01,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=7750, skipped=14, lr=[0.0009326400000000001], mom=[[0.9, 0.95]]
[2024-09-16 05:44:41,451] [INFO] [RANK 0]  iteration     7760/  100000 | elapsed time per iteration (ms): 4060.2 | learning rate 9.325E-04 | total loss 2.523166E-01 | loss 2.523166E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 05:44:41,452] [INFO] [RANK 0] time (ms) | forward: 2121.50 | backward: 1917.32 | allreduce: 0.00 | optimizer: 20.33 | data loader: 0.17
[2024-09-16 05:46:01,812] [INFO] [RANK 0]  iteration     7780/  100000 | elapsed time per iteration (ms): 4018.0 | learning rate 9.323E-04 | total loss 3.260962E-01 | loss 3.260962E-01 | loss scale 8388608.0 |speed 14.93 samples/(min*GPU)
[2024-09-16 05:46:01,813] [INFO] [RANK 0] time (ms) | forward: 2128.16 | backward: 1869.62 | allreduce: 0.00 | optimizer: 19.21 | data loader: 0.15
[2024-09-16 05:47:23,976] [INFO] [logging.py:96:log_dist] [Rank 0] step=7800, skipped=14, lr=[0.00093214], mom=[[0.9, 0.95]]
[2024-09-16 05:47:23,977] [INFO] [RANK 0]  iteration     7800/  100000 | elapsed time per iteration (ms): 4108.2 | learning rate 9.321E-04 | total loss 2.669121E-01 | loss 2.669121E-01 | loss scale 8388608.0 |speed 14.60 samples/(min*GPU)
[2024-09-16 05:47:23,978] [INFO] [RANK 0] time (ms) | forward: 2144.87 | backward: 1942.95 | allreduce: 0.00 | optimizer: 19.36 | data loader: 0.16
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 05:48:38,312] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 05:48:38,312] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 05:48:38,312] [INFO] [RANK 0]  validation loss at iteration 7800 | loss: 2.663129E-01 | PPL: 1.305143E+00 loss 2.663129E-01 |
[2024-09-16 05:48:38,312] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 7800 is less than current step: 7801. Dropping entry: {'Train/valid_ppl': 1.3051433705170008, 'Train/valid_loss': 0.2663128972053528, '_timestamp': 1726480118.312811}).
[2024-09-16 05:49:59,143] [INFO] [RANK 0]  iteration     7820/  100000 | elapsed time per iteration (ms): 7758.3 | learning rate 9.319E-04 | total loss 2.847416E-01 | loss 2.847417E-01 | loss scale 8388608.0 |speed 7.73 samples/(min*GPU)
[2024-09-16 05:49:59,144] [INFO] [RANK 0] time (ms) | forward: 2120.04 | backward: 1900.79 | allreduce: 0.00 | optimizer: 19.77 | data loader: 0.16
[2024-09-16 05:51:19,935] [INFO] [RANK 0]  iteration     7840/  100000 | elapsed time per iteration (ms): 4039.6 | learning rate 9.317E-04 | total loss 2.986019E-01 | loss 2.986018E-01 | loss scale 8388608.0 |speed 14.85 samples/(min*GPU)
[2024-09-16 05:51:19,936] [INFO] [RANK 0] time (ms) | forward: 2113.45 | backward: 1905.38 | allreduce: 0.00 | optimizer: 19.78 | data loader: 0.17
[2024-09-16 05:52:00,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=7850, skipped=14, lr=[0.0009316400000000001], mom=[[0.9, 0.95]]
[2024-09-16 05:52:41,018] [INFO] [RANK 0]  iteration     7860/  100000 | elapsed time per iteration (ms): 4054.1 | learning rate 9.315E-04 | total loss 3.346408E-01 | loss 3.346408E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 05:52:41,018] [INFO] [RANK 0] time (ms) | forward: 2102.77 | backward: 1930.50 | allreduce: 0.00 | optimizer: 19.88 | data loader: 0.17
[2024-09-16 05:54:01,193] [INFO] [RANK 0]  iteration     7880/  100000 | elapsed time per iteration (ms): 4008.8 | learning rate 9.313E-04 | total loss 2.556498E-01 | loss 2.556498E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 05:54:01,194] [INFO] [RANK 0] time (ms) | forward: 2119.59 | backward: 1867.46 | allreduce: 0.00 | optimizer: 20.67 | data loader: 0.16
[2024-09-16 05:55:22,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=7900, skipped=14, lr=[0.00093114], mom=[[0.9, 0.95]]
[2024-09-16 05:55:22,114] [INFO] [RANK 0]  iteration     7900/  100000 | elapsed time per iteration (ms): 4046.1 | learning rate 9.311E-04 | total loss 3.138250E-01 | loss 3.138250E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 05:55:22,115] [INFO] [RANK 0] time (ms) | forward: 2122.16 | backward: 1904.78 | allreduce: 0.00 | optimizer: 18.21 | data loader: 0.15
[2024-09-16 05:56:44,163] [INFO] [RANK 0]  iteration     7920/  100000 | elapsed time per iteration (ms): 4102.5 | learning rate 9.309E-04 | total loss 2.721257E-01 | loss 2.721257E-01 | loss scale 8388608.0 |speed 14.63 samples/(min*GPU)
[2024-09-16 05:56:44,164] [INFO] [RANK 0] time (ms) | forward: 2141.02 | backward: 1937.80 | allreduce: 0.00 | optimizer: 22.53 | data loader: 0.16
[2024-09-16 05:58:05,064] [INFO] [RANK 0]  iteration     7940/  100000 | elapsed time per iteration (ms): 4045.0 | learning rate 9.307E-04 | total loss 2.701005E-01 | loss 2.701005E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 05:58:05,064] [INFO] [RANK 0] time (ms) | forward: 2119.57 | backward: 1906.87 | allreduce: 0.00 | optimizer: 17.68 | data loader: 0.14
[2024-09-16 05:58:45,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=7950, skipped=14, lr=[0.00093064], mom=[[0.9, 0.95]]
[2024-09-16 05:59:26,495] [INFO] [RANK 0]  iteration     7960/  100000 | elapsed time per iteration (ms): 4071.6 | learning rate 9.305E-04 | total loss 2.651890E-01 | loss 2.651890E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 05:59:26,496] [INFO] [RANK 0] time (ms) | forward: 2113.96 | backward: 1935.80 | allreduce: 0.00 | optimizer: 20.69 | data loader: 0.17
[2024-09-16 06:00:46,943] [INFO] [RANK 0]  iteration     7980/  100000 | elapsed time per iteration (ms): 4022.4 | learning rate 9.303E-04 | total loss 2.625788E-01 | loss 2.625788E-01 | loss scale 8388608.0 |speed 14.92 samples/(min*GPU)
[2024-09-16 06:00:46,943] [INFO] [RANK 0] time (ms) | forward: 2096.86 | backward: 1905.40 | allreduce: 0.00 | optimizer: 19.19 | data loader: 0.16
[2024-09-16 06:02:07,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=8000, skipped=14, lr=[0.00093014], mom=[[0.9, 0.95]]
[2024-09-16 06:02:07,169] [INFO] [RANK 0]  iteration     8000/  100000 | elapsed time per iteration (ms): 4011.3 | learning rate 9.301E-04 | total loss 3.364928E-01 | loss 3.364929E-01 | loss scale 8388608.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 06:02:07,180] [INFO] [RANK 0] time (ms) | forward: 2118.28 | backward: 1872.84 | allreduce: 0.00 | optimizer: 19.20 | data loader: 0.18
[2024-09-16 06:02:07,181] [INFO] [RANK 0] Saving Model...
[2024-09-16 06:02:09,437] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/8000/mp_rank_00_model_states.pt
[2024-09-16 06:02:09,437] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/8000/mp_rank_00_model_states.pt...
[2024-09-16 06:02:26,356] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/8000/mp_rank_00_model_states.pt.
[2024-09-16 06:02:26,438] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 06:02:27,265] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/8000-ema/mp_rank_00_model_states.pt
[2024-09-16 06:02:27,265] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/8000-ema/mp_rank_00_model_states.pt...
[2024-09-16 06:02:48,543] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/8000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:56,  1.13s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:55,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:54,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:06<00:52,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:47,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:13<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:40,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:39,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:26<00:32,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:31,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:30,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:32<00:27,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:24,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:39<00:20,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:18,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:45<00:14,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:51<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:57<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.18s/it]
[2024-09-16 06:04:00,820] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 06:04:00,821] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 06:04:00,821] [INFO] [RANK 0]  validation loss at iteration 8000 | loss: 3.417725E-01 | PPL: 1.407440E+00 loss 3.417725E-01 |
[2024-09-16 06:04:00,821] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 8000 is less than current step: 8001. Dropping entry: {'Train/valid_ppl': 1.4074400638297042, 'Train/valid_loss': 0.34177249670028687, '_timestamp': 1726481040.8217738}).
[2024-09-16 06:05:21,328] [INFO] [RANK 0]  iteration     8020/  100000 | elapsed time per iteration (ms): 9708.0 | learning rate 9.299E-04 | total loss 2.487637E-01 | loss 2.487637E-01 | loss scale 8388608.0 |speed 6.18 samples/(min*GPU)
[2024-09-16 06:05:21,329] [INFO] [RANK 0] time (ms) | forward: 2125.70 | backward: 1878.83 | allreduce: 0.00 | optimizer: 19.81 | data loader: 0.18
[2024-09-16 06:06:42,232] [INFO] [RANK 0]  iteration     8040/  100000 | elapsed time per iteration (ms): 4045.2 | learning rate 9.297E-04 | total loss 2.925936E-01 | loss 2.925936E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 06:06:42,232] [INFO] [RANK 0] time (ms) | forward: 2134.48 | backward: 1887.54 | allreduce: 0.00 | optimizer: 22.07 | data loader: 0.18
[2024-09-16 06:07:22,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=8050, skipped=14, lr=[0.00092964], mom=[[0.9, 0.95]]
[2024-09-16 06:08:03,295] [INFO] [RANK 0]  iteration     8060/  100000 | elapsed time per iteration (ms): 4053.2 | learning rate 9.295E-04 | total loss 2.573379E-01 | loss 2.573379E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 06:08:03,296] [INFO] [RANK 0] time (ms) | forward: 2106.66 | backward: 1926.20 | allreduce: 0.00 | optimizer: 19.37 | data loader: 0.16
[2024-09-16 06:09:23,860] [INFO] [RANK 0]  iteration     8080/  100000 | elapsed time per iteration (ms): 4028.3 | learning rate 9.293E-04 | total loss 2.679909E-01 | loss 2.679909E-01 | loss scale 8388608.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 06:09:23,861] [INFO] [RANK 0] time (ms) | forward: 2115.52 | backward: 1892.09 | allreduce: 0.00 | optimizer: 19.78 | data loader: 0.17
[2024-09-16 06:10:46,015] [INFO] [logging.py:96:log_dist] [Rank 0] step=8100, skipped=14, lr=[0.00092914], mom=[[0.9, 0.95]]
[2024-09-16 06:10:46,016] [INFO] [RANK 0]  iteration     8100/  100000 | elapsed time per iteration (ms): 4107.8 | learning rate 9.291E-04 | total loss 2.973479E-01 | loss 2.973478E-01 | loss scale 8388608.0 |speed 14.61 samples/(min*GPU)
[2024-09-16 06:10:46,016] [INFO] [RANK 0] time (ms) | forward: 2123.81 | backward: 1961.29 | allreduce: 0.00 | optimizer: 21.67 | data loader: 0.15
[2024-09-16 06:12:07,295] [INFO] [RANK 0]  iteration     8120/  100000 | elapsed time per iteration (ms): 4064.0 | learning rate 9.289E-04 | total loss 2.906039E-01 | loss 2.906039E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 06:12:07,296] [INFO] [RANK 0] time (ms) | forward: 2122.30 | backward: 1918.59 | allreduce: 0.00 | optimizer: 22.04 | data loader: 0.17
[2024-09-16 06:13:27,794] [INFO] [RANK 0]  iteration     8140/  100000 | elapsed time per iteration (ms): 4024.9 | learning rate 9.287E-04 | total loss 2.553185E-01 | loss 2.553185E-01 | loss scale 8388608.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 06:13:27,794] [INFO] [RANK 0] time (ms) | forward: 2082.30 | backward: 1923.71 | allreduce: 0.00 | optimizer: 18.05 | data loader: 0.17
[2024-09-16 06:14:08,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=8150, skipped=14, lr=[0.00092864], mom=[[0.9, 0.95]]
[2024-09-16 06:14:48,865] [INFO] [RANK 0]  iteration     8160/  100000 | elapsed time per iteration (ms): 4053.6 | learning rate 9.285E-04 | total loss 2.672652E-01 | loss 2.672652E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 06:14:48,866] [INFO] [RANK 0] time (ms) | forward: 2111.67 | backward: 1920.61 | allreduce: 0.00 | optimizer: 20.21 | data loader: 0.17
[2024-09-16 06:16:10,619] [INFO] [RANK 0]  iteration     8180/  100000 | elapsed time per iteration (ms): 4087.7 | learning rate 9.283E-04 | total loss 2.496044E-01 | loss 2.496043E-01 | loss scale 8388608.0 |speed 14.68 samples/(min*GPU)
[2024-09-16 06:16:10,619] [INFO] [RANK 0] time (ms) | forward: 2137.69 | backward: 1928.32 | allreduce: 0.00 | optimizer: 20.62 | data loader: 0.16
[2024-09-16 06:17:32,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=8200, skipped=14, lr=[0.0009281399999999999], mom=[[0.9, 0.95]]
[2024-09-16 06:17:32,153] [INFO] [RANK 0]  iteration     8200/  100000 | elapsed time per iteration (ms): 4076.7 | learning rate 9.281E-04 | total loss 3.383380E-01 | loss 3.383380E-01 | loss scale 8388608.0 |speed 14.72 samples/(min*GPU)
[2024-09-16 06:17:32,153] [INFO] [RANK 0] time (ms) | forward: 2100.60 | backward: 1954.15 | allreduce: 0.00 | optimizer: 20.95 | data loader: 0.19
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 06:18:44,933] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 06:18:44,933] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 06:18:44,933] [INFO] [RANK 0]  validation loss at iteration 8200 | loss: 3.028445E-01 | PPL: 1.353704E+00 loss 3.028445E-01 |
[2024-09-16 06:18:44,933] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 8200 is less than current step: 8201. Dropping entry: {'Train/valid_ppl': 1.3537039397757937, 'Train/valid_loss': 0.30284449458122253, '_timestamp': 1726481924.9338322}).
[2024-09-16 06:20:06,623] [INFO] [RANK 0]  iteration     8220/  100000 | elapsed time per iteration (ms): 7723.5 | learning rate 9.279E-04 | total loss 2.769557E-01 | loss 2.769557E-01 | loss scale 8388608.0 |speed 7.77 samples/(min*GPU)
[2024-09-16 06:20:06,624] [INFO] [RANK 0] time (ms) | forward: 2110.29 | backward: 1953.18 | allreduce: 0.00 | optimizer: 19.98 | data loader: 0.18
[2024-09-16 06:21:27,849] [INFO] [RANK 0]  iteration     8240/  100000 | elapsed time per iteration (ms): 4061.3 | learning rate 9.277E-04 | total loss 3.125408E-01 | loss 3.125408E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 06:21:27,850] [INFO] [RANK 0] time (ms) | forward: 2125.70 | backward: 1914.13 | allreduce: 0.00 | optimizer: 20.45 | data loader: 0.19
[2024-09-16 06:22:08,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=8250, skipped=14, lr=[0.0009276400000000001], mom=[[0.9, 0.95]]
[2024-09-16 06:22:49,112] [INFO] [RANK 0]  iteration     8260/  100000 | elapsed time per iteration (ms): 4063.1 | learning rate 9.275E-04 | total loss 2.821310E-01 | loss 2.821310E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 06:22:49,113] [INFO] [RANK 0] time (ms) | forward: 2111.86 | backward: 1930.67 | allreduce: 0.00 | optimizer: 19.51 | data loader: 0.16
[2024-09-16 06:24:11,080] [INFO] [RANK 0]  iteration     8280/  100000 | elapsed time per iteration (ms): 4098.4 | learning rate 9.273E-04 | total loss 2.799416E-01 | loss 2.799416E-01 | loss scale 8388608.0 |speed 14.64 samples/(min*GPU)
[2024-09-16 06:24:11,080] [INFO] [RANK 0] time (ms) | forward: 2149.61 | backward: 1929.47 | allreduce: 0.00 | optimizer: 18.42 | data loader: 0.14
[2024-09-16 06:25:32,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=8300, skipped=14, lr=[0.00092714], mom=[[0.9, 0.95]]
[2024-09-16 06:25:32,505] [INFO] [RANK 0]  iteration     8300/  100000 | elapsed time per iteration (ms): 4071.3 | learning rate 9.271E-04 | total loss 2.676200E-01 | loss 2.676200E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 06:25:32,506] [INFO] [RANK 0] time (ms) | forward: 2103.23 | backward: 1948.58 | allreduce: 0.00 | optimizer: 18.53 | data loader: 0.19
[2024-09-16 06:26:53,659] [INFO] [RANK 0]  iteration     8320/  100000 | elapsed time per iteration (ms): 4057.7 | learning rate 9.269E-04 | total loss 2.557117E-01 | loss 2.557117E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 06:26:53,660] [INFO] [RANK 0] time (ms) | forward: 2094.87 | backward: 1940.68 | allreduce: 0.00 | optimizer: 21.10 | data loader: 0.16
[2024-09-16 06:28:14,238] [INFO] [RANK 0]  iteration     8340/  100000 | elapsed time per iteration (ms): 4029.0 | learning rate 9.267E-04 | total loss 2.436239E-01 | loss 2.436240E-01 | loss scale 8388608.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 06:28:14,239] [INFO] [RANK 0] time (ms) | forward: 2124.25 | backward: 1884.34 | allreduce: 0.00 | optimizer: 19.40 | data loader: 0.16
[2024-09-16 06:28:54,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=8350, skipped=14, lr=[0.0009266400000000001], mom=[[0.9, 0.95]]
[2024-09-16 06:29:34,478] [INFO] [RANK 0]  iteration     8360/  100000 | elapsed time per iteration (ms): 4012.0 | learning rate 9.265E-04 | total loss 2.126577E-01 | loss 2.126577E-01 | loss scale 8388608.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 06:29:34,479] [INFO] [RANK 0] time (ms) | forward: 2118.35 | backward: 1874.57 | allreduce: 0.00 | optimizer: 18.08 | data loader: 0.17
[2024-09-16 06:30:56,131] [INFO] [RANK 0]  iteration     8380/  100000 | elapsed time per iteration (ms): 4082.7 | learning rate 9.263E-04 | total loss 2.795972E-01 | loss 2.795973E-01 | loss scale 8388608.0 |speed 14.70 samples/(min*GPU)
[2024-09-16 06:30:56,132] [INFO] [RANK 0] time (ms) | forward: 2136.81 | backward: 1926.49 | allreduce: 0.00 | optimizer: 18.38 | data loader: 0.18
[2024-09-16 06:32:17,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=8400, skipped=14, lr=[0.00092614], mom=[[0.9, 0.95]]
[2024-09-16 06:32:17,984] [INFO] [RANK 0]  iteration     8400/  100000 | elapsed time per iteration (ms): 4092.6 | learning rate 9.261E-04 | total loss 2.720461E-01 | loss 2.720461E-01 | loss scale 8388608.0 |speed 14.66 samples/(min*GPU)
[2024-09-16 06:32:17,985] [INFO] [RANK 0] time (ms) | forward: 2104.91 | backward: 1966.16 | allreduce: 0.00 | optimizer: 20.63 | data loader: 0.15
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 06:33:30,577] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 06:33:30,577] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 06:33:30,577] [INFO] [RANK 0]  validation loss at iteration 8400 | loss: 2.057863E-01 | PPL: 1.228491E+00 loss 2.057863E-01 |
[2024-09-16 06:33:30,577] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 8400 is less than current step: 8401. Dropping entry: {'Train/valid_ppl': 1.2284906690961208, 'Train/valid_loss': 0.2057863175868988, '_timestamp': 1726482810.5785537}).
[2024-09-16 06:34:52,449] [INFO] [RANK 0]  iteration     8420/  100000 | elapsed time per iteration (ms): 7723.3 | learning rate 9.259E-04 | total loss 2.890703E-01 | loss 2.890703E-01 | loss scale 8388608.0 |speed 7.77 samples/(min*GPU)
[2024-09-16 06:34:52,450] [INFO] [RANK 0] time (ms) | forward: 2123.61 | backward: 1949.43 | allreduce: 0.00 | optimizer: 19.51 | data loader: 0.22
[2024-09-16 06:36:13,966] [INFO] [RANK 0]  iteration     8440/  100000 | elapsed time per iteration (ms): 4075.9 | learning rate 9.257E-04 | total loss 2.360905E-01 | loss 2.360905E-01 | loss scale 8388608.0 |speed 14.72 samples/(min*GPU)
[2024-09-16 06:36:13,967] [INFO] [RANK 0] time (ms) | forward: 2114.95 | backward: 1940.48 | allreduce: 0.00 | optimizer: 19.50 | data loader: 0.16
[2024-09-16 06:36:54,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=8450, skipped=14, lr=[0.00092564], mom=[[0.9, 0.95]]
[2024-09-16 06:37:34,429] [INFO] [RANK 0]  iteration     8460/  100000 | elapsed time per iteration (ms): 4023.1 | learning rate 9.255E-04 | total loss 2.778849E-01 | loss 2.778849E-01 | loss scale 8388608.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 06:37:34,430] [INFO] [RANK 0] time (ms) | forward: 2113.29 | backward: 1889.44 | allreduce: 0.00 | optimizer: 19.36 | data loader: 0.19
[2024-09-16 06:38:55,630] [INFO] [RANK 0]  iteration     8480/  100000 | elapsed time per iteration (ms): 4060.1 | learning rate 9.253E-04 | total loss 3.004512E-01 | loss 3.004512E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 06:38:55,631] [INFO] [RANK 0] time (ms) | forward: 2127.85 | backward: 1909.40 | allreduce: 0.00 | optimizer: 21.72 | data loader: 0.21
[2024-09-16 06:40:17,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=8500, skipped=14, lr=[0.00092514], mom=[[0.9, 0.95]]
[2024-09-16 06:40:17,061] [INFO] [RANK 0]  iteration     8500/  100000 | elapsed time per iteration (ms): 4071.5 | learning rate 9.251E-04 | total loss 2.354342E-01 | loss 2.354341E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 06:40:17,062] [INFO] [RANK 0] time (ms) | forward: 2098.18 | backward: 1953.79 | allreduce: 0.00 | optimizer: 18.56 | data loader: 0.14
[2024-09-16 06:40:17,062] [INFO] [RANK 0] Saving Model...
[2024-09-16 06:40:19,157] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/8500/mp_rank_00_model_states.pt
[2024-09-16 06:40:19,157] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/8500/mp_rank_00_model_states.pt...
[2024-09-16 06:40:38,285] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/8500/mp_rank_00_model_states.pt.
[2024-09-16 06:40:38,366] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 06:40:39,118] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/8500-ema/mp_rank_00_model_states.pt
[2024-09-16 06:40:39,118] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/8500-ema/mp_rank_00_model_states.pt...
[2024-09-16 06:41:01,993] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/8500-ema/mp_rank_00_model_states.pt.
[2024-09-16 06:42:22,250] [INFO] [RANK 0]  iteration     8520/  100000 | elapsed time per iteration (ms): 6259.4 | learning rate 9.249E-04 | total loss 2.741172E-01 | loss 2.741172E-01 | loss scale 8388608.0 |speed 9.59 samples/(min*GPU)
[2024-09-16 06:42:22,250] [INFO] [RANK 0] time (ms) | forward: 2049.27 | backward: 1940.27 | allreduce: 0.00 | optimizer: 17.51 | data loader: 0.15
[2024-09-16 06:43:42,398] [INFO] [RANK 0]  iteration     8540/  100000 | elapsed time per iteration (ms): 4007.4 | learning rate 9.247E-04 | total loss 2.974750E-01 | loss 2.974750E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 06:43:42,399] [INFO] [RANK 0] time (ms) | forward: 2100.00 | backward: 1890.05 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.13
[2024-09-16 06:44:22,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=8550, skipped=14, lr=[0.00092464], mom=[[0.9, 0.95]]
[2024-09-16 06:45:02,562] [INFO] [RANK 0]  iteration     8560/  100000 | elapsed time per iteration (ms): 4008.2 | learning rate 9.245E-04 | total loss 2.926676E-01 | loss 2.926676E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 06:45:02,563] [INFO] [RANK 0] time (ms) | forward: 2113.37 | backward: 1877.63 | allreduce: 0.00 | optimizer: 16.36 | data loader: 0.13
[2024-09-16 06:46:22,693] [INFO] [RANK 0]  iteration     8580/  100000 | elapsed time per iteration (ms): 4006.5 | learning rate 9.243E-04 | total loss 2.675226E-01 | loss 2.675227E-01 | loss scale 8388608.0 |speed 14.98 samples/(min*GPU)
[2024-09-16 06:46:22,693] [INFO] [RANK 0] time (ms) | forward: 2104.86 | backward: 1884.02 | allreduce: 0.00 | optimizer: 16.77 | data loader: 0.14
[2024-09-16 06:47:44,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=8600, skipped=14, lr=[0.0009241399999999999], mom=[[0.9, 0.95]]
[2024-09-16 06:47:44,680] [INFO] [RANK 0]  iteration     8600/  100000 | elapsed time per iteration (ms): 4099.3 | learning rate 9.241E-04 | total loss 2.752233E-01 | loss 2.752233E-01 | loss scale 8388608.0 |speed 14.64 samples/(min*GPU)
[2024-09-16 06:47:44,923] [INFO] [RANK 0] time (ms) | forward: 2142.65 | backward: 1938.91 | allreduce: 0.00 | optimizer: 16.96 | data loader: 0.15
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:41,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 06:48:58,628] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 06:48:58,628] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 06:48:58,628] [INFO] [RANK 0]  validation loss at iteration 8600 | loss: 2.417412E-01 | PPL: 1.273465E+00 loss 2.417412E-01 |
[2024-09-16 06:48:58,628] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 8600 is less than current step: 8601. Dropping entry: {'Train/valid_ppl': 1.2734646285030202, 'Train/valid_loss': 0.24174124002456665, '_timestamp': 1726483738.628864}).
[2024-09-16 06:50:20,725] [INFO] [RANK 0]  iteration     8620/  100000 | elapsed time per iteration (ms): 7802.3 | learning rate 9.239E-04 | total loss 3.135368E-01 | loss 3.135368E-01 | loss scale 8388608.0 |speed 7.69 samples/(min*GPU)
[2024-09-16 06:50:20,725] [INFO] [RANK 0] time (ms) | forward: 2111.46 | backward: 1975.17 | allreduce: 0.00 | optimizer: 17.35 | data loader: 0.15
[2024-09-16 06:51:40,959] [INFO] [RANK 0]  iteration     8640/  100000 | elapsed time per iteration (ms): 4011.7 | learning rate 9.237E-04 | total loss 3.052475E-01 | loss 3.052475E-01 | loss scale 8388608.0 |speed 14.96 samples/(min*GPU)
[2024-09-16 06:51:40,960] [INFO] [RANK 0] time (ms) | forward: 2131.34 | backward: 1863.15 | allreduce: 0.00 | optimizer: 16.42 | data loader: 0.14
[2024-09-16 06:52:21,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=8650, skipped=14, lr=[0.00092364], mom=[[0.9, 0.95]]
[2024-09-16 06:53:02,520] [INFO] [RANK 0]  iteration     8660/  100000 | elapsed time per iteration (ms): 4078.1 | learning rate 9.235E-04 | total loss 2.354620E-01 | loss 2.354620E-01 | loss scale 16777216.0 |speed 14.71 samples/(min*GPU)
[2024-09-16 06:53:02,521] [INFO] [RANK 0] time (ms) | forward: 2138.30 | backward: 1922.31 | allreduce: 0.00 | optimizer: 16.60 | data loader: 0.13
[2024-09-16 06:54:07,010] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
[2024-09-16 06:54:23,240] [INFO] [RANK 0]  iteration     8680/  100000 | elapsed time per iteration (ms): 4036.0 | learning rate 9.233E-04 | total loss 3.122823E-01 | loss 3.122823E-01 | loss scale 8388608.0 |speed 14.87 samples/(min*GPU)
[2024-09-16 06:54:23,241] [INFO] [RANK 0] time (ms) | forward: 2105.35 | backward: 1913.51 | allreduce: 0.00 | optimizer: 16.26 | data loader: 0.15
[2024-09-16 06:55:45,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=8700, skipped=15, lr=[0.0009231500000000001], mom=[[0.9, 0.95]]
[2024-09-16 06:55:45,189] [INFO] [RANK 0]  iteration     8700/  100000 | elapsed time per iteration (ms): 4097.4 | learning rate 9.231E-04 | total loss 2.461202E-01 | loss 2.461202E-01 | loss scale 8388608.0 |speed 14.64 samples/(min*GPU)
[2024-09-16 06:55:45,189] [INFO] [RANK 0] time (ms) | forward: 2132.01 | backward: 1947.92 | allreduce: 0.00 | optimizer: 16.66 | data loader: 0.14
[2024-09-16 06:57:06,117] [INFO] [RANK 0]  iteration     8720/  100000 | elapsed time per iteration (ms): 4046.4 | learning rate 9.229E-04 | total loss 2.689368E-01 | loss 2.689368E-01 | loss scale 8388608.0 |speed 14.83 samples/(min*GPU)
[2024-09-16 06:57:06,117] [INFO] [RANK 0] time (ms) | forward: 2100.26 | backward: 1928.93 | allreduce: 0.00 | optimizer: 16.41 | data loader: 0.16
[2024-09-16 06:58:26,842] [INFO] [RANK 0]  iteration     8740/  100000 | elapsed time per iteration (ms): 4036.3 | learning rate 9.227E-04 | total loss 2.518775E-01 | loss 2.518775E-01 | loss scale 8388608.0 |speed 14.87 samples/(min*GPU)
[2024-09-16 06:58:26,843] [INFO] [RANK 0] time (ms) | forward: 2091.78 | backward: 1927.26 | allreduce: 0.00 | optimizer: 16.40 | data loader: 0.12
[2024-09-16 06:59:06,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=8750, skipped=15, lr=[0.00092265], mom=[[0.9, 0.95]]
[2024-09-16 06:59:47,005] [INFO] [RANK 0]  iteration     8760/  100000 | elapsed time per iteration (ms): 4008.1 | learning rate 9.225E-04 | total loss 2.423081E-01 | loss 2.423081E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 06:59:47,005] [INFO] [RANK 0] time (ms) | forward: 2123.92 | backward: 1866.64 | allreduce: 0.00 | optimizer: 16.71 | data loader: 0.14
[2024-09-16 07:01:09,059] [INFO] [RANK 0]  iteration     8780/  100000 | elapsed time per iteration (ms): 4102.7 | learning rate 9.223E-04 | total loss 2.914862E-01 | loss 2.914862E-01 | loss scale 8388608.0 |speed 14.62 samples/(min*GPU)
[2024-09-16 07:01:09,059] [INFO] [RANK 0] time (ms) | forward: 2122.59 | backward: 1962.41 | allreduce: 0.00 | optimizer: 16.79 | data loader: 0.14
[2024-09-16 07:02:29,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=8800, skipped=15, lr=[0.00092215], mom=[[0.9, 0.95]]
[2024-09-16 07:02:29,431] [INFO] [RANK 0]  iteration     8800/  100000 | elapsed time per iteration (ms): 4018.6 | learning rate 9.221E-04 | total loss 2.698850E-01 | loss 2.698850E-01 | loss scale 8388608.0 |speed 14.93 samples/(min*GPU)
[2024-09-16 07:02:29,432] [INFO] [RANK 0] time (ms) | forward: 2137.64 | backward: 1863.37 | allreduce: 0.00 | optimizer: 16.68 | data loader: 0.15
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:23,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 07:03:42,074] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 07:03:42,075] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 07:03:42,076] [INFO] [RANK 0]  validation loss at iteration 8800 | loss: 1.547505E-01 | PPL: 1.167367E+00 loss 1.547505E-01 |
[2024-09-16 07:03:42,076] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 8800 is less than current step: 8801. Dropping entry: {'Train/valid_ppl': 1.1673667144742093, 'Train/valid_loss': 0.1547505408525467, '_timestamp': 1726484622.076885}).
[2024-09-16 07:05:02,963] [INFO] [RANK 0]  iteration     8820/  100000 | elapsed time per iteration (ms): 7676.6 | learning rate 9.219E-04 | total loss 2.587739E-01 | loss 2.587738E-01 | loss scale 8388608.0 |speed 7.82 samples/(min*GPU)
[2024-09-16 07:05:02,964] [INFO] [RANK 0] time (ms) | forward: 2102.09 | backward: 1924.74 | allreduce: 0.00 | optimizer: 16.64 | data loader: 0.14
[2024-09-16 07:06:24,141] [INFO] [RANK 0]  iteration     8840/  100000 | elapsed time per iteration (ms): 4058.9 | learning rate 9.217E-04 | total loss 2.697063E-01 | loss 2.697063E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 07:06:24,142] [INFO] [RANK 0] time (ms) | forward: 2123.83 | backward: 1917.70 | allreduce: 0.00 | optimizer: 16.48 | data loader: 0.13
[2024-09-16 07:07:04,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=8850, skipped=15, lr=[0.00092165], mom=[[0.9, 0.95]]
[2024-09-16 07:07:45,257] [INFO] [RANK 0]  iteration     8860/  100000 | elapsed time per iteration (ms): 4055.8 | learning rate 9.215E-04 | total loss 2.734802E-01 | loss 2.734802E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 07:07:45,258] [INFO] [RANK 0] time (ms) | forward: 2140.21 | backward: 1898.11 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.14
[2024-09-16 07:09:06,268] [INFO] [RANK 0]  iteration     8880/  100000 | elapsed time per iteration (ms): 4050.6 | learning rate 9.213E-04 | total loss 3.124984E-01 | loss 3.124984E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 07:09:06,269] [INFO] [RANK 0] time (ms) | forward: 2105.34 | backward: 1927.48 | allreduce: 0.00 | optimizer: 16.61 | data loader: 0.12
[2024-09-16 07:10:27,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=8900, skipped=15, lr=[0.00092115], mom=[[0.9, 0.95]]
[2024-09-16 07:10:27,509] [INFO] [RANK 0]  iteration     8900/  100000 | elapsed time per iteration (ms): 4062.0 | learning rate 9.211E-04 | total loss 2.520493E-01 | loss 2.520493E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 07:10:27,511] [INFO] [RANK 0] time (ms) | forward: 2133.23 | backward: 1911.30 | allreduce: 0.00 | optimizer: 16.62 | data loader: 0.13
[2024-09-16 07:11:47,988] [INFO] [RANK 0]  iteration     8920/  100000 | elapsed time per iteration (ms): 4024.0 | learning rate 9.209E-04 | total loss 2.687630E-01 | loss 2.687630E-01 | loss scale 8388608.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 07:11:47,989] [INFO] [RANK 0] time (ms) | forward: 2132.95 | backward: 1873.40 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.14
[2024-09-16 07:13:09,411] [INFO] [RANK 0]  iteration     8940/  100000 | elapsed time per iteration (ms): 4071.2 | learning rate 9.207E-04 | total loss 3.308463E-01 | loss 3.308463E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 07:13:09,412] [INFO] [RANK 0] time (ms) | forward: 2103.61 | backward: 1950.16 | allreduce: 0.00 | optimizer: 16.51 | data loader: 0.13
[2024-09-16 07:13:50,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=8950, skipped=15, lr=[0.00092065], mom=[[0.9, 0.95]]
[2024-09-16 07:14:30,764] [INFO] [RANK 0]  iteration     8960/  100000 | elapsed time per iteration (ms): 4067.6 | learning rate 9.205E-04 | total loss 2.617151E-01 | loss 2.617151E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 07:14:30,764] [INFO] [RANK 0] time (ms) | forward: 2129.87 | backward: 1920.25 | allreduce: 0.00 | optimizer: 16.56 | data loader: 0.13
[2024-09-16 07:15:51,393] [INFO] [RANK 0]  iteration     8980/  100000 | elapsed time per iteration (ms): 4031.5 | learning rate 9.203E-04 | total loss 2.554888E-01 | loss 2.554888E-01 | loss scale 8388608.0 |speed 14.88 samples/(min*GPU)
[2024-09-16 07:15:51,394] [INFO] [RANK 0] time (ms) | forward: 2125.33 | backward: 1888.45 | allreduce: 0.00 | optimizer: 16.76 | data loader: 0.14
[2024-09-16 07:17:12,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=9000, skipped=15, lr=[0.00092015], mom=[[0.9, 0.95]]
[2024-09-16 07:17:12,420] [INFO] [RANK 0]  iteration     9000/  100000 | elapsed time per iteration (ms): 4051.3 | learning rate 9.201E-04 | total loss 2.816793E-01 | loss 2.816793E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 07:17:12,422] [INFO] [RANK 0] time (ms) | forward: 2089.21 | backward: 1944.43 | allreduce: 0.00 | optimizer: 16.80 | data loader: 0.14
[2024-09-16 07:17:12,422] [INFO] [RANK 0] Saving Model...
[2024-09-16 07:17:14,298] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/9000/mp_rank_00_model_states.pt
[2024-09-16 07:17:14,299] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/9000/mp_rank_00_model_states.pt...
[2024-09-16 07:17:24,040] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/9000/mp_rank_00_model_states.pt.
[2024-09-16 07:17:24,106] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 07:17:24,915] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/9000-ema/mp_rank_00_model_states.pt
[2024-09-16 07:17:24,915] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/9000-ema/mp_rank_00_model_states.pt...
[2024-09-16 07:17:37,018] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/9000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:57,  1.14s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:56,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:55,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:54,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:53,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:48,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:47,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]
[2024-09-16 07:19:46,162] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 07:19:46,162] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 07:19:46,163] [INFO] [RANK 0]  validation loss at iteration 9000 | loss: 3.347462E-01 | PPL: 1.397586E+00 loss 3.347462E-01 |
[2024-09-16 07:19:46,163] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 9000 is less than current step: 9001. Dropping entry: {'Train/valid_ppl': 1.397585691069626, 'Train/valid_loss': 0.33474624156951904, '_timestamp': 1726485586.1645248}).
[2024-09-16 07:21:05,883] [INFO] [RANK 0]  iteration     9020/  100000 | elapsed time per iteration (ms): 11673.2 | learning rate 9.199E-04 | total loss 3.025482E-01 | loss 3.025482E-01 | loss scale 8388608.0 |speed 5.14 samples/(min*GPU)
[2024-09-16 07:21:05,885] [INFO] [RANK 0] time (ms) | forward: 2070.28 | backward: 1894.48 | allreduce: 0.00 | optimizer: 20.25 | data loader: 0.18
[2024-09-16 07:22:26,269] [INFO] [RANK 0]  iteration     9040/  100000 | elapsed time per iteration (ms): 4019.3 | learning rate 9.197E-04 | total loss 3.084100E-01 | loss 3.084101E-01 | loss scale 8388608.0 |speed 14.93 samples/(min*GPU)
[2024-09-16 07:22:26,270] [INFO] [RANK 0] time (ms) | forward: 2104.10 | backward: 1894.90 | allreduce: 0.00 | optimizer: 19.35 | data loader: 0.16
[2024-09-16 07:23:07,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=9050, skipped=15, lr=[0.0009196499999999999], mom=[[0.9, 0.95]]
[2024-09-16 07:23:47,351] [INFO] [RANK 0]  iteration     9060/  100000 | elapsed time per iteration (ms): 4054.1 | learning rate 9.195E-04 | total loss 2.429263E-01 | loss 2.429263E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 07:23:47,352] [INFO] [RANK 0] time (ms) | forward: 2127.06 | backward: 1904.19 | allreduce: 0.00 | optimizer: 21.85 | data loader: 0.16
[2024-09-16 07:25:08,455] [INFO] [RANK 0]  iteration     9080/  100000 | elapsed time per iteration (ms): 4055.2 | learning rate 9.193E-04 | total loss 3.026354E-01 | loss 3.026354E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 07:25:08,456] [INFO] [RANK 0] time (ms) | forward: 2114.01 | backward: 1918.10 | allreduce: 0.00 | optimizer: 22.05 | data loader: 0.16
[2024-09-16 07:26:28,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=9100, skipped=15, lr=[0.0009191500000000001], mom=[[0.9, 0.95]]
[2024-09-16 07:26:28,977] [INFO] [RANK 0]  iteration     9100/  100000 | elapsed time per iteration (ms): 4026.1 | learning rate 9.191E-04 | total loss 3.105386E-01 | loss 3.105386E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 07:26:28,980] [INFO] [RANK 0] time (ms) | forward: 2136.06 | backward: 1870.34 | allreduce: 0.00 | optimizer: 18.76 | data loader: 0.16
[2024-09-16 07:27:50,186] [INFO] [RANK 0]  iteration     9120/  100000 | elapsed time per iteration (ms): 4060.5 | learning rate 9.189E-04 | total loss 2.403012E-01 | loss 2.403012E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 07:27:50,187] [INFO] [RANK 0] time (ms) | forward: 2107.17 | backward: 1931.15 | allreduce: 0.00 | optimizer: 20.91 | data loader: 0.18
[2024-09-16 07:29:12,322] [INFO] [RANK 0]  iteration     9140/  100000 | elapsed time per iteration (ms): 4106.8 | learning rate 9.187E-04 | total loss 2.714167E-01 | loss 2.714167E-01 | loss scale 8388608.0 |speed 14.61 samples/(min*GPU)
[2024-09-16 07:29:12,323] [INFO] [RANK 0] time (ms) | forward: 2136.75 | backward: 1937.73 | allreduce: 0.00 | optimizer: 30.87 | data loader: 0.23
[2024-09-16 07:29:53,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=9150, skipped=15, lr=[0.00091865], mom=[[0.9, 0.95]]
[2024-09-16 07:30:34,357] [INFO] [RANK 0]  iteration     9160/  100000 | elapsed time per iteration (ms): 4101.8 | learning rate 9.185E-04 | total loss 3.153597E-01 | loss 3.153597E-01 | loss scale 8388608.0 |speed 14.63 samples/(min*GPU)
[2024-09-16 07:30:34,358] [INFO] [RANK 0] time (ms) | forward: 2132.88 | backward: 1935.72 | allreduce: 0.00 | optimizer: 31.47 | data loader: 0.42
[2024-09-16 07:31:55,870] [INFO] [RANK 0]  iteration     9180/  100000 | elapsed time per iteration (ms): 4075.6 | learning rate 9.183E-04 | total loss 2.577182E-01 | loss 2.577183E-01 | loss scale 8388608.0 |speed 14.72 samples/(min*GPU)
[2024-09-16 07:31:55,870] [INFO] [RANK 0] time (ms) | forward: 2115.90 | backward: 1935.35 | allreduce: 0.00 | optimizer: 22.84 | data loader: 0.20
[2024-09-16 07:33:16,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=9200, skipped=15, lr=[0.0009181500000000001], mom=[[0.9, 0.95]]
[2024-09-16 07:33:16,605] [INFO] [RANK 0]  iteration     9200/  100000 | elapsed time per iteration (ms): 4036.8 | learning rate 9.181E-04 | total loss 2.783777E-01 | loss 2.783777E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 07:33:16,606] [INFO] [RANK 0] time (ms) | forward: 2113.53 | backward: 1892.47 | allreduce: 0.00 | optimizer: 29.88 | data loader: 0.15
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:35,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 07:35:38,386] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 07:35:38,387] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 07:35:38,388] [INFO] [RANK 0]  validation loss at iteration 9200 | loss: 2.539616E-01 | PPL: 1.289122E+00 loss 2.539616E-01 |
[2024-09-16 07:35:38,388] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 9200 is less than current step: 9201. Dropping entry: {'Train/valid_ppl': 1.2891222534657212, 'Train/valid_loss': 0.25396156311035156, '_timestamp': 1726486538.3886495}).
[2024-09-16 07:36:58,506] [INFO] [RANK 0]  iteration     9220/  100000 | elapsed time per iteration (ms): 11095.1 | learning rate 9.179E-04 | total loss 2.178395E-01 | loss 2.178395E-01 | loss scale 8388608.0 |speed 5.41 samples/(min*GPU)
[2024-09-16 07:36:58,507] [INFO] [RANK 0] time (ms) | forward: 2061.25 | backward: 1923.59 | allreduce: 0.00 | optimizer: 20.03 | data loader: 0.16
[2024-09-16 07:38:18,809] [INFO] [RANK 0]  iteration     9240/  100000 | elapsed time per iteration (ms): 4015.1 | learning rate 9.177E-04 | total loss 2.447468E-01 | loss 2.447468E-01 | loss scale 8388608.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 07:38:18,810] [INFO] [RANK 0] time (ms) | forward: 2103.83 | backward: 1891.63 | allreduce: 0.00 | optimizer: 18.69 | data loader: 0.17
[2024-09-16 07:38:59,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=9250, skipped=15, lr=[0.00091765], mom=[[0.9, 0.95]]
[2024-09-16 07:39:39,943] [INFO] [RANK 0]  iteration     9260/  100000 | elapsed time per iteration (ms): 4056.7 | learning rate 9.175E-04 | total loss 2.608420E-01 | loss 2.608420E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 07:39:39,944] [INFO] [RANK 0] time (ms) | forward: 2112.70 | backward: 1923.74 | allreduce: 0.00 | optimizer: 19.26 | data loader: 0.19
[2024-09-16 07:41:00,961] [INFO] [RANK 0]  iteration     9280/  100000 | elapsed time per iteration (ms): 4050.9 | learning rate 9.173E-04 | total loss 2.681115E-01 | loss 2.681115E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 07:41:00,962] [INFO] [RANK 0] time (ms) | forward: 2126.10 | backward: 1903.19 | allreduce: 0.00 | optimizer: 20.50 | data loader: 0.18
[2024-09-16 07:42:22,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=9300, skipped=15, lr=[0.00091715], mom=[[0.9, 0.95]]
[2024-09-16 07:42:22,391] [INFO] [RANK 0]  iteration     9300/  100000 | elapsed time per iteration (ms): 4071.5 | learning rate 9.171E-04 | total loss 2.756037E-01 | loss 2.756037E-01 | loss scale 8388608.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 07:42:22,393] [INFO] [RANK 0] time (ms) | forward: 2126.06 | backward: 1924.97 | allreduce: 0.00 | optimizer: 19.50 | data loader: 0.16
[2024-09-16 07:43:43,521] [INFO] [RANK 0]  iteration     9320/  100000 | elapsed time per iteration (ms): 4056.5 | learning rate 9.169E-04 | total loss 3.211673E-01 | loss 3.211672E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 07:43:43,522] [INFO] [RANK 0] time (ms) | forward: 2120.07 | backward: 1915.24 | allreduce: 0.00 | optimizer: 20.03 | data loader: 0.19
[2024-09-16 07:45:04,535] [INFO] [RANK 0]  iteration     9340/  100000 | elapsed time per iteration (ms): 4050.7 | learning rate 9.167E-04 | total loss 2.593670E-01 | loss 2.593670E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 07:45:04,535] [INFO] [RANK 0] time (ms) | forward: 2109.68 | backward: 1921.42 | allreduce: 0.00 | optimizer: 18.59 | data loader: 0.18
[2024-09-16 07:45:44,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=9350, skipped=15, lr=[0.00091665], mom=[[0.9, 0.95]]
[2024-09-16 07:46:25,149] [INFO] [RANK 0]  iteration     9360/  100000 | elapsed time per iteration (ms): 4030.7 | learning rate 9.165E-04 | total loss 2.556963E-01 | loss 2.556964E-01 | loss scale 8388608.0 |speed 14.89 samples/(min*GPU)
[2024-09-16 07:46:25,150] [INFO] [RANK 0] time (ms) | forward: 2104.97 | backward: 1902.20 | allreduce: 0.00 | optimizer: 22.53 | data loader: 0.19
[2024-09-16 07:47:46,966] [INFO] [RANK 0]  iteration     9380/  100000 | elapsed time per iteration (ms): 4090.9 | learning rate 9.163E-04 | total loss 2.801789E-01 | loss 2.801789E-01 | loss scale 8388608.0 |speed 14.67 samples/(min*GPU)
[2024-09-16 07:47:46,967] [INFO] [RANK 0] time (ms) | forward: 2125.05 | backward: 1945.73 | allreduce: 0.00 | optimizer: 19.14 | data loader: 0.14
[2024-09-16 07:49:07,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=9400, skipped=15, lr=[0.00091615], mom=[[0.9, 0.95]]
[2024-09-16 07:49:07,836] [INFO] [RANK 0]  iteration     9400/  100000 | elapsed time per iteration (ms): 4043.5 | learning rate 9.161E-04 | total loss 3.019704E-01 | loss 3.019703E-01 | loss scale 8388608.0 |speed 14.84 samples/(min*GPU)
[2024-09-16 07:49:07,837] [INFO] [RANK 0] time (ms) | forward: 2125.27 | backward: 1897.13 | allreduce: 0.00 | optimizer: 20.05 | data loader: 0.16
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 07:50:20,515] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 07:50:20,516] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 07:50:20,520] [INFO] [RANK 0]  validation loss at iteration 9400 | loss: 1.551371E-01 | PPL: 1.167818E+00 loss 1.551371E-01 |
[2024-09-16 07:50:20,520] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 9400 is less than current step: 9401. Dropping entry: {'Train/valid_ppl': 1.1678180833012408, 'Train/valid_loss': 0.15513712167739868, '_timestamp': 1726487420.5220592}).
[2024-09-16 07:51:41,734] [INFO] [RANK 0]  iteration     9420/  100000 | elapsed time per iteration (ms): 7694.9 | learning rate 9.159E-04 | total loss 2.229811E-01 | loss 2.229811E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 07:51:41,735] [INFO] [RANK 0] time (ms) | forward: 2113.79 | backward: 1926.86 | allreduce: 0.00 | optimizer: 19.03 | data loader: 0.17
[2024-09-16 07:53:02,745] [INFO] [RANK 0]  iteration     9440/  100000 | elapsed time per iteration (ms): 4050.5 | learning rate 9.157E-04 | total loss 2.594471E-01 | loss 2.594471E-01 | loss scale 8388608.0 |speed 14.81 samples/(min*GPU)
[2024-09-16 07:53:02,746] [INFO] [RANK 0] time (ms) | forward: 2134.31 | backward: 1894.40 | allreduce: 0.00 | optimizer: 20.78 | data loader: 0.17
[2024-09-16 07:53:43,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=9450, skipped=15, lr=[0.00091565], mom=[[0.9, 0.95]]
[2024-09-16 07:54:23,258] [INFO] [RANK 0]  iteration     9460/  100000 | elapsed time per iteration (ms): 4025.7 | learning rate 9.155E-04 | total loss 2.359292E-01 | loss 2.359292E-01 | loss scale 8388608.0 |speed 14.90 samples/(min*GPU)
[2024-09-16 07:54:23,259] [INFO] [RANK 0] time (ms) | forward: 2115.79 | backward: 1889.54 | allreduce: 0.00 | optimizer: 19.36 | data loader: 0.14
[2024-09-16 07:55:44,391] [INFO] [RANK 0]  iteration     9480/  100000 | elapsed time per iteration (ms): 4056.6 | learning rate 9.153E-04 | total loss 2.550472E-01 | loss 2.550472E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 07:55:44,391] [INFO] [RANK 0] time (ms) | forward: 2105.96 | backward: 1928.56 | allreduce: 0.00 | optimizer: 21.00 | data loader: 0.15
[2024-09-16 07:57:05,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=9500, skipped=15, lr=[0.00091515], mom=[[0.9, 0.95]]
[2024-09-16 07:57:05,011] [INFO] [RANK 0]  iteration     9500/  100000 | elapsed time per iteration (ms): 4031.0 | learning rate 9.151E-04 | total loss 2.397365E-01 | loss 2.397365E-01 | loss scale 8388608.0 |speed 14.88 samples/(min*GPU)
[2024-09-16 07:57:05,014] [INFO] [RANK 0] time (ms) | forward: 2142.54 | backward: 1869.64 | allreduce: 0.00 | optimizer: 17.86 | data loader: 0.13
[2024-09-16 07:57:05,014] [INFO] [RANK 0] Saving Model...
[2024-09-16 07:57:06,874] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/9500/mp_rank_00_model_states.pt
[2024-09-16 07:57:06,874] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/9500/mp_rank_00_model_states.pt...
[2024-09-16 07:57:17,097] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/9500/mp_rank_00_model_states.pt.
[2024-09-16 07:57:17,175] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 07:57:17,977] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/9500-ema/mp_rank_00_model_states.pt
[2024-09-16 07:57:17,977] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/9500-ema/mp_rank_00_model_states.pt...
[2024-09-16 07:57:28,604] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/9500-ema/mp_rank_00_model_states.pt.
[2024-09-16 07:58:49,502] [INFO] [RANK 0]  iteration     9520/  100000 | elapsed time per iteration (ms): 5224.6 | learning rate 9.149E-04 | total loss 2.584571E-01 | loss 2.584570E-01 | loss scale 8388608.0 |speed 11.48 samples/(min*GPU)
[2024-09-16 07:58:49,504] [INFO] [RANK 0] time (ms) | forward: 2066.47 | backward: 1949.63 | allreduce: 0.00 | optimizer: 22.74 | data loader: 0.15
[2024-09-16 08:00:09,927] [INFO] [RANK 0]  iteration     9540/  100000 | elapsed time per iteration (ms): 4021.2 | learning rate 9.147E-04 | total loss 3.042380E-01 | loss 3.042380E-01 | loss scale 8388608.0 |speed 14.92 samples/(min*GPU)
[2024-09-16 08:00:09,928] [INFO] [RANK 0] time (ms) | forward: 2100.76 | backward: 1902.07 | allreduce: 0.00 | optimizer: 17.44 | data loader: 0.14
[2024-09-16 08:00:51,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=9550, skipped=15, lr=[0.00091465], mom=[[0.9, 0.95]]
[2024-09-16 08:01:32,253] [INFO] [RANK 0]  iteration     9560/  100000 | elapsed time per iteration (ms): 4116.3 | learning rate 9.145E-04 | total loss 2.615271E-01 | loss 2.615271E-01 | loss scale 8388608.0 |speed 14.58 samples/(min*GPU)
[2024-09-16 08:01:32,254] [INFO] [RANK 0] time (ms) | forward: 2124.33 | backward: 1970.22 | allreduce: 0.00 | optimizer: 20.61 | data loader: 0.19
[2024-09-16 08:02:53,379] [INFO] [RANK 0]  iteration     9580/  100000 | elapsed time per iteration (ms): 4056.3 | learning rate 9.143E-04 | total loss 3.357385E-01 | loss 3.357385E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 08:02:53,379] [INFO] [RANK 0] time (ms) | forward: 2126.73 | backward: 1910.31 | allreduce: 0.00 | optimizer: 18.20 | data loader: 0.14
[2024-09-16 08:04:14,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=9600, skipped=15, lr=[0.0009141500000000001], mom=[[0.9, 0.95]]
[2024-09-16 08:04:14,722] [INFO] [RANK 0]  iteration     9600/  100000 | elapsed time per iteration (ms): 4067.2 | learning rate 9.141E-04 | total loss 2.372650E-01 | loss 2.372650E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 08:04:14,724] [INFO] [RANK 0] time (ms) | forward: 2121.87 | backward: 1923.16 | allreduce: 0.00 | optimizer: 21.09 | data loader: 0.16
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:47,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:17,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 08:05:27,608] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 08:05:27,609] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 08:05:27,610] [INFO] [RANK 0]  validation loss at iteration 9600 | loss: 2.797913E-01 | PPL: 1.322854E+00 loss 2.797913E-01 |
[2024-09-16 08:05:27,610] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 9600 is less than current step: 9601. Dropping entry: {'Train/valid_ppl': 1.3228537374673697, 'Train/valid_loss': 0.27979132533073425, '_timestamp': 1726488327.611797}).
[2024-09-16 08:06:49,861] [INFO] [RANK 0]  iteration     9620/  100000 | elapsed time per iteration (ms): 7756.9 | learning rate 9.139E-04 | total loss 2.155435E-01 | loss 2.155434E-01 | loss scale 8388608.0 |speed 7.74 samples/(min*GPU)
[2024-09-16 08:06:49,862] [INFO] [RANK 0] time (ms) | forward: 2111.27 | backward: 1980.84 | allreduce: 0.00 | optimizer: 19.34 | data loader: 0.19
[2024-09-16 08:08:11,145] [INFO] [RANK 0]  iteration     9640/  100000 | elapsed time per iteration (ms): 4064.2 | learning rate 9.137E-04 | total loss 2.659614E-01 | loss 2.659614E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 08:08:11,147] [INFO] [RANK 0] time (ms) | forward: 2127.75 | backward: 1914.95 | allreduce: 0.00 | optimizer: 20.52 | data loader: 0.16
[2024-09-16 08:08:51,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=9650, skipped=15, lr=[0.00091365], mom=[[0.9, 0.95]]
[2024-09-16 08:09:31,457] [INFO] [RANK 0]  iteration     9660/  100000 | elapsed time per iteration (ms): 4015.6 | learning rate 9.135E-04 | total loss 3.089341E-01 | loss 3.089341E-01 | loss scale 8388608.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 08:09:31,458] [INFO] [RANK 0] time (ms) | forward: 2117.06 | backward: 1878.67 | allreduce: 0.00 | optimizer: 18.86 | data loader: 0.17
[2024-09-16 08:10:52,851] [INFO] [RANK 0]  iteration     9680/  100000 | elapsed time per iteration (ms): 4069.7 | learning rate 9.133E-04 | total loss 2.628198E-01 | loss 2.628198E-01 | loss scale 16777216.0 |speed 14.74 samples/(min*GPU)
[2024-09-16 08:10:52,852] [INFO] [RANK 0] time (ms) | forward: 2129.01 | backward: 1917.77 | allreduce: 0.00 | optimizer: 21.77 | data loader: 0.20
[2024-09-16 08:12:14,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=9700, skipped=15, lr=[0.00091315], mom=[[0.9, 0.95]]
[2024-09-16 08:12:14,030] [INFO] [RANK 0]  iteration     9700/  100000 | elapsed time per iteration (ms): 4059.0 | learning rate 9.131E-04 | total loss 2.553113E-01 | loss 2.553114E-01 | loss scale 16777216.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 08:12:14,032] [INFO] [RANK 0] time (ms) | forward: 2121.51 | backward: 1917.03 | allreduce: 0.00 | optimizer: 19.44 | data loader: 0.16
[2024-09-16 08:13:35,540] [INFO] [RANK 0]  iteration     9720/  100000 | elapsed time per iteration (ms): 4075.5 | learning rate 9.129E-04 | total loss 2.524355E-01 | loss 2.524355E-01 | loss scale 16777216.0 |speed 14.72 samples/(min*GPU)
[2024-09-16 08:13:35,541] [INFO] [RANK 0] time (ms) | forward: 2136.88 | backward: 1915.76 | allreduce: 0.00 | optimizer: 21.74 | data loader: 0.18
[2024-09-16 08:14:56,645] [INFO] [RANK 0]  iteration     9740/  100000 | elapsed time per iteration (ms): 4055.2 | learning rate 9.127E-04 | total loss 2.631480E-01 | loss 2.631481E-01 | loss scale 16777216.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 08:14:56,645] [INFO] [RANK 0] time (ms) | forward: 2117.53 | backward: 1920.16 | allreduce: 0.00 | optimizer: 16.66 | data loader: 0.14
[2024-09-16 08:15:33,783] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
[2024-09-16 08:15:37,836] [INFO] [logging.py:96:log_dist] [Rank 0] step=9750, skipped=16, lr=[0.00091266], mom=[[0.9, 0.95]]
[2024-09-16 08:16:18,121] [INFO] [RANK 0]  iteration     9760/  100000 | elapsed time per iteration (ms): 4073.8 | learning rate 9.126E-04 | total loss 2.652879E-01 | loss 2.652879E-01 | loss scale 8388608.0 |speed 14.73 samples/(min*GPU)
[2024-09-16 08:16:18,122] [INFO] [RANK 0] time (ms) | forward: 2123.92 | backward: 1928.12 | allreduce: 0.00 | optimizer: 20.68 | data loader: 0.17
[2024-09-16 08:17:39,476] [INFO] [RANK 0]  iteration     9780/  100000 | elapsed time per iteration (ms): 4067.7 | learning rate 9.124E-04 | total loss 2.318397E-01 | loss 2.318397E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 08:17:39,477] [INFO] [RANK 0] time (ms) | forward: 2112.93 | backward: 1935.03 | allreduce: 0.00 | optimizer: 18.11 | data loader: 0.15
[2024-09-16 08:19:01,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=9800, skipped=16, lr=[0.00091216], mom=[[0.9, 0.95]]
[2024-09-16 08:19:01,844] [INFO] [RANK 0]  iteration     9800/  100000 | elapsed time per iteration (ms): 4118.4 | learning rate 9.122E-04 | total loss 2.981568E-01 | loss 2.981567E-01 | loss scale 8388608.0 |speed 14.57 samples/(min*GPU)
[2024-09-16 08:19:01,847] [INFO] [RANK 0] time (ms) | forward: 2147.63 | backward: 1950.90 | allreduce: 0.00 | optimizer: 18.89 | data loader: 0.16
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:11,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 08:20:14,613] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 08:20:14,613] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-09-16 08:20:14,615] [INFO] [RANK 0]  validation loss at iteration 9800 | loss: 1.584393E-01 | PPL: 1.171681E+00 loss 1.584393E-01 |
[2024-09-16 08:20:14,616] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 9800 is less than current step: 9801. Dropping entry: {'Train/valid_ppl': 1.171680845808706, 'Train/valid_loss': 0.15843933820724487, '_timestamp': 1726489214.6171856}).
[2024-09-16 08:21:36,167] [INFO] [RANK 0]  iteration     9820/  100000 | elapsed time per iteration (ms): 7716.1 | learning rate 9.120E-04 | total loss 2.692365E-01 | loss 2.692365E-01 | loss scale 8388608.0 |speed 7.78 samples/(min*GPU)
[2024-09-16 08:21:36,167] [INFO] [RANK 0] time (ms) | forward: 2135.18 | backward: 1921.87 | allreduce: 0.00 | optimizer: 19.44 | data loader: 0.14
[2024-09-16 08:22:57,828] [INFO] [RANK 0]  iteration     9840/  100000 | elapsed time per iteration (ms): 4083.1 | learning rate 9.118E-04 | total loss 2.994804E-01 | loss 2.994804E-01 | loss scale 8388608.0 |speed 14.69 samples/(min*GPU)
[2024-09-16 08:22:57,828] [INFO] [RANK 0] time (ms) | forward: 2101.97 | backward: 1960.78 | allreduce: 0.00 | optimizer: 19.28 | data loader: 0.15
[2024-09-16 08:23:38,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=9850, skipped=16, lr=[0.00091166], mom=[[0.9, 0.95]]
[2024-09-16 08:24:19,105] [INFO] [RANK 0]  iteration     9860/  100000 | elapsed time per iteration (ms): 4063.9 | learning rate 9.116E-04 | total loss 3.459745E-01 | loss 3.459745E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 08:24:19,106] [INFO] [RANK 0] time (ms) | forward: 2093.79 | backward: 1949.98 | allreduce: 0.00 | optimizer: 19.13 | data loader: 0.15
[2024-09-16 08:25:39,833] [INFO] [RANK 0]  iteration     9880/  100000 | elapsed time per iteration (ms): 4036.4 | learning rate 9.114E-04 | total loss 2.728765E-01 | loss 2.728766E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 08:25:39,834] [INFO] [RANK 0] time (ms) | forward: 2137.61 | backward: 1876.56 | allreduce: 0.00 | optimizer: 21.03 | data loader: 0.19
[2024-09-16 08:27:01,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=9900, skipped=16, lr=[0.0009111599999999999], mom=[[0.9, 0.95]]
[2024-09-16 08:27:01,789] [INFO] [RANK 0]  iteration     9900/  100000 | elapsed time per iteration (ms): 4097.8 | learning rate 9.112E-04 | total loss 3.054492E-01 | loss 3.054492E-01 | loss scale 8388608.0 |speed 14.64 samples/(min*GPU)
[2024-09-16 08:27:01,791] [INFO] [RANK 0] time (ms) | forward: 2129.76 | backward: 1949.65 | allreduce: 0.00 | optimizer: 17.44 | data loader: 0.13
[2024-09-16 08:28:23,455] [INFO] [RANK 0]  iteration     9920/  100000 | elapsed time per iteration (ms): 4083.3 | learning rate 9.110E-04 | total loss 2.824352E-01 | loss 2.824352E-01 | loss scale 8388608.0 |speed 14.69 samples/(min*GPU)
[2024-09-16 08:28:23,456] [INFO] [RANK 0] time (ms) | forward: 2118.53 | backward: 1941.43 | allreduce: 0.00 | optimizer: 22.18 | data loader: 0.18
[2024-09-16 08:29:44,080] [INFO] [RANK 0]  iteration     9940/  100000 | elapsed time per iteration (ms): 4031.3 | learning rate 9.107E-04 | total loss 2.770334E-01 | loss 2.770334E-01 | loss scale 8388608.0 |speed 14.88 samples/(min*GPU)
[2024-09-16 08:29:44,081] [INFO] [RANK 0] time (ms) | forward: 2122.24 | backward: 1890.21 | allreduce: 0.00 | optimizer: 17.89 | data loader: 0.14
[2024-09-16 08:30:24,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=9950, skipped=16, lr=[0.0009106600000000001], mom=[[0.9, 0.95]]
[2024-09-16 08:31:05,057] [INFO] [RANK 0]  iteration     9960/  100000 | elapsed time per iteration (ms): 4048.9 | learning rate 9.105E-04 | total loss 2.843104E-01 | loss 2.843104E-01 | loss scale 8388608.0 |speed 14.82 samples/(min*GPU)
[2024-09-16 08:31:05,058] [INFO] [RANK 0] time (ms) | forward: 2115.54 | backward: 1912.42 | allreduce: 0.00 | optimizer: 19.79 | data loader: 0.18
[2024-09-16 08:32:25,797] [INFO] [RANK 0]  iteration     9980/  100000 | elapsed time per iteration (ms): 4037.0 | learning rate 9.103E-04 | total loss 2.300145E-01 | loss 2.300145E-01 | loss scale 8388608.0 |speed 14.86 samples/(min*GPU)
[2024-09-16 08:32:25,797] [INFO] [RANK 0] time (ms) | forward: 2124.20 | backward: 1893.36 | allreduce: 0.00 | optimizer: 18.41 | data loader: 0.15
[2024-09-16 08:33:47,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=10000, skipped=16, lr=[0.00091016], mom=[[0.9, 0.95]]
[2024-09-16 08:33:47,652] [INFO] [RANK 0]  iteration    10000/  100000 | elapsed time per iteration (ms): 4092.8 | learning rate 9.102E-04 | total loss 2.940183E-01 | loss 2.940183E-01 | loss scale 8388608.0 |speed 14.66 samples/(min*GPU)
[2024-09-16 08:33:47,653] [INFO] [RANK 0] time (ms) | forward: 2123.38 | backward: 1947.76 | allreduce: 0.00 | optimizer: 19.93 | data loader: 0.17
[2024-09-16 08:33:47,654] [INFO] [RANK 0] Saving Model...
[2024-09-16 08:33:49,942] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/10000/mp_rank_00_model_states.pt
[2024-09-16 08:33:49,942] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/10000/mp_rank_00_model_states.pt...
[2024-09-16 08:34:06,221] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/10000/mp_rank_00_model_states.pt.
[2024-09-16 08:34:06,314] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 08:34:07,076] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/10000-ema/mp_rank_00_model_states.pt
[2024-09-16 08:34:07,077] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/10000-ema/mp_rank_00_model_states.pt...
[2024-09-16 08:34:32,532] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/10000-ema/mp_rank_00_model_states.pt.
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:56,  1.13s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:57,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:55,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:54,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:53,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:06<00:52,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:51,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:50,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:49,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:47,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:12<00:46,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:13<00:45,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:44,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:43,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:42,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:18<00:41,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:19<00:39,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:38,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:37,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:36,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:24<00:35,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:25<00:34,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:26<00:32,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:31,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:30,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:30<00:29,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:31<00:28,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:32<00:27,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:25,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:24,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:36<00:23,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:37<00:22,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:38<00:21,  1.18s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:39<00:20,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:18,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:42<00:17,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:43<00:16,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:44<00:15,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:45<00:14,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:48<00:11,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:49<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:50<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:51<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:54<00:05,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:55<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:56<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:57<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.18s/it]
[2024-09-16 08:36:10,735] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 08:36:10,735] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-09-16 08:36:10,737] [INFO] [RANK 0]  validation loss at iteration 10000 | loss: 1.337173E-01 | PPL: 1.143070E+00 loss 1.337173E-01 |
[2024-09-16 08:36:10,738] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 10000 is less than current step: 10001. Dropping entry: {'Train/valid_ppl': 1.1430696605401156, 'Train/valid_loss': 0.13371732831001282, '_timestamp': 1726490170.7386327}).
[2024-09-16 08:37:30,624] [INFO] [RANK 0]  iteration    10020/  100000 | elapsed time per iteration (ms): 11148.6 | learning rate 9.100E-04 | total loss 3.164783E-01 | loss 3.164783E-01 | loss scale 8388608.0 |speed 5.38 samples/(min*GPU)
[2024-09-16 08:37:30,624] [INFO] [RANK 0] time (ms) | forward: 2040.35 | backward: 1934.51 | allreduce: 0.00 | optimizer: 18.53 | data loader: 0.17
[2024-09-16 08:38:50,599] [INFO] [RANK 0]  iteration    10040/  100000 | elapsed time per iteration (ms): 3998.8 | learning rate 9.097E-04 | total loss 2.580661E-01 | loss 2.580662E-01 | loss scale 8388608.0 |speed 15.00 samples/(min*GPU)
[2024-09-16 08:38:50,600] [INFO] [RANK 0] time (ms) | forward: 2109.98 | backward: 1869.49 | allreduce: 0.00 | optimizer: 18.17 | data loader: 0.15
[2024-09-16 08:39:31,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=10050, skipped=16, lr=[0.0009096600000000001], mom=[[0.9, 0.95]]
[2024-09-16 08:40:11,742] [INFO] [RANK 0]  iteration    10060/  100000 | elapsed time per iteration (ms): 4057.1 | learning rate 9.095E-04 | total loss 3.082639E-01 | loss 3.082639E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 08:40:11,743] [INFO] [RANK 0] time (ms) | forward: 2141.70 | backward: 1894.89 | allreduce: 0.00 | optimizer: 18.77 | data loader: 0.14
[2024-09-16 08:41:33,013] [INFO] [RANK 0]  iteration    10080/  100000 | elapsed time per iteration (ms): 4063.6 | learning rate 9.093E-04 | total loss 3.006356E-01 | loss 3.006356E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 08:41:33,014] [INFO] [RANK 0] time (ms) | forward: 2129.84 | backward: 1912.55 | allreduce: 0.00 | optimizer: 20.11 | data loader: 0.17
[2024-09-16 08:42:54,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=10100, skipped=16, lr=[0.00090916], mom=[[0.9, 0.95]]
[2024-09-16 08:42:54,459] [INFO] [RANK 0]  iteration    10100/  100000 | elapsed time per iteration (ms): 4072.3 | learning rate 9.092E-04 | total loss 2.621510E-01 | loss 2.621510E-01 | loss scale 8388608.0 |speed 14.73 samples/(min*GPU)
[2024-09-16 08:42:54,461] [INFO] [RANK 0] time (ms) | forward: 2095.49 | backward: 1956.96 | allreduce: 0.00 | optimizer: 18.54 | data loader: 0.15
[2024-09-16 08:44:15,787] [INFO] [RANK 0]  iteration    10120/  100000 | elapsed time per iteration (ms): 4066.4 | learning rate 9.090E-04 | total loss 2.433410E-01 | loss 2.433410E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 08:44:15,788] [INFO] [RANK 0] time (ms) | forward: 2120.86 | backward: 1924.65 | allreduce: 0.00 | optimizer: 19.92 | data loader: 0.18
[2024-09-16 08:45:37,157] [INFO] [RANK 0]  iteration    10140/  100000 | elapsed time per iteration (ms): 4068.5 | learning rate 9.087E-04 | total loss 2.596393E-01 | loss 2.596393E-01 | loss scale 8388608.0 |speed 14.75 samples/(min*GPU)
[2024-09-16 08:45:37,157] [INFO] [RANK 0] time (ms) | forward: 2111.72 | backward: 1937.88 | allreduce: 0.00 | optimizer: 17.92 | data loader: 0.15
[2024-09-16 08:46:17,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=10150, skipped=16, lr=[0.00090866], mom=[[0.9, 0.95]]
[2024-09-16 08:46:58,347] [INFO] [RANK 0]  iteration    10160/  100000 | elapsed time per iteration (ms): 4059.5 | learning rate 9.085E-04 | total loss 3.137007E-01 | loss 3.137007E-01 | loss scale 8388608.0 |speed 14.78 samples/(min*GPU)
[2024-09-16 08:46:58,348] [INFO] [RANK 0] time (ms) | forward: 2133.97 | backward: 1907.93 | allreduce: 0.00 | optimizer: 16.71 | data loader: 0.14
[2024-09-16 08:48:18,525] [INFO] [RANK 0]  iteration    10180/  100000 | elapsed time per iteration (ms): 4008.9 | learning rate 9.084E-04 | total loss 2.764735E-01 | loss 2.764735E-01 | loss scale 8388608.0 |speed 14.97 samples/(min*GPU)
[2024-09-16 08:48:18,526] [INFO] [RANK 0] time (ms) | forward: 2114.93 | backward: 1876.39 | allreduce: 0.00 | optimizer: 16.70 | data loader: 0.11
[2024-09-16 08:49:39,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=10200, skipped=16, lr=[0.00090816], mom=[[0.9, 0.95]]
[2024-09-16 08:49:39,988] [INFO] [RANK 0]  iteration    10200/  100000 | elapsed time per iteration (ms): 4073.1 | learning rate 9.082E-04 | total loss 2.527119E-01 | loss 2.527119E-01 | loss scale 8388608.0 |speed 14.73 samples/(min*GPU)
[2024-09-16 08:49:39,989] [INFO] [RANK 0] time (ms) | forward: 2126.57 | backward: 1928.94 | allreduce: 0.00 | optimizer: 16.71 | data loader: 0.14
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.16s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:58,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:05<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:11<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:17<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:23<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:29<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:35<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:41<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:47<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:53<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 08:50:52,531] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 08:50:52,531] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-09-16 08:50:52,535] [INFO] [RANK 0]  validation loss at iteration 10200 | loss: 1.509027E-01 | PPL: 1.162883E+00 loss 1.509027E-01 |
[2024-09-16 08:50:52,535] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 10200 is less than current step: 10201. Dropping entry: {'Train/valid_ppl': 1.1628834733143465, 'Train/valid_loss': 0.1509026736021042, '_timestamp': 1726491052.5402641}).
[2024-09-16 08:52:13,926] [INFO] [RANK 0]  iteration    10220/  100000 | elapsed time per iteration (ms): 7696.9 | learning rate 9.080E-04 | total loss 2.873591E-01 | loss 2.873591E-01 | loss scale 8388608.0 |speed 7.80 samples/(min*GPU)
[2024-09-16 08:52:13,927] [INFO] [RANK 0] time (ms) | forward: 2128.35 | backward: 1923.51 | allreduce: 0.00 | optimizer: 16.65 | data loader: 0.16
[2024-09-16 08:53:35,013] [INFO] [RANK 0]  iteration    10240/  100000 | elapsed time per iteration (ms): 4054.3 | learning rate 9.077E-04 | total loss 2.557028E-01 | loss 2.557028E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 08:53:35,014] [INFO] [RANK 0] time (ms) | forward: 2081.62 | backward: 1955.37 | allreduce: 0.00 | optimizer: 16.43 | data loader: 0.13
[2024-09-16 08:54:15,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=10250, skipped=16, lr=[0.00090766], mom=[[0.9, 0.95]]
[2024-09-16 08:54:56,102] [INFO] [RANK 0]  iteration    10260/  100000 | elapsed time per iteration (ms): 4054.5 | learning rate 9.076E-04 | total loss 2.515076E-01 | loss 2.515076E-01 | loss scale 8388608.0 |speed 14.80 samples/(min*GPU)
[2024-09-16 08:54:56,103] [INFO] [RANK 0] time (ms) | forward: 2127.88 | backward: 1909.16 | allreduce: 0.00 | optimizer: 16.52 | data loader: 0.13
[2024-09-16 08:56:17,408] [INFO] [RANK 0]  iteration    10280/  100000 | elapsed time per iteration (ms): 4065.3 | learning rate 9.074E-04 | total loss 2.336806E-01 | loss 2.336806E-01 | loss scale 8388608.0 |speed 14.76 samples/(min*GPU)
[2024-09-16 08:56:17,408] [INFO] [RANK 0] time (ms) | forward: 2092.36 | backward: 1955.45 | allreduce: 0.00 | optimizer: 16.53 | data loader: 0.14
[2024-09-16 08:57:37,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=10300, skipped=16, lr=[0.00090716], mom=[[0.9, 0.95]]
[2024-09-16 08:57:37,702] [INFO] [RANK 0]  iteration    10300/  100000 | elapsed time per iteration (ms): 4014.7 | learning rate 9.072E-04 | total loss 2.459088E-01 | loss 2.459088E-01 | loss scale 8388608.0 |speed 14.95 samples/(min*GPU)
[2024-09-16 08:57:37,703] [INFO] [RANK 0] time (ms) | forward: 2116.34 | backward: 1880.99 | allreduce: 0.00 | optimizer: 16.47 | data loader: 0.13
[2024-09-16 08:58:58,836] [INFO] [RANK 0]  iteration    10320/  100000 | elapsed time per iteration (ms): 4056.7 | learning rate 9.070E-04 | total loss 2.652563E-01 | loss 2.652563E-01 | loss scale 8388608.0 |speed 14.79 samples/(min*GPU)
[2024-09-16 08:58:58,836] [INFO] [RANK 0] time (ms) | forward: 2140.25 | backward: 1898.67 | allreduce: 0.00 | optimizer: 16.91 | data loader: 0.14
[2024-09-16 09:00:20,074] [INFO] [RANK 0]  iteration    10340/  100000 | elapsed time per iteration (ms): 4061.9 | learning rate 9.068E-04 | total loss 2.590646E-01 | loss 2.590646E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 09:00:20,075] [INFO] [RANK 0] time (ms) | forward: 2105.72 | backward: 1938.67 | allreduce: 0.00 | optimizer: 16.67 | data loader: 0.12
[2024-09-16 09:01:00,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=10350, skipped=16, lr=[0.00090666], mom=[[0.9, 0.95]]
[2024-09-16 09:01:41,702] [INFO] [RANK 0]  iteration    10360/  100000 | elapsed time per iteration (ms): 4081.4 | learning rate 9.065E-04 | total loss 2.436324E-01 | loss 2.436324E-01 | loss scale 8388608.0 |speed 14.70 samples/(min*GPU)
[2024-09-16 09:01:41,703] [INFO] [RANK 0] time (ms) | forward: 2133.82 | backward: 1930.39 | allreduce: 0.00 | optimizer: 16.36 | data loader: 0.13
[2024-09-16 09:03:02,039] [INFO] [RANK 0]  iteration    10380/  100000 | elapsed time per iteration (ms): 4016.9 | learning rate 9.063E-04 | total loss 2.559957E-01 | loss 2.559957E-01 | loss scale 8388608.0 |speed 14.94 samples/(min*GPU)
[2024-09-16 09:03:02,040] [INFO] [RANK 0] time (ms) | forward: 2103.33 | backward: 1896.19 | allreduce: 0.00 | optimizer: 16.49 | data loader: 0.13
[2024-09-16 09:04:23,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=10400, skipped=16, lr=[0.00090616], mom=[[0.9, 0.95]]
[2024-09-16 09:04:23,306] [INFO] [RANK 0]  iteration    10400/  100000 | elapsed time per iteration (ms): 4063.3 | learning rate 9.061E-04 | total loss 2.336458E-01 | loss 2.336459E-01 | loss scale 8388608.0 |speed 14.77 samples/(min*GPU)
[2024-09-16 09:04:23,308] [INFO] [RANK 0] time (ms) | forward: 2125.10 | backward: 1921.04 | allreduce: 0.00 | optimizer: 16.33 | data loader: 0.13
##############################  Sampling setting  ##############################
Sampler: VPSDEDPMPP2MSampler
Discretization: ZeroSNRDDPMDiscretization
Guider: DynamicCFG
Sampling with VPSDEDPMPP2MSampler for 51 steps:   0%|          | 0/51 [00:00<?, ?it/s]Sampling with VPSDEDPMPP2MSampler for 51 steps:   2%|▏         | 1/51 [00:01<00:58,  1.17s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   4%|▍         | 2/51 [00:02<00:59,  1.21s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   6%|▌         | 3/51 [00:03<00:57,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:   8%|▊         | 4/51 [00:04<00:56,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  10%|▉         | 5/51 [00:06<00:55,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  12%|█▏        | 6/51 [00:07<00:54,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  14%|█▎        | 7/51 [00:08<00:52,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  16%|█▌        | 8/51 [00:09<00:51,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  18%|█▊        | 9/51 [00:10<00:50,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  20%|█▉        | 10/51 [00:12<00:49,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  22%|██▏       | 11/51 [00:13<00:48,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  24%|██▎       | 12/51 [00:14<00:46,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  25%|██▌       | 13/51 [00:15<00:45,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  27%|██▋       | 14/51 [00:16<00:44,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  29%|██▉       | 15/51 [00:18<00:43,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  31%|███▏      | 16/51 [00:19<00:42,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  33%|███▎      | 17/51 [00:20<00:40,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  35%|███▌      | 18/51 [00:21<00:39,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  37%|███▋      | 19/51 [00:22<00:38,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  39%|███▉      | 20/51 [00:24<00:37,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  41%|████      | 21/51 [00:25<00:36,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  43%|████▎     | 22/51 [00:26<00:34,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  45%|████▌     | 23/51 [00:27<00:33,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  47%|████▋     | 24/51 [00:28<00:32,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  49%|████▉     | 25/51 [00:30<00:31,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  51%|█████     | 26/51 [00:31<00:30,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  53%|█████▎    | 27/51 [00:32<00:28,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  55%|█████▍    | 28/51 [00:33<00:27,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  57%|█████▋    | 29/51 [00:34<00:26,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  59%|█████▉    | 30/51 [00:36<00:25,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  61%|██████    | 31/51 [00:37<00:24,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  63%|██████▎   | 32/51 [00:38<00:22,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  65%|██████▍   | 33/51 [00:39<00:21,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  67%|██████▋   | 34/51 [00:40<00:20,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  69%|██████▊   | 35/51 [00:42<00:19,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  71%|███████   | 36/51 [00:43<00:18,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  73%|███████▎  | 37/51 [00:44<00:16,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  75%|███████▍  | 38/51 [00:45<00:15,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  76%|███████▋  | 39/51 [00:46<00:14,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  78%|███████▊  | 40/51 [00:48<00:13,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  80%|████████  | 41/51 [00:49<00:12,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  82%|████████▏ | 42/51 [00:50<00:10,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  84%|████████▍ | 43/51 [00:51<00:09,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  86%|████████▋ | 44/51 [00:52<00:08,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  88%|████████▊ | 45/51 [00:54<00:07,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  90%|█████████ | 46/51 [00:55<00:06,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  92%|█████████▏| 47/51 [00:56<00:04,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  94%|█████████▍| 48/51 [00:57<00:03,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  96%|█████████▌| 49/51 [00:58<00:02,  1.20s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.19s/it]Sampling with VPSDEDPMPP2MSampler for 51 steps:  98%|█████████▊| 50/51 [00:59<00:01,  1.20s/it]
[2024-09-16 09:05:36,034] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-09-16 09:05:36,035] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-09-16 09:05:36,037] [INFO] [RANK 0]  validation loss at iteration 10400 | loss: 1.964879E-01 | PPL: 1.217121E+00 loss 1.964879E-01 |
[2024-09-16 09:05:36,037] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
wandb: WARNING (User provided step: 10400 is less than current step: 10401. Dropping entry: {'Train/valid_ppl': 1.2171206342784453, 'Train/valid_loss': 0.1964879333972931, '_timestamp': 1726491936.0385454}).
[2024-09-16 09:06:56,782] [INFO] [RANK 0]  iteration    10420/  100000 | elapsed time per iteration (ms): 7673.8 | learning rate 9.060E-04 | total loss 3.245166E-01 | loss 3.245165E-01 | loss scale 8388608.0 |speed 7.82 samples/(min*GPU)
[2024-09-16 09:06:56,783] [INFO] [RANK 0] time (ms) | forward: 2108.93 | backward: 1910.75 | allreduce: 0.00 | optimizer: 16.70 | data loader: 0.14
[2024-09-16 09:08:17,465] [INFO] [RANK 0]  iteration    10440/  100000 | elapsed time per iteration (ms): 4034.2 | learning rate 9.058E-04 | total loss 2.368241E-01 | loss 2.368241E-01 | loss scale 8388608.0 |speed 14.87 samples/(min*GPU)
[2024-09-16 09:08:17,466] [INFO] [RANK 0] time (ms) | forward: 2131.14 | backward: 1885.38 | allreduce: 0.00 | optimizer: 16.76 | data loader: 0.13
[2024-09-16 09:08:57,979] [INFO] [logging.py:96:log_dist] [Rank 0] step=10450, skipped=16, lr=[0.0009056600000000001], mom=[[0.9, 0.95]]
[2024-09-16 09:09:39,028] [INFO] [RANK 0]  iteration    10460/  100000 | elapsed time per iteration (ms): 4078.1 | learning rate 9.055E-04 | total loss 2.907668E-01 | loss 2.907667E-01 | loss scale 8388608.0 |speed 14.71 samples/(min*GPU)
[2024-09-16 09:09:39,029] [INFO] [RANK 0] time (ms) | forward: 2137.62 | backward: 1923.09 | allreduce: 0.00 | optimizer: 16.58 | data loader: 0.14
[2024-09-16 09:10:59,497] [INFO] [RANK 0]  iteration    10480/  100000 | elapsed time per iteration (ms): 4023.4 | learning rate 9.053E-04 | total loss 2.698591E-01 | loss 2.698591E-01 | loss scale 8388608.0 |speed 14.91 samples/(min*GPU)
[2024-09-16 09:10:59,498] [INFO] [RANK 0] time (ms) | forward: 2082.98 | backward: 1923.22 | allreduce: 0.00 | optimizer: 16.35 | data loader: 0.15
[2024-09-16 09:12:19,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=10500, skipped=16, lr=[0.00090516], mom=[[0.9, 0.95]]
[2024-09-16 09:12:19,931] [INFO] [RANK 0]  iteration    10500/  100000 | elapsed time per iteration (ms): 4021.7 | learning rate 9.052E-04 | total loss 2.875444E-01 | loss 2.875444E-01 | loss scale 8388608.0 |speed 14.92 samples/(min*GPU)
[2024-09-16 09:12:19,933] [INFO] [RANK 0] time (ms) | forward: 2117.45 | backward: 1886.40 | allreduce: 0.00 | optimizer: 16.94 | data loader: 0.13
[2024-09-16 09:12:19,934] [INFO] [RANK 0] Saving Model...
[2024-09-16 09:12:21,935] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/10500/mp_rank_00_model_states.pt
[2024-09-16 09:12:21,935] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/10500/mp_rank_00_model_states.pt...
[2024-09-16 09:12:41,690] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/10500/mp_rank_00_model_states.pt.
[2024-09-16 09:12:41,840] [INFO] [RANK 0] Saving Ema Model...
[2024-09-16 09:12:42,472] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ckpts_2b_lora/2b_lora_1000-09-15-20-12/10500-ema/mp_rank_00_model_states.pt
[2024-09-16 09:12:42,472] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ckpts_2b_lora/2b_lora_1000-09-15-20-12/10500-ema/mp_rank_00_model_states.pt...
[2024-09-16 09:13:19,703] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ckpts_2b_lora/2b_lora_1000-09-15-20-12/10500-ema/mp_rank_00_model_states.pt.
[2024-09-16 09:14:39,348] [INFO] [RANK 0]  iteration    10520/  100000 | elapsed time per iteration (ms): 6970.8 | learning rate 9.050E-04 | total loss 2.496130E-01 | loss 2.496130E-01 | loss scale 8388608.0 |speed 8.61 samples/(min*GPU)
[2024-09-16 09:14:39,349] [INFO] [RANK 0] time (ms) | forward: 2009.62 | backward: 1949.36 | allreduce: 0.00 | optimizer: 17.08 | data loader: 0.14
[2024-09-16 09:15:59,758] [INFO] [RANK 0]  iteration    10540/  100000 | elapsed time per iteration (ms): 4020.5 | learning rate 9.048E-04 | total loss 3.042586E-01 | loss 3.042586E-01 | loss scale 8388608.0 |speed 14.92 samples/(min*GPU)
[2024-09-16 09:15:59,758] [INFO] [RANK 0] time (ms) | forward: 2043.41 | backward: 1959.80 | allreduce: 0.00 | optimizer: 16.40 | data loader: 0.13
[2024-09-16 09:16:39,809] [INFO] [logging.py:96:log_dist] [Rank 0] step=10550, skipped=16, lr=[0.0009046600000000001], mom=[[0.9, 0.95]]
